<!DOCTYPE html> <html lang="en"><head>
<title>Computer Organization and Design RISC-V Edition Summary</title>
<base href="..">
<meta name="pathname" content="textbooks/computer-organization-and-design-risc-v-edition-summary.html">
<meta name="description" content="Ernad Mujakic's Knowledge Base - Computer Organization and Design RISC-V Edition Summary">
<meta property="og:title" content="Computer Organization and Design RISC-V Edition Summary">
<meta property="og:description" content="Ernad Mujakic's Knowledge Base - Computer Organization and Design RISC-V Edition Summary">
<meta property="og:type" content="website">
<meta property="og:url" content="https://emujakic.github.io/TechKB/textbooks/computer-organization-and-design-risc-v-edition-summary.html">
<meta property="og:image" content="https://emujakic.github.io/TechKB/resources/multiplicationhardware-1.png">
<meta name="author" content="Ernad Mujakic"><meta charset="UTF-8"><meta property="og:site_name" content="Ernad Mujakic's Knowledge Base"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://emujakic.github.io/TechKB/site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="preload" href="site-lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/snippets.css"></noscript><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon ss-title-gradient heading-ligatures body-ligatures ordinary-ol ss-links-spectral callout-border-gradient is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles">mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block;text-align:left}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mfrac{display:inline-block;text-align:left}mjx-frac{display:inline-block;vertical-align:.17em;padding:0 .22em}mjx-frac[type="d"]{vertical-align:.04em}mjx-frac[delims]{padding:0 .1em}mjx-frac[atop]{padding:0 .12em}mjx-frac[atop][delims]{padding:0}mjx-dtable{display:inline-table;width:100%}mjx-dtable>*{font-size:2000%}mjx-dbox{display:block;font-size:5%}mjx-num{display:block;text-align:center}mjx-den{display:block;text-align:center}mjx-mfrac[bevelled]>mjx-num{display:inline-block}mjx-mfrac[bevelled]>mjx-den{display:inline-block}mjx-den[align=right],mjx-num[align=right]{text-align:right}mjx-den[align=left],mjx-num[align=left]{text-align:left}mjx-nstrut{display:inline-block;height:.054em;width:0;vertical-align:-.054em}mjx-nstrut[type="d"]{height:.217em;vertical-align:-.217em}mjx-dstrut{display:inline-block;height:.505em;width:0}mjx-dstrut[type="d"]{height:.726em}mjx-line{display:block;box-sizing:border-box;min-height:1px;height:.06em;border-top:.06em solid;margin:.06em -.1em;overflow:hidden}mjx-line[type="d"]{margin:.18em -.1em}mjx-mrow{display:inline-block;text-align:left}mjx-msup{display:inline-block;text-align:left}mjx-mn{display:inline-block;text-align:left}mjx-texatom{display:inline-block;text-align:left}mjx-msub{display:inline-block;text-align:left}mjx-mover{display:inline-block;text-align:left}mjx-mover:not([limits=false]){padding-top:.1em}mjx-mover:not([limits=false])>*{display:block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("site-lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("site-lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("site-lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("site-lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("site-lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("site-lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("site-lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("site-lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("site-lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("site-lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("site-lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("site-lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("site-lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("site-lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("site-lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("site-lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("site-lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("site-lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("site-lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("site-lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("site-lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("site-lib/fonts/mathjax_vector-bold.woff") format("woff")}.mjx-stretched mjx-c.mjx-c2013::before{content:"–"}mjx-stretchy-h.mjx-c2013 mjx-ext mjx-c::before{content:"–";padding:.285em 0 0}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c1D448.TEX-I::before{padding:.683em .767em .022em 0;content:"U"}mjx-c.mjx-cA0::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c1D461.TEX-I::before{padding:.626em .361em .011em 0;content:"t"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-c.mjx-c1D45A.TEX-I::before{padding:.442em .878em .011em 0;content:"m"}mjx-c.mjx-c1D452.TEX-I::before{padding:.442em .466em .011em 0;content:"e"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c1D43C.TEX-I::before{padding:.683em .504em 0 0;content:"I"}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c1D460.TEX-I::before{padding:.442em .469em .01em 0;content:"s"}mjx-c.mjx-c1D45F.TEX-I::before{padding:.442em .451em .011em 0;content:"r"}mjx-c.mjx-c1D462.TEX-I::before{padding:.442em .572em .011em 0;content:"u"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c1D45C.TEX-I::before{padding:.441em .485em .011em 0;content:"o"}mjx-c.mjx-c22C5::before{padding:.31em .278em 0 0;content:"⋅"}mjx-c.mjx-c1D459.TEX-I::before{padding:.694em .298em .011em 0;content:"l"}mjx-c.mjx-c1D458.TEX-I::before{padding:.694em .521em .011em 0;content:"k"}mjx-c.mjx-c1D466.TEX-I::before{padding:.442em .49em .205em 0;content:"y"}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c1D445.TEX-I::before{padding:.683em .759em .021em 0;content:"R"}mjx-c.mjx-c1D44E.TEX-I::before{padding:.441em .529em .01em 0;content:"a"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c1D441.TEX-I::before{padding:.683em .888em 0 0;content:"N"}mjx-c.mjx-c1D442.TEX-I::before{padding:.704em .763em .022em 0;content:"O"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c1D437.TEX-I::before{padding:.683em .828em 0 0;content:"D"}mjx-c.mjx-c1D463.TEX-I::before{padding:.443em .485em .011em 0;content:"v"}mjx-c.mjx-c1D451.TEX-I::before{padding:.694em .52em .01em 0;content:"d"}mjx-c.mjx-c1D444.TEX-I::before{padding:.704em .791em .194em 0;content:"Q"}mjx-c.mjx-cD7::before{padding:.491em .778em 0 0;content:"×"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c2026::before{padding:.12em 1.172em 0 0;content:"…"}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c1D446.TEX-I::before{padding:.705em .645em .022em 0;content:"S"}mjx-c.mjx-c1D439.TEX-I::before{padding:.68em .749em 0 0;content:"F"}mjx-c.mjx-c1D438.TEX-I::before{padding:.68em .764em 0 0;content:"E"}mjx-c.mjx-c221E::before{padding:.442em 1em .011em 0;content:"∞"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c1D464.TEX-I::before{padding:.443em .716em .011em 0;content:"w"}mjx-c.mjx-c1D465.TEX-I::before{padding:.442em .572em .011em 0;content:"x"}mjx-c.mjx-c1D45D.TEX-I::before{padding:.442em .503em .194em 0;content:"p"}mjx-c.mjx-c1D435.TEX-I::before{padding:.683em .759em 0 0;content:"B"}mjx-c.mjx-c1D44B.TEX-I::before{padding:.683em .852em 0 0;content:"X"}mjx-c.mjx-c1D440.TEX-I::before{padding:.683em 1.051em 0 0;content:"M"}mjx-c.mjx-c1D434.TEX-I::before{padding:.716em .75em 0 0;content:"A"}mjx-c.mjx-c1D43B.TEX-I::before{padding:.683em .888em 0 0;content:"H"}mjx-c.mjx-c1D44F.TEX-I::before{padding:.694em .429em .011em 0;content:"b"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c2F::before{padding:.75em .5em .25em 0;content:"/"}mjx-c.mjx-c1D454.TEX-I::before{padding:.442em .477em .205em 0;content:"g"}mjx-c.mjx-cAF::before{padding:.59em .5em 0 0;content:"¯"}mjx-c.mjx-c2308::before{padding:.75em .444em .25em 0;content:"⌈"}mjx-c.mjx-c6C::before{padding:.694em .278em 0 0;content:"l"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c67::before{padding:.453em .5em .206em 0;content:"g"}mjx-c.mjx-c2061::before{padding:0;content:""}mjx-c.mjx-c2309::before{padding:.75em .444em .25em 0;content:"⌉"}mjx-c.mjx-c1D719.TEX-I::before{padding:.694em .596em .205em 0;content:"ϕ"}</style><pre class="frontmatter language-yaml" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">"#textbook"</span>
<span class="token key atrule">date</span><span class="token punctuation">:</span> 08<span class="token punctuation">-</span>19<span class="token punctuation">-</span><span class="token number">2025</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="_0"></h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h1"><h1 data-heading="Textbook Summary: Computer Organization and Design RISC-V Edition" dir="auto" class="heading" id="Textbook_Summary_Computer_Organization_and_Design_RISC-V_Edition_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Textbook Summary: Computer Organization and Design RISC-V Edition</h1></div><div class="el-hr"><hr></div><div class="el-h3"><h3 data-heading="Author(s):" dir="auto" class="heading" id="Author(s)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Author(s):</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Name:</strong> David A Patterson and John L. Hennessy</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Edition:</strong> 6th Edition</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Introduction" dir="auto" class="heading" id="Introduction_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Introduction</h2></div><div class="el-p"><p dir="auto"><em>Computer Organization and Design: RISC-V Edition</em> serves as a comprehensive guide to understanding the principles and practices of modern computer systems. The book covers essential topics including data representation, instruction execution, pipelining, and memory hierarchy. This summary attempts to break down the main ideas and insights from the book.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Ch.1 Computer Abstractions and Technology" dir="auto" class="heading" id="Ch.1_Computer_Abstractions_and_Technology_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.1 Computer Abstractions and Technology</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>
<p><strong>Personal Computer</strong> (PC): A dedicated computer for use by an individual.</p>
</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>
<p><strong>Server</strong>: A specialized computer used to run programs for multiple clients.</p>
</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>
<p><strong>Supercomputer</strong>: a high-performance server, typically used for advanced scientific calculations or simulations.</p>
</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>
<p><strong>Embedded Computer</strong>: A computer integrated into another system such as a car or smart TV.</p>
</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>
<p><strong>Personal Mobile Device</strong>: A portable computer designed for personal use, typically battery-operated with WiFi capabilities.</p>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span>
<p><strong>Cloud Computing</strong>: Large collections of servers which provide computing services over the internet.</p>
</li>
<li data-line="7" dir="auto"><span class="list-bullet"></span>
<p><strong>Integrated Circuit (IC)</strong>: A compact assembly of electronic components made from <a data-href="Semiconductor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Semiconductor</a> material. It can contain billions of components integrated into a single package. ICs enable the abstraction of specific computational capabilities and the efficient mass manufacturing of cost-effective electronic components.</p>
</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Central Processing Unit" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Central Processing Unit</a> (CPU)</strong>: The primary component of a computer responsible for executing program instructions. Modern CPUs typically have multiple cores.</p>
<ul class="has-list-bullet">
<li data-line="9" dir="auto"><span class="list-bullet"></span><strong>Multicore Processor</strong>: A single IC containing multiple independent <em>cores</em>, or processing units.</li>
<li data-line="10" dir="auto"><span class="list-bullet"></span>Multicore processors allow <strong><a data-href="Parallel Processing" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Parallel Processing</a></strong>, which is the simultaneous execution of tasks.</li>
</ul>
</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>seven great ideas in computer architecture</strong> include:</p>
<ol>
<li data-line="14" dir="auto"><strong>Abstraction</strong>: Hiding lower-level details from higher level representations, allowing a simpler model at high levels.</li>
<li data-line="15" dir="auto"><strong>Common Case Fast</strong>: Focusing on improving the performance of the tasks that occur most.</li>
<li data-line="16" dir="auto"><strong>Parallelism</strong>: Executing multiple tasks simultaneously.</li>
<li data-line="17" dir="auto"><strong>Pipelining</strong>: The technique of breaking a complex task into a series of subtasks, allowing for the simultaneous execution of these subtasks sequentially, improving processing throughput.</li>
<li data-line="18" dir="auto"><strong>Prediction</strong>: Anticipating the outcome of an action based on historical data or patterns, allowing for proactive decision-making rather than waiting for results.</li>
<li data-line="19" dir="auto"><strong>Hierarchy of Memories</strong>: Organizing different types of memory where critical information is stored in the fastest, scarcest memory, and less-critical information is stored in slower, larger memory.</li>
<li data-line="20" dir="auto"><strong>Dependability via Redundancy</strong>: Detecting failures and including redundant components that can take over when a failure occurs.</li>
</ol>
</li>
<li data-line="22" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Moore's Law" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Moore's Law</a></strong>: A prediction made by Gordon Moore which states that the number of <strong><a data-tooltip-position="top" aria-label="Transistor" data-href="Transistor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">transistors</a></strong> that could be fit on an IC will double every two years. Moore's Law has slowed in recent years, making it no longer accurate.</p>
</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>
<p><strong>Systems Software</strong>: Software designed to manage and control computer hardware. Acts as an interface between hardware and application software. This includes software such as operating systems, device drivers, firmware, or <a data-tooltip-position="top" aria-label="Bootloader" data-href="Bootloader" href=".html" class="internal-link" target="_self" rel="noopener nofollow">bootloaders</a>.</p>
</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Operating System" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Operating System</a></strong>: A type of systems software which managers computer hardware resources and provides services for user programs.</p>
</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Compiler" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Compiler</a></strong>: A software which translates high-level programming language statements (such as <a data-href="C" href=".html" class="internal-link" target="_self" rel="noopener nofollow">C</a>) into <a data-href="Assembly Language" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Assembly Language</a> statements.</p>
</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span>
<p>Electric signals are the only way to speak directly to hardware. Digital systems typically use binary signals which are either on or off. These signals are represented in <em>base 2</em> numbers called <a data-tooltip-position="top" aria-label="Binary Number" data-href="Binary Number" href=".html" class="internal-link" target="_self" rel="noopener nofollow">binary numbers</a>. Each binary digit is called a <strong>bit</strong>.</p>
</li>
<li data-line="31" dir="auto"><span class="list-bullet"></span>
<p><strong>Instruction</strong>: A command that the computer hardware can decode and execute.</p>
</li>
<li data-line="32" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Assembler" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Assembler</a></strong>: A program which translates assembly instructions into <a data-href="Machine Language" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Machine Language</a>, a binary representation of instructions which the computer hardware can understand.</p>
<ul class="has-list-bullet">
<li data-line="33" dir="auto"><span class="list-bullet"></span>The compilation and translation from a high-level language into machine language is an example of <strong>abstraction</strong>. High-level languages allow for the concise development of complex programs in a symbolic syntax that humans can understand.</li>
</ul>
</li>
<li data-line="35" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>five classic components</strong> of a computer are:</p>
<ol>
<li data-line="36" dir="auto"><strong>Input</strong>: Devices, such as keyboards which feed information to a computer.</li>
<li data-line="37" dir="auto"><strong>Output</strong>: Devices such as monitors which display information to the user.</li>
<li data-line="38" dir="auto"><strong>Memory</strong>: The components which store data and instructions.</li>
<li data-line="39" dir="auto"><strong>Datapath</strong>: The hardware components responsible for the processing and transportation of data.</li>
<li data-line="40" dir="auto"><strong>Control</strong>: The hardware components which direct the operation of datapath components.</li>
</ol>
</li>
<li data-line="42" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Graphics display devices, such as monitors, displays an image as a <a data-href="Matrix" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Matrix</a> of pixels, which is typically represented as a matrix of bits called a bitmap.</p>
<ul class="has-list-bullet">
<li data-line="43" dir="auto"><span class="list-bullet"></span>A <em>frame buffer</em> is typically used to store the bitmap.</li>
</ul>
</li>
<li data-line="45" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Memory can be either <strong>volatile</strong> or <strong>nonvolatile</strong>. Volatile memory loses its data whenever power is turned off, volatile memory retains its data even after power loss. Some major memory types include:</p>
<ul class="has-list-bullet">
<li data-line="46" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="DRAM" href=".html" class="internal-link" target="_self" rel="noopener nofollow">DRAM</a> (Dynamic Random Access Memory)</strong>: A type of <em>volatile</em> memory built as an IC which can provide random access to any address. DRAM is typically the <strong>main memory</strong> of a computer, that is, the memory used to store programs while they are running.</p>
<ul class="has-list-bullet">
<li data-line="47" dir="auto"><span class="list-bullet"></span>Memory <em>cells</em> consist of a <a data-href="Capacitor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Capacitor</a> and a <a data-href="Transistor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Transistor</a> which stores each bit of data as an electrical charge. Because the capacitor leaks charge over time, the data has to be periodically refreshed.</li>
<li data-line="48" dir="auto"><span class="list-bullet"></span>DRAM permits access times of around 50 nanoseconds.</li>
</ul>
</li>
<li data-line="50" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Cache Memory" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Cache Memory</a></strong>: A small, high-speed volatile memory, typically found inside the CPU. Cache memory acts as a <em>buffer</em> for slower, larger memory like DRAM.</p>
<ul class="has-list-bullet">
<li data-line="51" dir="auto"><span class="list-bullet"></span>The fastest L1 cache allows access times of around 3 nanoseconds.</li>
</ul>
</li>
<li data-line="53" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="SRAM" href=".html" class="internal-link" target="_self" rel="noopener nofollow">SRAM</a> (Static Random Access Memory)</strong>: Similar to DRAM, SRAM is a type of volatile memory built as an IC, though SRAM is faster, does not need to be refreshed, and is more reliable. Though this comes at a higher cost per bit and larger footprint.</p>
<ul class="has-list-bullet">
<li data-line="54" dir="auto"><span class="list-bullet"></span>SRAM access times typically <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/range.html#_0" target="_self" rel="noopener noreferrer" from="28" to="33" origin-text="range" class="internal-link virtual-link-a">range</a></span> from 10 to 20 nanoseconds.</li>
</ul>
</li>
<li data-line="56" dir="auto"><span class="list-bullet"></span>
<p><strong>Secondary Memory</strong>: Typically consists of <a data-href="Flash Memory" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Flash Memory</a> and magnetic disks. Secondary memory is nonvolatile, therefore it is used to store perpetual data across program runs. Secondary memory is significantly slower than primary memory.</p>
</li>
</ul>
</li>
<li data-line="58" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Instruction Set Architecture" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Instruction Set Architecture</a> (ISA)</strong>: The vocabulary of instructions which a computer can decode and execute. Popular ISAs include <a data-href="RISC-V" href=".html" class="internal-link" target="_self" rel="noopener nofollow">RISC-V</a>, <a data-href="x86" href=".html" class="internal-link" target="_self" rel="noopener nofollow">x86</a>, MIPS, and <a data-href="ARMv8" href=".html" class="internal-link" target="_self" rel="noopener nofollow">ARMv8</a>.</p>
</li>
<li data-line="60" dir="auto"><span class="list-bullet"></span>
<p><strong>Application Binary Interface (ABI)</strong>: The combination of the instruction set and the operating system interface for application programmers.</p>
</li>
<li data-line="62" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Networks</strong>: Interconnect multiple computers together, thus, allowing them to communicate, share resources, and enable non-local access.</p>
<ul class="has-list-bullet">
<li data-line="63" dir="auto"><span class="list-bullet"></span>
<p><strong>Local Area Network (LAN)</strong>: A network which interconnects devices within a limited geographical area, typically a single building.</p>
</li>
<li data-line="65" dir="auto"><span class="list-bullet"></span>
<p><strong>Wide Area Network (WAN)</strong>: A network which spans over a large geographical area, connecting multiple LANs together. WANs can span across entire continents.</p>
</li>
</ul>
</li>
<li data-line="67" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Semiconductor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Semiconductor</a></strong>: A material which does not conduct electricity very well.</p>
<ul class="has-list-bullet">
<li data-line="68" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Transistor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Transistor</a></strong>: A Semiconductor device, typically used as an electrically controlled switch.</p>
</li>
<li data-line="70" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="VLSI" href=".html" class="internal-link" target="_self" rel="noopener nofollow">VLSI</a> (Very large-scale integrated circuit)</strong>: An IC which consists of millions of transistors.</p>
</li>
</ul>
</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Performance</strong>: Multiple factors are required to effectively assess the performance of a processor.</p>
<ul class="has-list-bullet">
<li data-line="73" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Response/Execution Time</strong>: The total time required for the CPU to complete a task. This includes disk/memory access times, I/O times, etc. The performance of a CPU is the <a data-href="Reciprocal" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Reciprocal</a> of the execution time.</p>
<ul class="has-list-bullet">
<li data-line="74" dir="auto"><span class="list-bullet"></span><strong>CPU Time</strong>: The time the CPU takes to compute a specific task. This does not include factors external to the CPU like I/O or memory accesses.</li>
</ul>
</li>
<li data-line="76" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Throughput/Bandwidth</strong>: The number of tasks a CPU can complete per unit time. The primary unit time used is the <strong>clock cycle</strong> of the CPU.</p>
<ul class="has-list-bullet">
<li data-line="77" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong><a data-href="Clock Cycle" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Clock Cycle</a></strong>: Each CPU has an internal <strong>clock</strong>, which is a periodic <a data-href="Square Wave" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Square Wave</a> that oscillates between high and low. A clock cycle is one complete cycle of the CPU clock.
<ul class="has-list-bullet">
<li data-line="78" dir="auto"><span class="list-bullet"></span><strong>Clock Period</strong>: The length of one complete clock cycle. The <strong>clock rate</strong> is the inverse of the clock cycle.</li>
</ul>
</li>
</ul>
</li>
<li data-line="80" dir="auto"><span class="list-bullet"></span>
<p><strong>CPI (Clock Cycles per Instruction)</strong>: The average number of clock cycles it takes for a processor to complete an instruction. The average is taken because different instructions require different amounts of clock cycles to complete.</p>
</li>
<li data-line="82" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Instruction Count</strong>: The number of instructions executed by a program.</p>
<ul class="has-list-bullet">
<li data-line="83" dir="auto"><span class="list-bullet"></span><strong>Workload</strong>: A set of programs that a computer is required to execute.</li>
<li data-line="84" dir="auto"><span class="list-bullet"></span><strong>Instruction Mix</strong>: The distribution of different types of instructions in a given program or workload.</li>
</ul>
</li>
<li data-line="86" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>CPU time</strong> of program can now be defined as:</p>
<ul class="has-list-bullet">
<li data-line="87" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span></li>
<li data-line="88" dir="auto"><span class="list-bullet"></span>Since the clock rate is the inverse of the clock cycle time, we can also define the equation as:</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="91" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Power Wall</strong>: A term used to describe the limitations on processor design due to power consumption and heat dissipation requirements.</p>
<ul class="has-list-bullet">
<li data-line="92" dir="auto"><span class="list-bullet"></span>Making processors faster would require making them disproportionately less power-efficient, which is a problem for embedded computers which are typically battery-operated; heat dissipation is a major problem for data centers and supercomputers which require significant cooling infrastructure.</li>
<li data-line="93" dir="auto"><span class="list-bullet"></span>For <a data-href="CMOS" href=".html" class="internal-link" target="_self" rel="noopener nofollow">CMOS</a> ICs, the primary source of energy consumption is <em>dynamic energy</em>, that is, the energy consumed when a transistor switches states.</li>
</ul>
</li>
<li data-line="95" dir="auto"><span class="list-bullet"></span>
<p><strong>Benchmark</strong>: A program used to compare and measure computer performance.</p>
</li>
<li data-line="96" dir="auto"><span class="list-bullet"></span>
<p><strong>MIPS (Million Instructions per Second)</strong>: Measures how many millions of instructions a computer can execute in a second. </p>
</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span>
<p><strong>Amdahl's Law</strong>: A rule which states that the performance improvement possible is limited by the amount that the improved component is used.</p>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Ch.2 Instructions: Language of the Computer" dir="auto" class="heading" id="Ch.2_Instructions_Language_of_the_Computer_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.2 Instructions: Language of the Computer</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Instruction Set</strong>: The vocabulary of instructions which a computer can decode and execute.</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong><a data-href="RISC-V" href=".html" class="internal-link" target="_self" rel="noopener nofollow">RISC-V</a></strong>: An open standard instruction set designed to be simple and efficient. RISC stands for (reduced instruction set computing).</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong><a data-href="x86" href=".html" class="internal-link" target="_self" rel="noopener nofollow">x86</a></strong>: An instruction set developed by Intel. x86 is a much more complex instruction set, allowing for more high-level operations.</li>
</ul>
</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>
<p><strong>Stored-Program Concept</strong>: The idea that programs themselves can be stored in computer memory, allowing for more flexibility by making programs easier to modify. The stored-program concept also enables dynamic program execution.</p>
</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The principles of hardware design are:</p>
<ol>
<li data-line="7" dir="auto"><strong>Simplicity Favors Regularity</strong>.</li>
<li data-line="8" dir="auto"><strong>Smaller is Faster</strong>.</li>
<li data-line="9" dir="auto"><strong>Good Design Demands Good Compromises</strong>.</li>
</ol>
</li>
<li data-line="11" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Every computer must be able to perform arithmetic. The RISC-V add instruction is <code>add a, b, c</code>.</p>
<ul class="has-list-bullet">
<li data-line="12" dir="auto"><span class="list-bullet"></span>This instruction adds variables <code>b</code> and <code>c</code>, and stores their result in <code>a</code>. There is also a corresponding <code>sub</code> instruction with the same format.</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Each RISC-V arithmetic instruction takes three operands and performs exactly one operation on them.
<ul class="has-list-bullet">
<li data-line="14" dir="auto"><span class="list-bullet"></span>The operands of arithmetic instructions must come from <strong>registers</strong>. Therefore, if a variable is in memory, it must first be loaded into a register in order to be able to operate on it.</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span>Requiring each instruction to have exactly three operands conforms to the principle <strong>simplicity favors regularity</strong>.</li>
</ul>
</li>
</ul>
</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Byte</strong>: A group of 8 bits. Each bit is a binary digit.</p>
<ul class="has-list-bullet">
<li data-line="18" dir="auto"><span class="list-bullet"></span><strong>Word</strong>: A group of 32 bits, or four bytes.</li>
<li data-line="19" dir="auto"><span class="list-bullet"></span><strong>Doubleword</strong>: A group of 64 bits, or two words.</li>
</ul>
</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Register" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Register</a></strong>: Small, fast memory locations inside the CPU that hold temporary data during processing.</p>
<ul class="has-list-bullet">
<li data-line="22" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V has a set of 32 <em>general-purpose registers</em>. These registers are denoted as <code>x0-x31</code>. Each register is 32 bits (one word) wide. The RISC-V convention is the letter <code>x</code>, followed by the register number. Registers are visible to the programmer.</p>
<ul class="has-list-bullet">
<li data-line="23" dir="auto"><span class="list-bullet"></span>
<p>Using only 32 registers conforms to the design principle <strong>smaller is faster</strong>.</p>
</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Having more than 32 registers may increase the clock cycle time since electrical signals must travel farther.</p>
<ul class="has-list-bullet">
<li data-line="25" dir="auto"><span class="list-bullet"></span>Since most programs need to store more than 32 variables, the compiler tries to keep the most frequently used variables in registers, in order to minimize the number of data transfer instructions required. The compiler puts less frequently used variables in memory, this process is called <em>spilling registers</em>.</li>
</ul>
</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>
<p>RISC-V dedicates the register <code>x0</code> to be hard-wired to the value 0, regardless of what operations are performed on it.</p>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>To access data in main memory, <strong>data transfer instructions</strong> are used. To access a word in memory, the instruction must supply a memory <strong>address</strong>.</p>
<ul class="has-list-bullet">
<li data-line="30" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V uses <strong>byte addressing</strong>, meaning sequential addresses differ by one byte. Since each word has 4 bytes, the addresses of sequential words differ by 4 bytes.</p>
<ul class="has-list-bullet">
<li data-line="31" dir="auto"><span class="list-bullet"></span>Some computers use the address of the <strong>most-significant bit</strong>, the leftmost bit, as the word address; while other computers use the address of the <strong>least-significant bit</strong>, the rightmost bit, as the word address. RISC-V uses the latter, this is referred to as <em>little-endian</em>.</li>
<li data-line="32" dir="auto"><span class="list-bullet"></span>Byte addressing also effects the array index. If you want to get the first element from a base address, you offset the base address with 0, <code>lw x5, 0(x6)</code>. To access the next element in the array, you need to offset the base address by the size of each element, in this case, the size of each word is 4 bytes. Therefore, the next element would be loaded using <code>lw x5, 4(x6)</code>.</li>
</ul>
</li>
<li data-line="34" dir="auto"><span class="list-bullet"></span>
<p>Memory is just a large single-dimensional array, so addressing acts as the index to the array.</p>
</li>
<li data-line="35" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>To copy a value in memory to a register, the <em>load</em> instruction is used. To save the value of a register into memory, a <em>store</em> instruction is used.</p>
<ul class="has-list-bullet">
<li data-line="36" dir="auto"><span class="list-bullet"></span>For example, in the instruction <code>lw x5, 40(x6)</code>, the register <code>x6</code> stores the <strong>base</strong> memory address. That memory address is offset by the immediate value 40, and the data in the new memory address is stored in register <code>x5</code>. The instruction <code>lw</code> stands for <em>load word</em>.</li>
<li data-line="37" dir="auto"><span class="list-bullet"></span>The instruction <code>sw x5, 40(x6)</code> stores the data in register <code>x5</code> in the memory address in register , plus the offset 40. The instruction <code>sw</code> stands for <em>store word</em>.</li>
</ul>
</li>
</ul>
</li>
<li data-line="39" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V assembly language includes arithmetic, data transfer, logical, conditional/unconditional branch, and shift instructions.</p>
<ul class="has-list-bullet">
<li data-line="40" dir="auto"><span class="list-bullet"></span>A more detailed description of the RISC-V assembly language is described <a data-tooltip-position="top" aria-label="RISC-V" data-href="RISC-V" href=".html" class="internal-link" target="_self" rel="noopener nofollow">here</a>.</li>
</ul>
</li>
<li data-line="42" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Many programs require the use of <strong>constants</strong> in operations. In RISC-V, these constants are called <strong>immediates</strong>, and RISC-V offers versions of the arithmetic instructions where one of the operands is an immediate.</p>
<ul class="has-list-bullet">
<li data-line="43" dir="auto"><span class="list-bullet"></span>The instruction <code>addi x5, x6, 4</code>, stores the sum of the value in register <code>x6</code> and 4 in the register <code>x5</code>. <code>addi</code> stands for <em>add immediate</em>.</li>
</ul>
</li>
<li data-line="45" dir="auto"><span class="list-bullet"></span>
<p><strong>Overflow</strong> occurs when the result of an operation is larger than the register it is to be stored in.</p>
</li>
<li data-line="47" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Twos's Complement" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Twos's Complement</a></strong>: A method for representing <strong>signed</strong> numbers in binary form.</p>
<ul class="has-list-bullet">
<li data-line="48" dir="auto"><span class="list-bullet"></span>
<p>In two's complement, the value of the <strong>most-significant bit</strong> (the leftmost bit) determines the sign of the value. If the most-significant bit is a 1, the value is negative, else, it is positive.</p>
</li>
<li data-line="49" dir="auto"><span class="list-bullet"></span>
<p>Positive numbers are represented the same way as in standard binary notation.</p>
</li>
<li data-line="50" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Negative numbers are represented by taking the corresponding positive representation, flipping all the bits, then adding 1. The flipping of the bits without adding 1 is referred to as <strong><a data-href="One's Complement" href=".html" class="internal-link" target="_self" rel="noopener nofollow">One's Complement</a></strong>.</p>
<ul class="has-list-bullet">
<li data-line="51" dir="auto"><span class="list-bullet"></span>For example, to represent -5 in two's complement, we start with the binary representation of 5, which is <code>0000 0101</code>. We then flip each bit, resulting in the one's complement representation <code>1111 1010</code>. Then we add one, <code>1111 1011</code>.</li>
</ul>
</li>
<li data-line="53" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Sign extension</strong> is a technique used to preserve the sign bit of a number when converting from a smaller bit-width to a larger one. If you're loading a signed byte into a 4 byte register, the three remaining bytes should be filled with 0's if the number is positive, and 1's if the number is negative.</p>
<ul class="has-list-bullet">
<li data-line="54" dir="auto"><span class="list-bullet"></span>RISC-V offers a <em>load byte unsigned</em> instruction <code>lbu</code>, which zero-extends the leftmost bits with 0 regardless of the sign of the number. The <em>load byte</em> instruction, <code>lb</code>, preserves the sign of the data.</li>
</ul>
</li>
</ul>
</li>
<li data-line="56" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Instruction Format</strong>: Each RISC-V instruction is 32 bits long. The layout of each segment of the instruction is the instruction format. Each segment of the instruction is referred to as a <strong>field</strong>. The binary representation of the assembly instruction is referred to as <strong><a data-href="Machine Language" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Machine Language</a></strong> and a sequence of such instructions is called machine code.</p>
<ul class="has-list-bullet">
<li data-line="57" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>R-Type</strong> (register type) instruction format is used when all three operands of the instruction are registers, such as arithmetic or logical instructions. The R-type instruction format has the following fields:</p>
<ol>
<li data-line="58" dir="auto"><strong>opcode</strong>: Denotes the operation and instruction format of the instruction. The opcode is 7 bits wide.</li>
<li data-line="59" dir="auto"><strong>rd</strong>: The destination register which receives the operation. This field, like all register fields, is 5 bits wide.</li>
<li data-line="60" dir="auto"><strong>funct3</strong>: An additional opcode field. This field is 3 bits wide.</li>
<li data-line="61" dir="auto"><strong>rs1</strong>: The first register operand. This field is 5 bits wide.</li>
<li data-line="62" dir="auto"><strong>rs2</strong>: The second register operand. This field is 5 bits wide.</li>
<li data-line="63" dir="auto"><strong>funct7</strong>: An additional opcode field. This field is 7 bits wide.</li>
</ol>
</li>
<li data-line="65" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>I-Type</strong> (immediate type) instruction format is used for arithmetic or logical instructions where one of the operands is a constant value. The load word instruction, <code>lw</code>, is also an I-type instruction where the immediate represents the address offset. the I-type instruction format has the following fields:</p>
<ol>
<li data-line="66" dir="auto"><strong>opcode</strong>: Denotes the operation and instruction format of the instruction. The opcode is 7 bits wide.</li>
<li data-line="67" dir="auto"><strong>rd</strong>: The destination register which receives the operation. This field, like all register fields, is 5 bits wide.</li>
<li data-line="68" dir="auto"><strong>funct3</strong>: An additional opcode field. This field is 3 bits wide.</li>
<li data-line="69" dir="auto"><strong>rs1</strong>: The first register operand. This field is 5 bits wide.</li>
<li data-line="70" dir="auto"><strong>immediate</strong>: A 12 bit two's complement value which stores the constant operand.</li>
</ol>
</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>S-Type</strong> (store type) instruction format is used for <code>sw</code> (store word) instructions. In this format, the 12 bit immediate is split into two fields to ensure that the rs1 and rs2 fields are in the same bits for all formats. The S-type instruction format has the following fields:</p>
<ol>
<li data-line="73" dir="auto"><strong>opcode</strong>: Denotes the operation and instruction format of the instruction. The opcode is 7 bits wide.</li>
<li data-line="74" dir="auto"><strong>immediate[4:0]</strong>: The lower 5 bits of the 12 bit immediate.</li>
<li data-line="75" dir="auto"><strong>funct3</strong>: An additional opcode field. This field is 3 bits wide.</li>
<li data-line="76" dir="auto"><strong>rs1</strong>: The first register operand. This field is 5 bits wide.</li>
<li data-line="77" dir="auto"><strong>rs2</strong>: The second register operand. This field is 5 bits wide.</li>
<li data-line="78" dir="auto"><strong>immediate[11:5]</strong>: The upper 7 bits of the 12 bit immediate.</li>
</ol>
</li>
</ul>
</li>
<li data-line="80" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Hexadecimal" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Hexadecimal</a></strong>: A base-16 numerical system where values 0-9 represent the numbers 0 to 9, and values A-F represent values 10 to 15.</p>
<ul class="has-list-bullet">
<li data-line="81" dir="auto"><span class="list-bullet"></span>Memory addresses are commonly represented in hexadecimal notation.</li>
</ul>
</li>
<li data-line="83" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Logical operations</strong> are used to operate on individual bits, or fields of bits. These operations are also called <strong>bit-wise operations</strong>.</p>
<ul class="has-list-bullet">
<li data-line="84" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Shifts</strong> move all the bits in a variable either right or left, filling the emptied bits with 0's. Shifting left by <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> bits is the same as multiplying by <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span>, while shifting right by <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> bits is the same as dividing by <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span>.
<ul class="has-list-bullet">
<li data-line="85" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The RISC-V shift operations include <code>slli</code> (<em>shift left logical immediate</em>) and <code>srli</code> (<em>shift right logical immediate</em>). These instructions take as arguments, a destination register, the register to shift, and the amount to shift by. These instructions use the I-type instruction format.
<ul class="has-list-bullet">
<li data-line="86" dir="auto"><span class="list-bullet"></span>For example, the instruction <code>slli x11, x19, 4</code> takes the data in register <code>x19</code>, shifts it left 4 times, fills the emptied bits with zeros, and stores the result in <code>x11</code>.U-type</li>
</ul>
</li>
<li data-line="87" dir="auto"><span class="list-bullet"></span>RISC-V also provides a <code>srai</code> (<em>shift right arithmetic immediate</em>), which fills the emptied bits with copies of the sign bit to preserve the sign of the data.</li>
</ul>
</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>RISC-V also provides bitwise <code>and</code>, <code>or</code>, <code>xor</code> instructions, as well as their immediate counterparts <code>andi</code>, <code>ori</code>, and <code>xori</code>.
<ul class="has-list-bullet">
<li data-line="90" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The <code>and</code> instruction leaves a 1 in a bit position only if both operands have a 1 in that position.
<ul class="has-list-bullet">
<li data-line="91" dir="auto"><span class="list-bullet"></span>The <code>and</code> instruction is commonly used to create a <strong><a data-href="Bit Mask" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Bit Mask</a></strong>, which is used to force certain bits to 0.</li>
</ul>
</li>
<li data-line="92" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The <code>or</code> instruction leaves a 1 in a bit position if either operand has a 1 in that position.
<ul class="has-list-bullet">
<li data-line="93" dir="auto"><span class="list-bullet"></span>The <code>or</code> instruction is commonly used to <strong>set</strong> certain bits to 1.</li>
</ul>
</li>
<li data-line="94" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The <code>xor</code> instruction leaves a 1 in a bit position if <strong>exactly</strong> one operand has a 1 in that position.
<ul class="has-list-bullet">
<li data-line="95" dir="auto"><span class="list-bullet"></span>The <code>xor</code> instruction can be used to with an immediate operand where all bits are 1 to perform a bitwise <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> operation.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Decision-making</strong> statements allow a computer to perform different operations conditionally.</p>
<ul class="has-list-bullet">
<li data-line="98" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Conditional branches</strong> are a type of decision-making instruction which branch to a certain instruction if a condition holds true.</p>
<ul class="has-list-bullet">
<li data-line="99" dir="auto"><span class="list-bullet"></span>The <code>beq</code> (<em>branch if equal</em>) instruction branches to an address if two registers are equal. For example, the instruction <code>beq x2, x3, L1</code> branches to the statement labelled <code>L1</code> if the data in registers <code>x2</code> and <code>x3</code> are equal.</li>
<li data-line="100" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>RISC-V also provides:
<ul class="has-list-bullet">
<li data-line="101" dir="auto"><span class="list-bullet"></span><code>bne</code> (<em>branch if not equal</em>)</li>
<li data-line="102" dir="auto"><span class="list-bullet"></span><code>blt</code> (<em>branch if less than</em>)</li>
<li data-line="103" dir="auto"><span class="list-bullet"></span><code>bge</code> (<em>branch if greater than or equal</em>)</li>
<li data-line="104" dir="auto"><span class="list-bullet"></span><code>bltu</code> (<em>branch if less than unsigned</em>)</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span><code>bgeu</code> (<em>branch if greater than or equal unsigned</em>)</li>
</ul>
</li>
</ul>
</li>
<li data-line="107" dir="auto"><span class="list-bullet"></span>
<p><strong>Loops</strong> are used to iterate a computation a number of times. Loops are constructed in assembly language using the conditional branches discussed earlier.</p>
</li>
<li data-line="109" dir="auto"><span class="list-bullet"></span>
<p><strong>Basic Blocks</strong> are a sequence of assembly instructions which execute linearly without any jumps or branches.</p>
</li>
<li data-line="111" dir="auto"><span class="list-bullet"></span>
<p><strong>Unconditional branches</strong> always branch to a certain instruction. Unconditional branches will be explained further in the section about <strong>procedures</strong>.</p>
</li>
<li data-line="113" dir="auto"><span class="list-bullet"></span>
<p><strong>Case/Switch statements</strong> are commonly encoded as a table of addresses called a <strong>branch address table</strong>. This allows the program to index the table directly with the variable used in the condition.</p>
</li>
</ul>
</li>
<li data-line="115" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Procedures</strong>, or functions, are subroutines of a program which get passed arguments, which are then used to perform a specific task. Procedures can also return results.</p>
<ul class="has-list-bullet">
<li data-line="116" dir="auto"><span class="list-bullet"></span>
<p>The <strong>caller</strong> is the program that called the procedure. The <strong>callee</strong> is the procedure that was called.</p>
</li>
<li data-line="118" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>To execute a procedure, the program must:</p>
<ol>
<li data-line="119" dir="auto">Put parameters in a place that is accessible to the procedure.</li>
<li data-line="120" dir="auto"><strong>Transfer control</strong> to the procedure.</li>
<li data-line="121" dir="auto">Acquire the storage resources needed for the procedure.</li>
<li data-line="122" dir="auto">Perform the desired task.</li>
<li data-line="123" dir="auto">Put the result value in a place accessible to the calling program.</li>
<li data-line="124" dir="auto">Return control to the <strong>caller</strong>.</li>
</ol>
</li>
<li data-line="126" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V allocates its 32 registers using the following convention for procedure calling:</p>
<ul class="has-list-bullet">
<li data-line="127" dir="auto"><span class="list-bullet"></span>
<p><code>x1</code>: One register for storing the <strong>return address</strong> of the caller.</p>
</li>
<li data-line="128" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><code>x10-x17</code>: Eight registers for passing parameters and return values.</p>
<ul class="has-list-bullet">
<li data-line="129" dir="auto"><span class="list-bullet"></span>
<p>If a procedure needs more registers than the eight allocated for arguments, then we would need to <strong>spill registers</strong> to memory. This is typically done using a <a data-href="Stack" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Stack</a> data structure, which is a LIFO (<em>last-in first-out</em>) structure.</p>
</li>
<li data-line="130" dir="auto"><span class="list-bullet"></span>
<p>A stack keeps a <a data-href="Pointer" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Pointer</a> to the most recently allocated address. In RISC-V, the stack pointer is commonly stored in register <code>x2</code>, also called <code>sp</code>.</p>
</li>
<li data-line="131" dir="auto"><span class="list-bullet"></span>
<p>Placing data onto the stack is called a <strong>push</strong>, while removing data from the stack is a <strong>pop</strong>.</p>
</li>
<li data-line="132" dir="auto"><span class="list-bullet"></span>
<p>Stacks typically grow from higher addresses to lower addresses. That means, to push values onto the stack you must decrement the stack pointer by 4. While adding to the stack pointer shrinks the stack.</p>
</li>
<li data-line="134" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V also separates 19 of the 32 registers into one of two groups:</p>
<ol>
<li data-line="135" dir="auto"><code>x5-x7</code> and <code>x28-x31</code>: Temporary registers that are not preserved by the callee on a procedure call. </li>
<li data-line="136" dir="auto"><code>x8-x9</code> and <code>x18-x27</code>: Saved registers which must be preserved by the callee.</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="138" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V provides an unconditional branch instruction, also called a <em>jump</em> instruction, specifically for procedures.</p>
<ul class="has-list-bullet">
<li data-line="139" dir="auto"><span class="list-bullet"></span>The <code>jal</code> (<em>jump and link</em>) instruction branches to an address, and simultaneously stores the address of the following instruction in the destination register, typically <code>x1</code>. The address </li>
<li data-line="140" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The <code>jalr</code> (<em>jump and link register</em>) instruction branches to an address stored in a register. This is typically used to by a procedure to return to the return address of the caller.
<ul class="has-list-bullet">
<li data-line="141" dir="auto"><span class="list-bullet"></span>For example, the instruction <code>jalr x0, 0(x1)</code> jumps to the address stored in <code>x1</code>, without storing the current address by dumping it to register <code>x0</code>.</li>
</ul>
</li>
</ul>
</li>
<li data-line="143" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Program Counter" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Program Counter</a> (PC)</strong>: The register which holds the address of the current instruction being executed.</p>
</li>
<li data-line="145" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Leaf procedures</strong> are procedures that do not call any other procedures. If a procedure does call other procedures, it is a <strong>nonleaf procedure</strong>.</p>
<ul class="has-list-bullet">
<li data-line="146" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Recursive procedures</strong> are procedures that invoke <em>clones</em> of themselves.
<ul class="has-list-bullet">
<li data-line="147" dir="auto"><span class="list-bullet"></span>Some recursive functions can be implemented <strong>iteratively</strong>, which can significantly reduce overhead.</li>
</ul>
</li>
<li data-line="148" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To handle nonleaf procedures, care must be taken that the argument and return address registers are not overwritten. One solution is to push all the other registers that must be preserved onto the stack; then upon the return, the registers are restored from memory, and the stack pointer is readjusted.
<ul class="has-list-bullet">
<li data-line="149" dir="auto"><span class="list-bullet"></span>The stack pointer, <code>sp</code>, is preserved by the procedure by adding exactly the same amount of bytes that was subtracted from it.</li>
</ul>
</li>
</ul>
</li>
<li data-line="151" dir="auto"><span class="list-bullet"></span>
<p>The portion of the stack that is used to store a procedure's spilled registers is called the <a data-href="Procedure Frame" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Procedure Frame</a>. Some RISC-V compilers use register <code>x8</code> as a <strong>frame pointer</strong>, which points to the first word in the procedure frame.</p>
</li>
</ul>
</li>
<li data-line="153" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Storage Classes" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Storage Classes</a></strong>: The C language supports the <code>auto</code> and <code>static</code> storage classes. These storage classes define the lifetime, and scope of the variable.</p>
<ul class="has-list-bullet">
<li data-line="154" dir="auto"><span class="list-bullet"></span><code>auto</code> is the default storage class for any variable declared inside a function/procedure. These variables are local to the procedure and are discarded when the procedure exits.</li>
<li data-line="155" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><code>static</code> is the default storage class for variables that are not declared within any function. These variables are commonly called <em>global variables</em>. Static variables are preserved across function calls.
<ul class="has-list-bullet">
<li data-line="156" dir="auto"><span class="list-bullet"></span>Some RISC-V compilers reserve register <code>x3</code> for the <strong>global pointer</strong>, that is, the register reserved for pointing to static data.</li>
</ul>
</li>
</ul>
</li>
<li data-line="158" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>In the <a data-href="Linux" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Linux</a> <a data-href="Operating System" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Operating System</a>, memory is allocated as follows:</p>
<ol>
<li data-line="159" dir="auto"><strong>Reserved Memory</strong>: The first portion of low-end memory is reserved for the operating system and system-level functions.</li>
<li data-line="160" dir="auto"><strong>Text Segment</strong>: Following this is the <strong>text segment</strong>, which contains the machine code for the routines defined in the source file.</li>
<li data-line="161" dir="auto"><strong>Static Data Segment</strong>: Above the text segment lies the <strong>static data segment</strong>, which holds static and constant variables.</li>
<li data-line="162" dir="auto"><strong><a data-href="Heap" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Heap</a></strong>: The static data segment is followed by the <strong>heap</strong>, which is used for dynamic data structures, such as <a data-tooltip-position="top" aria-label="Linked List" data-href="Linked List" href=".html" class="internal-link" target="_self" rel="noopener nofollow">linked lists</a>. The heap typically grows upwards, while the stack grows downwards towards the heap.</li>
</ol>
</li>
<li data-line="164" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><a data-href="Dynamic Memory Allocation" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Dynamic Memory Allocation</a>: The C language provides explicit functions for memory allocation. The <code>malloc()</code> function allocates space on the <strong>heap</strong> and returns a <a data-href="Pointer" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Pointer</a> to it. The <code>free()</code> function releases space on the heap to which the passed pointer points to.</p>
<ul class="has-list-bullet">
<li data-line="165" dir="auto"><span class="list-bullet"></span>Forgetting to free memory which is no longer in use causes a <a data-href="Memory Leak" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Memory Leak</a>. This is the cause of many bugs in C programs.</li>
<li data-line="166" dir="auto"><span class="list-bullet"></span>If memory is freed too early, this creates <strong>dangling pointers</strong>, which are pointers that point to some unknown data in the heap.</li>
</ul>
</li>
<li data-line="168" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="ASCII" href=".html" class="internal-link" target="_self" rel="noopener nofollow">ASCII</a></strong>: A character encoding standard which represents characters as 8-bit bytes. Though, since RISC-V software is required to keep the stack aligned to <strong>quadword</strong> (16 byte) addresses, a <code>char</code> variable may occupy as much as 16 bytes.</p>
<ul class="has-list-bullet">
<li data-line="169" dir="auto"><span class="list-bullet"></span>RISC-V provides instructions to transfer bytes including <code>lbu</code> (<em>load byte unsigned</em>), which loads a byte from memory and places it in the 8 rightmost bits of a register. The <code>lb</code> (<em>load byte</em>) instruction sign extends the byte. The <code>sb</code> (<em>store byte</em>) instruction takes the 8 rightmost bits of a register and writes it to memory.</li>
<li data-line="170" dir="auto"><span class="list-bullet"></span>Characters are normally combined to form <a data-tooltip-position="top" aria-label="String" data-href="String" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Strings</a>. In C, the end of a string is denoted by the <em>null character</em> <code>\0</code>.</li>
</ul>
</li>
<li data-line="172" dir="auto"><span class="list-bullet"></span>
<p>RISC-V provides instructions to load and store 16-bit <em>halfwords</em> including <code>lhu</code> (<em>load half unsigned</em>), <code>lh</code> (<em>load half</em>), and <code>sh</code> (<em>store half</em>).</p>
</li>
<li data-line="174" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V provides the <code>lui</code> (<em>load upper immediate</em>) instruction, which loads a 20-bit constant into the top 20 bits of a register, the lower 12 bits are filled with zeros. This instruction enables the creation of a 32 bit constant with 2 instructions.</p>
<ul class="has-list-bullet">
<li data-line="175" dir="auto"><span class="list-bullet"></span>The first instruction, <code>lui</code>, loads bits 12-31 of the immediate, followed by an <code>addi</code> instruction to load to bottom 12 bits.</li>
<li data-line="176" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><code>lui</code> uses a new instruction format, the <strong>U-type</strong> format, since other formats cannot accommodate a 20 bit immediate. The U-type format has the following fields:
<ol>
<li data-line="177" dir="auto"><strong>opcode</strong>: Denotes the operation and instruction format of the instruction. The opcode is 7 bits wide.</li>
<li data-line="178" dir="auto"><strong>rd</strong>: The destination register which receives the operation. This field, like all register fields, is 5 bits wide.</li>
<li data-line="179" dir="auto"><strong>immediate[31:12]</strong>: The upper 20 bits of the immediate.</li>
</ol>
</li>
</ul>
</li>
<li data-line="181" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="PC-Relative Addressing" href=".html" class="internal-link" target="_self" rel="noopener nofollow">PC-Relative Addressing</a></strong>: An addressing scheme where the address to branch or jump to is the sum of the current program counter, and the constant/immediate in the instruction.</p>
<ul class="has-list-bullet">
<li data-line="182" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V uses PC-relative addressing for both conditional branches and unconditional jumps. Procedure calls, on the other hand, may need to jump to addresses that are very far from the current PC. RISC-V allows for very long jumps using 2 instructions:</p>
<ol>
<li data-line="183" dir="auto">The <code>lui</code> (<em>load upper immediate</em>) instruction writes the upper 20 bits of the address to a temporary register.</li>
<li data-line="184" dir="auto">The <code>jalr</code> (<em>jump and link register</em>) instruction adds the lower 12 bits of the address to the register and jumps to the sum.</li>
</ol>
</li>
<li data-line="186" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V branch instructions represent the number of <em>halfwords</em> (2 bytes) between the branch and the branch target.</p>
<ul class="has-list-bullet">
<li data-line="187" dir="auto"><span class="list-bullet"></span>Note that RISC-V instructions have <strong>byte addresses</strong>, meaning sequential words (4 bytes) differ by 4.</li>
</ul>
</li>
</ul>
</li>
<li data-line="189" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Addressing Mode" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Addressing Mode</a></strong>: Defines how operands are identified to determine an address. In RISC-V, the primary addressing modes are as follows:</p>
<ol>
<li data-line="190" dir="auto"><strong>Immediate Addressing</strong>: The operand is a constant within the instruction.</li>
<li data-line="191" dir="auto"><strong>Register Addressing</strong>: The operand is a register.</li>
<li data-line="192" dir="auto"><strong>Base Addressing</strong>: The operand is at the memory location defined as the sum of the base address stored in a register, and an immediate in the instruction.</li>
<li data-line="193" dir="auto"><strong>PC-Relative Addressing</strong>: The branch address is the sum of the current PC and an immediate in the instruction.</li>
</ol>
</li>
<li data-line="195" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Parallel execution</strong> is when multiple processors perform tasks simultaneously. Parallelism is simple to implement if tasks are independent, though in the real world, tasks often need to cooperate.</p>
<ul class="has-list-bullet">
<li data-line="196" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Cooperation means some tasks are writing values that others must read. When tasks cooperate, care must be taken to ensure that the processes are <strong>synchronized</strong>, else a <a data-href="Data Race" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Data Race</a> may occur.</p>
<ul class="has-list-bullet">
<li data-line="197" dir="auto"><span class="list-bullet"></span>A data race occurs when two or more memory accesses to the same location occur across threads simultaneously and at least one is a write operation. This leads to unpredictable results because the final value of the shared data depends on the order of the memory accesses.</li>
</ul>
</li>
<li data-line="199" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>An <strong>atomic exchange</strong> is an operation which interchanges a value in a register for a value in memory. The operation is atomic because the exchange is <strong>indivisible</strong>, meaning nothing can happen in between the memory read and write.</p>
<ul class="has-list-bullet">
<li data-line="200" dir="auto"><span class="list-bullet"></span>The pair of instructions is effectively atomic if all other operations performed by all processors occur before or after the pair.</li>
<li data-line="201" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In RISC-V, the pair of instructions include a special load <code>lr.w</code> (<em>load-reserved word</em>) and a special store <code>sc.w</code> (<em>store-conditional word</em>). These instructions are used in sequence, if the contents of the memory location specified by the load are changed before the store to the same address occurs, then the store-conditional fails and aborts the write operation.
<ul class="has-list-bullet">
<li data-line="202" dir="auto"><span class="list-bullet"></span><code>sc.w</code> specifies three registers: one to hold the address, one to indicate whether the operation failed or succeeded, and one to hold the value to be stored. Store-conditional returns 0 only if it succeeds, and writes a non-zero value otherwise. A loop is typically implemented to continue attempting the store-conditional until it returns a zero.</li>
</ul>
</li>
</ul>
</li>
<li data-line="204" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Lock and unlock</strong> synchronization mechanisms create regions, called <em>mutual exclusions</em>, where only a single processor can operate. To implement synchronization in a multiprocessor, the ability to <strong>atomically</strong> read and write a memory location is critical.</p>
<ul class="has-list-bullet">
<li data-line="205" dir="auto"><span class="list-bullet"></span>A lock is a synchronization primitive which allows a processor to create a mutual exclusion. If two or more threads try to perform an exchange simultaneously, the processor which performs the exchange first will lock the memory, preventing the other processor from operating on the memory until the first processor unlocks it.</li>
</ul>
</li>
</ul>
</li>
<li data-line="207" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The steps to translate a C program into a program running on the computer are:</p>
<ol>
<li data-line="208" dir="auto"><strong>Preprocessing</strong>: The C preprocessor handles preprocessor directives such as <code>#include</code> and <code>#define</code> and removes comments.</li>
<li data-line="209" dir="auto"><strong>Compilation</strong>: The compiler translates the C program into an assembly language program.</li>
<li data-line="210" dir="auto"><strong>Assembly</strong>: The assembler translates the assembly language into machine language. This results in the creating of an <a data-href="Object File" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Object File</a> which has a <code>.o</code> or <code>.obj</code> file extension. The assembler uses a <a data-href="Symbol Table" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Symbol Table</a> to keep track of labels used in branches and data transfer instructions. The assembler may also use <strong>pseudoinstructions</strong>, which are abstractions of assembly language to make the assembly language more readable.</li>
<li data-line="211" dir="auto"><strong>Linking</strong>: The <a data-href="Linker" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Linker</a> is responsible for combining multiple object files into a single <strong>executable</strong>. The linker makes it possible to compile and assemble procedures independently, thus allowing for local changes in a procedure without having to recompile the entire program.</li>
<li data-line="212" dir="auto"><strong>Loading</strong>: The loader is responsible for loading the executable file into memory and setting up the program's runtime environment.</li>
</ol>
</li>
<li data-line="214" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Dynamically Linked Libraries" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Dynamically Linked Libraries</a> (DLLs)</strong>: Library routines that are linked to a program at runtime rather than compile time.</p>
<ul class="has-list-bullet">
<li data-line="215" dir="auto"><span class="list-bullet"></span>DLLs allow for multiple programs to share the same library code, thus, reducing memory requirements.</li>
</ul>
</li>
<li data-line="217" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-tooltip-position="top" aria-label="Pointer" data-href="Pointer" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Pointers</a></strong>: In the C language, pointers are variables that store <em>addresses</em>.</p>
<ul class="has-list-bullet">
<li data-line="218" dir="auto"><span class="list-bullet"></span>It is a common <strong>fallacy</strong> to believe that using pointers rather than array indices leads to more efficient programs. Though, modern compilers can produce code for array indexing that is just as efficient as pointers.</li>
</ul>
</li>
<li data-line="220" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Modern C compilers adhere to the following structure:</p>
<ul class="has-list-bullet">
<li data-line="221" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Front-End</strong>: Responsible for checking the syntax and semantics of the source program, and translating the source into an <em>intermediate form</em>. The front-end includes four separate functions:</p>
<ol>
<li data-line="222" dir="auto"><strong>Scanning</strong> reads in characters and <strong>tokenizes</strong> them. Tokens include reserved words, names, operators, etc.</li>
<li data-line="223" dir="auto"><strong>Parsing</strong> takes the <em>token stream</em>, validates its syntax, and produces an <em>abstract syntax stream</em>, which is a representation of the syntactic structure of the program.</li>
<li data-line="224" dir="auto"><strong>Semantic analysis</strong> takes the abstract syntax tree and checks for semantic correctness. This includes checking for the proper declaration of variable types, and that the types of operators and objects match. This process is called <em>type checking</em>. During this process, a <em>symbol table</em> is generated representing all named classes, variables, and functions, which is used to type check the program.</li>
<li data-line="225" dir="auto"><strong>Intermediate representation generation</strong> takes the symbol table and abstract syntax tree and generates the intermediate representation as the output of the front end. Intermediate representations usually use simple operations on a set of <em>primitive types</em>. The most common forms look similar to the RISC-V assembly language with an infinite number of virtual registers.</li>
</ol>
</li>
<li data-line="227" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>High-Level Optimizations</strong>: Transformations that are done close to source level. The most common high-level optimizations performed include <a data-href="Procedure Inlining" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Procedure Inlining</a> and <a data-href="Loop Unrolling" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Loop Unrolling</a>.</p>
<ul class="has-list-bullet">
<li data-line="228" dir="auto"><span class="list-bullet"></span><strong>Procedure inlining</strong> replaces a call to a function with the function itself.</li>
<li data-line="229" dir="auto"><span class="list-bullet"></span><strong>Loop unrolling</strong> replicates the body of a loop multiple times. This reduces loop overhead.</li>
</ul>
</li>
<li data-line="231" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Local and Global Optimizations</strong>: This stage includes three classes of optimizations:</p>
<ul class="has-list-bullet">
<li data-line="232" dir="auto"><span class="list-bullet"></span>
<p><strong>Local Optimizations</strong>: Optimizations that are local to a single basic block. This is often run before and after global optimizations.</p>
</li>
<li data-line="233" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Global Optimizations</strong>: Optimizations <em>across</em> multiple basic blocks.</p>
<ul class="has-list-bullet">
<li data-line="234" dir="auto"><span class="list-bullet"></span><strong>Code motion</strong> finds code in the body of a loop that is loop invariant, meaning the code computes the same value for each iteration of the loop. This code can be taken out of the loop and only be computed once.</li>
<li data-line="235" dir="auto"><span class="list-bullet"></span><strong>Data flow analysis</strong> gathers information about how data is read and modified throughout the execution of a program. A <em>control flow graph</em> represents nodes as basic blocks, and arcs represent control flow between basic blocks.</li>
</ul>
</li>
<li data-line="236" dir="auto"><span class="list-bullet"></span>
<p><strong>Global Register Allocation</strong>: Allocates variables to registers for regions of the code.</p>
</li>
<li data-line="237" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Several optimizations are performed both locally and globally, including:</p>
<ul class="has-list-bullet">
<li data-line="238" dir="auto"><span class="list-bullet"></span><strong>Common Subexpression Elimination</strong>: Finds multiple instances of the same expression and computes them only once, storing the result for future use. For example, <code>a = b+c</code> followed by <code>d = b+c</code> and be optimized to <code>a = b+c</code>, <code>d = a</code>.</li>
<li data-line="239" dir="auto"><span class="list-bullet"></span><strong>Constant Propagation</strong>: Collapses constant values whenever possible.</li>
<li data-line="240" dir="auto"><span class="list-bullet"></span><strong>Copy Propagation</strong>: Propagates values that are simple copies of other variables.</li>
<li data-line="241" dir="auto"><span class="list-bullet"></span><strong>Dead Store Elimination</strong>: Finds stores to values that are not used again and eliminates the store. <em>Dead code elimination</em> finds and eliminates unused code.</li>
<li data-line="242" dir="auto"><span class="list-bullet"></span><strong>Strength Reduction</strong>: Replaces complex expressions, such as multiply or divide, with simpler ones like left/right shift.</li>
</ul>
</li>
<li data-line="244" dir="auto"><span class="list-bullet"></span>
<p>Compilers must be <strong>conservative</strong> when optimizing. That is, a compiler should only attempt an optimization if it is certain that it will not affect the functionality of the program.</p>
</li>
<li data-line="246" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Register allocation</strong> is one of the most important optimizations for modern load-store architectures.</p>
<ul class="has-list-bullet">
<li data-line="247" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Global register allocation uses a <strong>region-based approach</strong>, where a region is a section of code during which a particular variable could be allocated to a register. A region is selected using an iterative process:
<ul class="has-list-bullet">
<li data-line="248" dir="auto"><span class="list-bullet"></span>Choose a definition (<em>change</em>) of a variable in a given basic block, add that block to the region.</li>
<li data-line="249" dir="auto"><span class="list-bullet"></span>Find any uses of that definition, which is a data flow analysis problem. Add any basic block that contains such uses, as well as any basic block through which the value passes through to reach a use, to the region.</li>
<li data-line="250" dir="auto"><span class="list-bullet"></span>Find any other definitions that also can affect a use found in the previous step and add the basic blocks containing those definitions, as well as the blocks through which the definitions pass through to reach a use, to the region.</li>
<li data-line="251" dir="auto"><span class="list-bullet"></span>Repeat steps 2 and 3 until convergence.</li>
</ul>
</li>
<li data-line="252" dir="auto"><span class="list-bullet"></span>The set of basic blocks found by this process have the following property: If the designated variable is allocated to a register in all these basic blocks, then there is no need for loading or storing the variable.</li>
<li data-line="253" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Modern global register allocators start by constructing the regions for each virtual register in a function. Since certain regions will overlap, they may not use the same registers. This <em>interference</em> can be organized with an <strong>interference graph</strong>, where each node represents a region, and the arcs between nodes represent that the regions share some basic blocks.
<ul class="has-list-bullet">
<li data-line="254" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Once the interference graph has been constructed, the problem of register allocation is equivalent to the problem of <a data-href="Graph Coloring" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Graph Coloring</a>, where you must color each node in the graph such that no two adjacent nodes are the same color.
<ul class="has-list-bullet">
<li data-line="255" dir="auto"><span class="list-bullet"></span>If the graph cannot be colored using the number of registers available, the allocator must spill registers to memory.</li>
<li data-line="256" dir="auto"><span class="list-bullet"></span>Spilling is equivalent to splitting up a region. When a region is split, loads and stores must be used to get the value from memory.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="258" dir="auto"><span class="list-bullet"></span>
<p>The final steps of the compiler are <strong>code generation</strong> and assembly. Most compilers do not use a stand-alone assembler, they instead perform most of the same functions, such as filling in symbolic values and generating the machine code as the last stage of code generation.</p>
</li>
</ul>
</li>
<li data-line="260" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>In an <a data-href="Object-Oriented Programming" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Object-Oriented Programming</a> language like Java, programmers can think in terms of abstract objects. The type of object is called a <em>class</em>, a particular object is an <em>instance</em> of a class, and creating an instance of an object is called <em>instantiation</em>. The operations in a class are called <em>methods</em>, the variable members of a class are called <em>fields</em>.</p>
<ul class="has-list-bullet">
<li data-line="261" dir="auto"><span class="list-bullet"></span>Inheritance allows for child classes to <em>extend</em> parent classes, which allows the child to redefine some of the methods of its parent, as well as inherit the methods it leaves unchanged.</li>
<li data-line="262" dir="auto"><span class="list-bullet"></span>Java uses an automatic <em>garbage collector</em>, which frees memory without explicit direction from the programmer.</li>
<li data-line="263" dir="auto"><span class="list-bullet"></span>Java programs are distributed as Java <em>bytecodes</em> which are interpreted by the Java Virtual Machine (JVM).</li>
</ul>
</li>
<li data-line="265" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><a data-href="MIPS" href=".html" class="internal-link" target="_self" rel="noopener nofollow">MIPS</a> is another RISC architecture that is widely used in embedded systems.</p>
<ul class="has-list-bullet">
<li data-line="266" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The MIPS instruction set architecture share some common features with RISC-V, including:
<ul class="has-list-bullet">
<li data-line="267" dir="auto"><span class="list-bullet"></span>All instructions are 32 bits wide.</li>
<li data-line="268" dir="auto"><span class="list-bullet"></span>Both have 32 general-purpose registers, with one being hardwired to zero.</li>
<li data-line="269" dir="auto"><span class="list-bullet"></span>There are no instructions for loading or storing many registers.</li>
<li data-line="270" dir="auto"><span class="list-bullet"></span>Both have <em>branch if zero</em> and <em>branch if not zero</em> instructions.</li>
<li data-line="271" dir="auto"><span class="list-bullet"></span>Both sets of addressing modes work for all word sizes.</li>
</ul>
</li>
<li data-line="272" dir="auto"><span class="list-bullet"></span>One of the main differences between RISC-V and MIPS is for conditional branches. While RISC-V simply provides branch instructions to compare two registers, MIPS' comparison instructions set a register to 1 or 0 depending on the outcome of the comparison.</li>
</ul>
</li>
<li data-line="274" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><a data-href="ARMv8" href=".html" class="internal-link" target="_self" rel="noopener nofollow">ARMv8</a> is another RISC ISA, and is the most popular ISA for embedded devices. ARMv8 is very similar to MIPS, though ARMv8 is a 64-bit ISA.</p>
<ul class="has-list-bullet">
<li data-line="275" dir="auto"><span class="list-bullet"></span>V8 has 32 general-purpose registers, where one register is hardwired to zero. </li>
<li data-line="276" dir="auto"><span class="list-bullet"></span>Its addressing modes work for all word sizes.</li>
</ul>
</li>
<li data-line="278" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><a data-href="x86" href=".html" class="internal-link" target="_self" rel="noopener nofollow">x86</a> is a CISC (<em>complex instruction set computing</em>) ISA, which provides more powerful instructions than a RISC architecture with the goal to reduce the instruction count of programs.</p>
<ul class="has-list-bullet">
<li data-line="279" dir="auto"><span class="list-bullet"></span>This reduced instruction count comes at the cost of slower, more complex instructions which may result in a slower clock cycle time.</li>
</ul>
</li>
<li data-line="281" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The RISC-V architecture is partitioned into a base architecture, and several <em>extensions</em>. Each extension is named with a letter of the alphabet with the base architecture labelled as <em>I</em> "Integer".</p>
<ul class="has-list-bullet">
<li data-line="282" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The following are some unmentioned instructions in the base RISC-V architecture:
<ul class="has-list-bullet">
<li data-line="283" dir="auto"><span class="list-bullet"></span><code>auipc</code> is used for PC-relative memory addressing. Like the <code>lui</code> instruction, it holds a 20-bit constant that corresponds to bits 12 through 31 of an integer. This instruction adds this constant to the PC and writes the sum to a register.</li>
<li data-line="284" dir="auto"><span class="list-bullet"></span><code>slt</code> (<em>set less than</em>) and <code>sltu</code> (<em>set less than unsigned</em>) compare two integers and write the Boolean result to a register.</li>
<li data-line="285" dir="auto"><span class="list-bullet"></span><code>slti</code>(<em>set less than immediate</em>) and <code>sltiu</code> (<em>set less than immediate unsigned</em>) do the same but with an immediate as the second register.</li>
</ul>
</li>
<li data-line="286" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The five standard extensions of the base architecture are:
<ol>
<li data-line="287" dir="auto"><strong>M (Multiply and Divide</strong>): Adds instructions for multiplication and division.</li>
<li data-line="288" dir="auto"><strong>A (Atomic Memory Operations)</strong>: Adds atomic memory operations for multiprocessor synchronization.</li>
<li data-line="289" dir="auto"><strong>F and D (Floating-Point)</strong>: Provides operations on floating-point numbers.</li>
<li data-line="290" dir="auto"><strong>C (16-Bit Instructions)</strong>: Provides equivalent instructions that are only 16 bits long.</li>
</ol>
</li>
</ul>
</li>
<li data-line="292" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Some common fallacies and pitfalls include:</p>
<ul class="has-list-bullet">
<li data-line="293" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><em>Fallacy: More powerful instructions <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/mean.html#_0" target="_self" rel="noopener noreferrer" from="36" to="40" origin-text="mean" class="internal-link virtual-link-a">mean</a></span> higher performance.</em>
<ul class="has-list-bullet">
<li data-line="294" dir="auto"><span class="list-bullet"></span>More powerful instructions typically incur more overhead and force a longer clock cycle time.</li>
</ul>
</li>
<li data-line="295" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><em>Fallacy: Write in assembly language to obtain the highest performance.</em>
<ul class="has-list-bullet">
<li data-line="296" dir="auto"><span class="list-bullet"></span>Modern compilers can produce code just as fast or even faster than assembly language programmers.</li>
</ul>
</li>
<li data-line="297" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><em>Pitfall: Forgetting that sequential word addresses in machines with byte addressing do not differ by one.</em>
<ul class="has-list-bullet">
<li data-line="298" dir="auto"><span class="list-bullet"></span>Sequential addresses should be incremented by the number of bytes in a word (<em>typically 4</em>).</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Ch.3 Arithmetic for Computers" dir="auto" class="heading" id="Ch.3_Arithmetic_for_Computers_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.3 Arithmetic for Computers</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Binary <strong>addition</strong> is performed by adding digits bit by bit, from right to left, with carries passed to the next digit. Binary <strong>subtraction</strong> uses addition by simply negating the appropriate operand beforehand.</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>When adding operands with different signs, overflow cannot occur since the result cannot be greater than one of the operands.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>On the other hand, when subtracting, overflow cannot occur if both operands have the <em>same</em> signs. This is because when we subtract operands of the same sign, it is the same as adding operands of different signs since subtraction negates one of the operands.</li>
</ul>
</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Overflow</strong> occurs when the result of a computation cannot fit in the destination register.</p>
<ul class="has-list-bullet">
<li data-line="5" dir="auto"><span class="list-bullet"></span>If adding two 32-bit integers, the 32nd bit may have a carry, thus, resulting in an overflow. In this case, the sign bit (<em>most-significant bit</em>) is set with the <em>value</em> of the result instead of the proper sign of the result. Therefore, overflow occurs when adding two positive numbers results in a negative sum, or vice versa.</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span>Overflow occurs in subtraction when we subtract a negative number from a positive number and get a negative result, or when we subtract a positive number from a negative number and get a positive result. Such results <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/mean.html#_0" target="_self" rel="noopener noreferrer" from="217" to="221" origin-text="mean" class="internal-link virtual-link-a">mean</a></span> that a <em>borrow</em> occurred from the sign bit.</li>
<li data-line="7" dir="auto"><span class="list-bullet"></span>In the case of <strong>unsigned integers</strong>, overflow has occurred if the sum is less than either addends, or the difference is greater than the minuend (<em>the number being subtracted from</em>).</li>
</ul>
</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Arithmetic Logic Unit" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Arithmetic Logic Unit</a> (ALU)</strong>: The hardware component responsible for performing arithmetic and logical operations on data.</p>
<ul class="has-list-bullet">
<li data-line="10" dir="auto"><span class="list-bullet"></span>The ALU is typically capable of performing addition, subtraction, multiplication, division, AND, OR, NOT, and XOR operations.</li>
</ul>
</li>
<li data-line="12" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>In <strong>multiplication</strong>, the first operand is the <em>multiplicand</em>, the second operand is the <em>multiplier</em>, and the result is the <em>product</em>.</p>
<ul class="has-list-bullet">
<li data-line="13" dir="auto"><span class="list-bullet"></span>
<p>If we ignore the sign bits, the length of the multiplication of an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit multiplicand and an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit multiplier is a product that is <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> bits long.</p>
</li>
<li data-line="14" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The algorithm for binary multiplication is similar to that of decimal multiplication. It consists of the following steps:</p>
<ul class="has-list-bullet">
<li data-line="15" dir="auto"><span class="list-bullet"></span>Align the operands one above the other.</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>Starting from the least-significant bit of the multiplier, multiply each bit of the multiplier with the entire multiplicand.</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>For each subsequent bit of the multiplier, shift the <strong>partial product</strong> one position to the left.</li>
<li data-line="18" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Add the partial products to get the product. <span alt="MultiplicationHardware 1.png" src="resources/multiplicationhardware-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="MultiplicationHardware 1.png" src="resources/multiplicationhardware-1.png" target="_self"></span>
<ul class="has-list-bullet">
<li data-line="19" dir="auto"><span class="list-bullet"></span>In this figure, the multiplier is placed in the right half of the product register.</li>
</ul>
</li>
</ul>
</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The simplest way to perform signed multiplication is to convert both operands to their corresponding positive values, and remember the original signs of each operand. If the signs, differ, than the product can be negated to get the signed product.</p>
<ul class="has-list-bullet">
<li data-line="22" dir="auto"><span class="list-bullet"></span>For signed multiplication, the shifting steps would need to sign-extend the sign of the product.</li>
</ul>
</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>
<p>Faster multiplications are possible by providing one 32-bit adder for each bit of the multiplier, one input is the multiplicand ANDed with the multiplier bit, and the other is the output of the previous adder.<span alt="MultiplierParallelTree.png" src="resources/multiplierparalleltree.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="MultiplierParallelTree.png" src="resources/multiplierparalleltree.png" target="_self"></span></p>
</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V has four multiply instructions:</p>
<ul class="has-list-bullet">
<li data-line="26" dir="auto"><span class="list-bullet"></span><code>mul</code>: Multiply</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span><code>mulh</code>: Multiply high, gets the upper 32-bits of a 64-bit product if both operands are signed.</li>
<li data-line="28" dir="auto"><span class="list-bullet"></span><code>mulhu</code>: Multiply high unsigned, gets the upper 32-bits of a 64-bit product if both operands are unsigned.</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span><code>mulhsu</code>: Multiply high signed-unsigned, gets the upper 32-bits of a 64-bit product if one operand is signed and the other is unsigned.</li>
</ul>
</li>
</ul>
</li>
<li data-line="31" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>In <strong>division</strong>, the dividend is the number being divided, the divisor is the number the dividend is divided by, the quotient is the primary result of the division, and the remainder is the secondary result.</p>
<ul class="has-list-bullet">
<li data-line="32" dir="auto"><span class="list-bullet"></span>
<p><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span></p>
</li>
<li data-line="33" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The algorithm for binary division is similar to that of decimal division. It consists of the following steps:</p>
<ul class="has-list-bullet">
<li data-line="34" dir="auto"><span class="list-bullet"></span>Starting from the left, compare the divisor with the portion of the dividend, if the divisor is less than or equal to that portion, subtract the divisor from it.</li>
<li data-line="35" dir="auto"><span class="list-bullet"></span>For each subtraction, write a 1 in the quotient. If the divisor is larger than the partial dividend, write a 0.</li>
<li data-line="36" dir="auto"><span class="list-bullet"></span>Bring down the next bit of the dividend.</li>
<li data-line="37" dir="auto"><span class="list-bullet"></span>Repeat until all the bits of the dividend have been brought down.</li>
<li data-line="38" dir="auto"><span class="list-bullet"></span>If the final subtraction leaves a value smaller than the divisor, that value is the remainder.<span alt="DivisionHardware 1.png" src="resources/divisionhardware-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="DivisionHardware 1.png" src="resources/divisionhardware-1.png" target="_self"></span></li>
</ul>
</li>
<li data-line="39" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The hardware performs this algorithm by initializing the quotient to zero, and the remainder is initialized to the dividend.</p>
<ul class="has-list-bullet">
<li data-line="40" dir="auto"><span class="list-bullet"></span>Next, you subtract the divisor from the remainder, and if the result is positive, a 1 is generated in the quotient; if the result is negative, the original value is restored by adding the divisor, and a 0 is generated in the quotient. The divisor is shifted right, and the algorithm iterates.</li>
</ul>
</li>
<li data-line="41" dir="auto"><span class="list-bullet"></span>
<p>Like multiplication, the easiest way to handle signed division is the remember the signs of the operands and then negate the quotient if the signs disagree. To get the correct sign of the remainder, we match it with the sign of the dividend.</p>
</li>
<li data-line="42" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <a data-href="SRT Division" href=".html" class="internal-link" target="_self" rel="noopener nofollow">SRT Division</a> technique tries to predict several quotient bits per step using a table lookup based on the upper bits of the dividend and remainder.</p>
<ul class="has-list-bullet">
<li data-line="43" dir="auto"><span class="list-bullet"></span>A <a data-href="Nonrestoring Division" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Nonrestoring Division</a> algorithm is even faster, taking only one clock cycle per step. In this algorithm, if the remainder becomes negative, instead of immediately adding the divisor back, it adds the dividend to the shifted remainder in the following step.</li>
</ul>
</li>
<li data-line="45" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V provides 4 division instructions:</p>
<ul class="has-list-bullet">
<li data-line="46" dir="auto"><span class="list-bullet"></span><code>div</code>: Divide</li>
<li data-line="47" dir="auto"><span class="list-bullet"></span><code>divu</code>: Divide unsigned</li>
<li data-line="48" dir="auto"><span class="list-bullet"></span><code>rem</code>: Remainder</li>
<li data-line="49" dir="auto"><span class="list-bullet"></span><code>remu</code>: Remainder unsigned</li>
</ul>
</li>
<li data-line="51" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Note that RISC-V instructions ignore overflow, so it is up to the software to determine whether the quotient is too large.</p>
<ul class="has-list-bullet">
<li data-line="52" dir="auto"><span class="list-bullet"></span>Division can also result in a division by zero, which must also be detected by software.</li>
</ul>
</li>
</ul>
</li>
<li data-line="54" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Floating-Point" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Floating-Point</a></strong>  numbers, also called <em>real numbers</em>, are number with fractional values. The name comes from the fact that the <em>binary point</em> can be placed anywhere in the number.</p>
<ul class="has-list-bullet">
<li data-line="55" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Floating-point numbers are typically represented in binary using <a data-href="Scientific Notation" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Scientific Notation</a>. Scientific notation is made up of a <em>fraction</em>, a <em>base</em>, and an <em>exponent</em>.</p>
<ul class="has-list-bullet">
<li data-line="56" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A number in scientific notation with no zeros to the left of the decimal point is a <strong>normalized</strong> number. For example, <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container></span> is normalized, while <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container></span> are not. Normalized form offers three advantages:
<ul class="has-list-bullet">
<li data-line="57" dir="auto"><span class="list-bullet"></span>It simplifies exchanges of data that include floating-point numbers.</li>
<li data-line="58" dir="auto"><span class="list-bullet"></span>It simplifies floating-point arithmetic algorithms.</li>
<li data-line="59" dir="auto"><span class="list-bullet"></span>It increases the accuracy of the numbers that can be stored in a word.</li>
</ul>
</li>
</ul>
</li>
<li data-line="60" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>A floating-point representation must find a compromise between the size of the fraction, which determines the <strong>precision</strong> of the representation, and the size of the exponent, which determines the <strong><span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/range.html#_0" target="_self" rel="noopener noreferrer" from="0" to="5" origin-text="range" class="internal-link virtual-link-a">range</a></span></strong> of the representation.</p>
<ul class="has-list-bullet">
<li data-line="61" dir="auto"><span class="list-bullet"></span>The RISC-V representation of a floating-point number consists of a sign bit, an 8-bit exponent field, and a 23-bit fraction field.<span alt="riscvFloatingPoint.png" src="resources/riscvfloatingpoint.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscvFloatingPoint.png" src="resources/riscvfloatingpoint.png" target="_self"></span></li>
<li data-line="62" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Overflow</strong> occurs in floating-point representations when the exponent is too large to fit in the exponent field.
<ul class="has-list-bullet">
<li data-line="63" dir="auto"><span class="list-bullet"></span>Floating-points are also subject to <strong>underflow</strong>, which occurs when the non-zero fraction is too small to be represented. This means that the <em>negative</em> exponent is too large to fit in the exponent field.</li>
<li data-line="64" dir="auto"><span class="list-bullet"></span>One way to reduce the chances of under/overflow is to increase the size of the exponent. A <strong>double-precision</strong> floating-point is a 64-bit doubleword, as opposed to the 32-bit single-precision floating-point discussed earlier. <span alt="riscvDoublePrecision 1.png" src="resources/riscvdoubleprecision-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscvDoublePrecision 1.png" src="resources/riscvdoubleprecision-1.png" target="_self"></span></li>
<li data-line="65" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Some computers signal an <a data-href="Exception" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Exception</a>, or interrupt, when an over/underflow is detected. An exception is a unscheduled event that disrupt the execution of a program. The address of the instruction that caused the exception is saved in a register, and the computer jumps to a predefined address to invoke the proper routine for that exception type.
<ul class="has-list-bullet">
<li data-line="66" dir="auto"><span class="list-bullet"></span>RISC-V computers do not raise exceptions for overflow or underflow and instead software can read the <strong>floating-point control and status register (fcsr)</strong> to check whether  an over/underflow has occurred.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="68" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <a data-href="IEEE 754" href=".html" class="internal-link" target="_self" rel="noopener nofollow">IEEE 754</a> floating-point standard is a widely standard for floating-point representations.</p>
<ul class="has-list-bullet">
<li data-line="69" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>IEEE 754 makes the leading 1 bit of normalized binary numbers implicit. We use the term <strong>significand</strong> when referring the the number that is 1 plus the fraction. Since 0 has no leading 1, it is given the reserved exponent 0 so the hardware attach a 1 to it. Thus, <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math></mjx-container></span> represents 0, and the rest of the numbers use the following form:
<ul class="has-list-bullet">
<li data-line="70" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span></li>
</ul>
</li>
<li data-line="71" dir="auto"><span class="list-bullet"></span>IEEE 754 reserves the largest exponent to represent <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-n"><mjx-c class="mjx-c221E"></mjx-c></mjx-mi></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c221E"></mjx-c></mjx-mi></mjx-math></mjx-container></span>.</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span>IEEE 754 also has a symbol for invalid operations such as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></span>. This symbol is <code>NaN</code> (<em>Not a Number</em>).<span alt="ieee754.png" src="resources/ieee754.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="ieee754.png" src="resources/ieee754.png" target="_self"></span></li>
<li data-line="73" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Biased notation</strong> represents the most positive exponent as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math></mjx-container></span> and the most negative exponent as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math></mjx-container></span>. The <em>bias</em> is the number that is subtracted from the normal, unsigned representation to determine the value.
<ul class="has-list-bullet">
<li data-line="74" dir="auto"><span class="list-bullet"></span>IEEE 754 uses a bias of 127 for single precision, so an exponent of <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math></mjx-container></span> is represented as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math></mjx-container></span>.</li>
<li data-line="75" dir="auto"><span class="list-bullet"></span>The exponent bias for double precision is 1023.</li>
<li data-line="76" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Biased notation means that the representation for floating-points is really:
<ul class="has-list-bullet">
<li data-line="77" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.413em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="78" dir="auto"><span class="list-bullet"></span>IEEE 754 also added a 16-bit format for <strong>half-precision</strong> and a 128-bit format for <strong>quadruple-precision</strong>.</li>
</ul>
</li>
<li data-line="80" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>To perform <strong>floating-point addition</strong>, we use the following algorithm:</p>
<ul class="has-list-bullet">
<li data-line="81" dir="auto"><span class="list-bullet"></span>Shift the significand of the number with the smaller exponent to the right until both numbers have the same exponent.</li>
<li data-line="82" dir="auto"><span class="list-bullet"></span>Add the significands, then, normalize the result.</li>
<li data-line="83" dir="auto"><span class="list-bullet"></span>If the resulting exponent is too large (<em>overflow</em>) or too small (<em>underflow</em>) to fit in the designated field, handle these cases accordingly.</li>
<li data-line="84" dir="auto"><span class="list-bullet"></span>Round the significand if necessary to fit in its field. It may be necessary to re-normalize after rounding.<span alt="floatingPointAdditionHardware 1.png" src="resources/floatingpointadditionhardware-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="floatingPointAdditionHardware 1.png" src="resources/floatingpointadditionhardware-1.png" target="_self"></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="86" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>To perform <strong>floating-point multiplication</strong>, we use the following algorithm:</p>
<ul class="has-list-bullet">
<li data-line="87" dir="auto"><span class="list-bullet"></span>The exponent of the product is simply the sum of the exponents of the operands. <em>When adding biased exponents, you must remember to subtract the bias from the sum in order to not include the bias twice.</em></li>
<li data-line="88" dir="auto"><span class="list-bullet"></span>Multiply the significands of each operand. The position of the binary/decimal point in the product is determined by the total number of digits to the right of the point in each operand.</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span>Normalize the resulting product.</li>
<li data-line="90" dir="auto"><span class="list-bullet"></span>If the resulting exponent is too large (<em>overflow</em>) or too small (<em>underflow</em>) to fit in the designated field, handle these cases accordingly.</li>
<li data-line="91" dir="auto"><span class="list-bullet"></span>Round the significand if necessary to fit in its field. It may be necessary to re-normalize after rounding.</li>
<li data-line="92" dir="auto"><span class="list-bullet"></span>The sign of the product is the result of an XOR of each operands sign: if the signs are the same, the result is positive, otherwise, the result is negative.</li>
</ul>
</li>
<li data-line="94" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V supports the IEEE 754 single and double-precision formats with the following instructions:</p>
<ul class="has-list-bullet">
<li data-line="95" dir="auto"><span class="list-bullet"></span><code>fadd.s</code> and <code>fadd.d</code>: floating-point addition single and double precision respectively.</li>
<li data-line="96" dir="auto"><span class="list-bullet"></span><code>fsub.s</code> and <code>fsub.d</code>: floating-point subtraction single and double precision respectively.</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span><code>fmul.s</code> and <code>fmul.d</code>: floating-point multiplication single and double precision respectively.</li>
<li data-line="98" dir="auto"><span class="list-bullet"></span><code>fdiv.s</code> and <code>fdiv.d</code>: floating-point division single and double precision respectively.</li>
<li data-line="99" dir="auto"><span class="list-bullet"></span><code>fsqrt.s</code> and <code>fsqrt.d</code>: floating-point square root single and double precision respectively.</li>
<li data-line="100" dir="auto"><span class="list-bullet"></span><code>feq.s</code> and <code>feq.d</code>: floating-point equals single and double precision respectively.</li>
<li data-line="101" dir="auto"><span class="list-bullet"></span><code>flt.s</code> and <code>flt.d</code>: floating-point less-than single and double precision respectively.</li>
<li data-line="102" dir="auto"><span class="list-bullet"></span><code>fle.s</code> and <code>fle.d</code>: floating-point less-than-or-equals single and double precision respectively.</li>
<li data-line="103" dir="auto"><span class="list-bullet"></span>The comparison instructions set an integer register to 0 if the comparison is false and 1 if it is true.</li>
</ul>
</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>RISC-V includes 32 separate floating-point registers labelled <code>f0</code>-<code>f31</code>. Hence, they include separate loads and stores for floating-point registers:</p>
<ul class="has-list-bullet">
<li data-line="106" dir="auto"><span class="list-bullet"></span><code>fld</code> and <code>fsd</code> for double-precision.</li>
<li data-line="107" dir="auto"><span class="list-bullet"></span><code>flw</code> and <code>fsw</code> for single-precision.</li>
<li data-line="108" dir="auto"><span class="list-bullet"></span>The base registers for floating-point data transfers remain integer registers.</li>
<li data-line="109" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unlike the integer register, the floating-point register <code>f0</code> is <strong>not</strong> hardwired to 0.
<ul class="has-list-bullet">
<li data-line="110" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The floating-point instructions use the same format as their integer counterparts:
<ul class="has-list-bullet">
<li data-line="111" dir="auto"><span class="list-bullet"></span>Loads use the I-type format.</li>
<li data-line="112" dir="auto"><span class="list-bullet"></span>Stores use the S-type format.</li>
<li data-line="113" dir="auto"><span class="list-bullet"></span>Arithmetic instructions use the R-type format.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="115" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Since floating point numbers are mere approximations of real numbers, the IEEE 754 standard offers several modes of rounding the programmer can choose from:</p>
<ul class="has-list-bullet">
<li data-line="116" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>IEEE 754 keeps two extra bits on the right during floating-point calculations, called the <strong>guard</strong> and <strong>round</strong> bits.
<ul class="has-list-bullet">
<li data-line="117" dir="auto"><span class="list-bullet"></span>The guard bit is placed immediately to the right of the least significant bit of the mantissa, followed by the round bit. These two bits store the next bit that would be lost due to truncation, and uses them to determine how to round the result.</li>
<li data-line="118" dir="auto"><span class="list-bullet"></span>The IEEE 754 standard also keeps track of a <strong>sticky bit</strong> that is set to 1 whenever there is non-zero bits to the right of the round bit, and is otherwise 0.</li>
</ul>
</li>
<li data-line="119" dir="auto"><span class="list-bullet"></span>Accuracy in floating-point representations is measures in terms of the number of bits in error in the least significant bits of the significand. This measure is called the number of <strong>units in the last place (ulp)</strong>. IEEE 754 guarantees that the computer uses numbers within one-half ulp.</li>
<li data-line="120" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>IEEE 754 provides four rounding modes:
<ol>
<li data-line="121" dir="auto">Always round up.</li>
<li data-line="122" dir="auto">Always round down.</li>
<li data-line="123" dir="auto">Truncate.</li>
<li data-line="124" dir="auto">Round to nearest even.</li>
</ol>
</li>
</ul>
</li>
<li data-line="126" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Many graphics systems originally used 8 bits to represent each of the three primary colors plus 8 bits for the location of a pixel. The addition of speakers and microphones required support for sound as well. 16 bits of precision were sufficient for audio samples.</p>
<ul class="has-list-bullet">
<li data-line="127" dir="auto"><span class="list-bullet"></span>All microprocessors have special support so that bytes and halfwords take up less space and memory. This support was typically limited to data transfer operations.</li>
<li data-line="128" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Many graphics and audio applications would perform the same operations on vectors of data. By partitioning the carry chains within a 128-bit adder, a processor can use parallelism to perform simultaneous operations on vectors of sixteen 8-bit operands, eight 6-bit operands, four 32-bit operands, or two 64-bit operands.
<ul class="has-list-bullet">
<li data-line="129" dir="auto"><span class="list-bullet"></span>Since this parallelism occurs within a wide word, it is called <a data-href="Subword Parallelism" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Subword Parallelism</a>. It is also known as vector or SIMD, for <em>single instruction, multiple data</em> parallelism.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Ch.4 The Processor" dir="auto" class="heading" id="Ch.4_The_Processor_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.4 The Processor</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The performance of a computer is determined by three factors:</p>
<ol>
<li data-line="1" dir="auto">Instruction count.</li>
<li data-line="2" dir="auto">Clock cycle time.</li>
<li data-line="3" dir="auto">Clock cycles per instruction (CPI).</li>
</ol>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The first two steps of every instruction are:</p>
<ol>
<li data-line="6" dir="auto">Send the program counter (PC) to the memory that contains the code and fetch the instruction from memory.</li>
<li data-line="7" dir="auto">Read one or two registers using the fields of the instruction and its instruction format.</li>
</ol>
</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>All instruction classes use the <a data-href="Arithmetic Logic Unit" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Arithmetic Logic Unit</a> (ALU) after reading registers.</p>
<ul class="has-list-bullet">
<li data-line="10" dir="auto"><span class="list-bullet"></span>Memory-reference instructions use the ALU to calculate a memory address.</li>
<li data-line="11" dir="auto"><span class="list-bullet"></span>Arithmetic-logical instructions use the ALU for operation execution.</li>
<li data-line="12" dir="auto"><span class="list-bullet"></span>Conditional branches use the ALU for equality tests.</li>
</ul>
</li>
<li data-line="14" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>After using the ALU, the following actions required to complete various instruction classes differ:</p>
<ul class="has-list-bullet">
<li data-line="15" dir="auto"><span class="list-bullet"></span>Memory-reference instructions need to access memory to either read or write data.</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>Arithmetic-logical instructions must write the output of the ALU back into a register.</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>Conditional branch instructions may need to change the next instruction address.</li>
</ul>
</li>
<li data-line="19" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Multiplexer" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Multiplexer</a> (MUX)</strong>: A digital switch that selects one of several input signals based on <em>control</em> signals.</p>
<ul class="has-list-bullet">
<li data-line="20" dir="auto"><span class="list-bullet"></span>Control lines must also be set based on fields of the instruction to direct the operations of each component (e.g. ALU, Memory, etc.).</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span>A <strong>control unit</strong> takes the instruction as input, and outputs the value of the control lines for the functional units and multiplexers.<span alt="risc-vDatapath.png" src="resources/risc-vdatapath.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="risc-vDatapath.png" src="resources/risc-vdatapath.png" target="_self"></span></li>
</ul>
</li>
<li data-line="23" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The datapath elements in the RISC-V implementation consist of two different types of logical elements:</p>
<ol>
<li data-line="24" dir="auto"><strong>Combinational Elements</strong>: Elements whose outputs are determined entirely by its inputs. For example, AND and OR gates are combinational elements.</li>
<li data-line="25" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>State Elements</strong>: Elements that contain internal state, also called <em>memory</em> elements. For example, main memory and registers are state elements.
<ul class="has-list-bullet">
<li data-line="26" dir="auto"><span class="list-bullet"></span>State elements have at least two inputs and one output. The inputs are the data value to be written into the element, and the clock signal, which determines when the value is written. The output of the state element is a value that was written in an earlier clock cycle. State elements can be read at any time.</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>State elements are also called <strong>sequential elements</strong>.</li>
</ul>
</li>
</ol>
</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Clocking Methodology" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Clocking Methodology</a></strong>: The approach used to determine when data are valid and stable relative to the clock.</p>
<ul class="has-list-bullet">
<li data-line="30" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Edge-triggered clocking</strong> is a clocking methodology where values stored in sequential elements are updated only on a clock edge. A <strong>clock edge</strong> is the transition from high to low or vice versa. The <strong>rising edge</strong> is the transition from low to high, while the <strong>falling edge</strong> is the transition from high to low. We use the rising edge in this book.
<ul class="has-list-bullet">
<li data-line="31" dir="auto"><span class="list-bullet"></span><strong>Setup Time</strong>: The minimum time before the clock edge during which the input data must remain stable.</li>
<li data-line="32" dir="auto"><span class="list-bullet"></span><strong>Hold Time</strong>: The minimum time after the clock edge during which the input data must remain stable.</li>
</ul>
</li>
<li data-line="33" dir="auto"><span class="list-bullet"></span>The time necessary for signals to propagate through the datapath determines the minimum possible clock cycle time.</li>
</ul>
</li>
<li data-line="35" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The term <strong>asserted</strong> means that a signal is driven logically high, and the term <strong>deasserted</strong> means a signal is driven logically low.</p>
<ul class="has-list-bullet">
<li data-line="36" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>These terms are used because, at times, a 1 can represent either a logical high or a logical low depending on the hardware implementation.
<ul class="has-list-bullet">
<li data-line="37" dir="auto"><span class="list-bullet"></span>Elements which are asserted with a 1 are called <strong>active high</strong>, while elements which are asserted with a zero are called <strong>active low</strong>.</li>
</ul>
</li>
</ul>
</li>
<li data-line="39" dir="auto"><span class="list-bullet"></span>
<p>For the 32-bit RISC-V architecture, nearly all state and logic elements will have 32-bit wide inputs and outputs. This data is transferred using <strong>buses</strong>, which are a set of parallel wires that carry multiple bits of data simultaneously.</p>
</li>
<li data-line="41" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The datapath elements we need to execute each class of RISC-V instructions are:</p>
<ul class="has-list-bullet">
<li data-line="42" dir="auto"><span class="list-bullet"></span><strong>Memory Unit</strong>: Stores the instructions of a program and outputs instructions given an address. The memory unit has read and write control signals, an address input, and an input for the data to be written to memory. We will also need a hardware unit that can <strong>sign-extend</strong> the 12-bit signed offset in the instruction to a 32-bit signed value.</li>
<li data-line="43" dir="auto"><span class="list-bullet"></span><strong>Program Counter (PC)</strong>: A register which holds the address of the next instruction. The PC is incremented by 4, so that it points at the next instruction.</li>
<li data-line="44" dir="auto"><span class="list-bullet"></span><strong>ALU</strong>: The arithmetic logic unit which performs arithmetic and logical operations based on the setting of its control lines. The ALU takes two 32-bit inputs and produces a 32-bit result, as well as a 1-bit signal if the result is 0.</li>
<li data-line="45" dir="auto"><span class="list-bullet"></span><strong>Register File</strong>: A data structure containing the processor's 32 general-purpose registers. The register file always outputs the contents of whatever register numbers are on the <code>ReadRegister</code> inputs. Writes, however, are controlled by a write control signal, which must be asserted for a write to occur at the clock edge.</li>
</ul>
</li>
<li data-line="47" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <code>beq</code> instruction has three operands, two registers which are tested for equality, and a 12-bit offset used to compute the branch target address relative to the branch instruction address. This is an example of <a data-href="PC-Relative Addressing" href=".html" class="internal-link" target="_self" rel="noopener nofollow">PC-Relative Addressing</a>.</p>
<ul class="has-list-bullet">
<li data-line="48" dir="auto"><span class="list-bullet"></span>When the condition is true, the branch target address is the new PC, and we say that the branch is <em>taken</em>. When the condition is false, the PC is incremented by 4, and we say that the branch is not taken.</li>
<li data-line="49" dir="auto"><span class="list-bullet"></span>The branch datapath requires an <strong>immediate generation unit</strong> and an <a data-href="Adder" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Adder</a>. The immediate generation unit (<code>ImmGen</code>) takes an instruction as input, and selects the 12-bit immediate field and outputs a 32-bit sign-extended result.</li>
</ul>
</li>
<li data-line="51" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The simple datapath which implements the capabilities described thus far shown in the figure below:<span alt="riscvDatapath2 1.png" src="resources/riscvdatapath2-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscvDatapath2 1.png" src="resources/riscvdatapath2-1.png" target="_self"></span></p>
<ul class="has-list-bullet">
<li data-line="52" dir="auto"><span class="list-bullet"></span>This figure omits the <strong>control unit</strong>, which takes an instruction as input, and sets the control lines for each multiplexer and functional unit.</li>
</ul>
</li>
<li data-line="54" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The RISC-V ALU defines the four following combinations of control inputs:</p>
<ul class="has-list-bullet">
<li data-line="55" dir="auto"><span class="list-bullet"></span><code>0000</code>: Logical AND, used for <code>AND</code> instructions.</li>
<li data-line="56" dir="auto"><span class="list-bullet"></span><code>0001</code>: Logical OR, used for <code>OR</code> instructions.</li>
<li data-line="57" dir="auto"><span class="list-bullet"></span><code>0010</code>: Addition. Used for <code>add</code> instructions, as well as data transfer instructions to calculate the memory address. </li>
<li data-line="58" dir="auto"><span class="list-bullet"></span><code>0110</code>: Subtraction, used for <code>sub</code> and conditional branch instructions.</li>
</ul>
</li>
<li data-line="60" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>We can generate the 4-bit ALU control signal with a small control unit that takes as input the <code>funct7</code> and <code>funct3</code> fields of the instruction, and a 2-bit control field called <code>ALUOp</code>.</p>
<ul class="has-list-bullet">
<li data-line="61" dir="auto"><span class="list-bullet"></span>The <code>ALUOp</code> field indicates whether the operation to be performed should be add (00) for loads and stores, subtract and test if zero (01) for conditional branches, or be determined by the <code>funct7</code> and <code>funct3</code> fields (10).</li>
<li data-line="62" dir="auto"><span class="list-bullet"></span>The output of the ALU control unit is a 4-bit control signal which determines the function of the ALU.</li>
<li data-line="63" dir="auto"><span class="list-bullet"></span>This control unit uses <strong>multiple levels of decoding</strong>: the main control unit generates the <code>ALUOp</code> bits, which are then used to as input to the ALU control that generates the actual control signals. Multiple levels of decoding can reduce the size and latency of the main control unit.</li>
</ul>
</li>
<li data-line="65" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Truth Table" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Truth Table</a></strong>: A table which determines the truth values of logical expressions based on their inputs.</p>
<ul class="has-list-bullet">
<li data-line="66" dir="auto"><span class="list-bullet"></span><a data-href="Don't Care" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Don't Care</a> terms are terms whose truth value has no affect on the output. Don't cares are typically represented symbolically as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> or <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo></mjx-math></mjx-container></span>.</li>
<li data-line="67" dir="auto"><span class="list-bullet"></span>The following figure is the truth table for the ALU control unit:<span alt="aluTruthTable.png" src="resources/alutruthtable.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="aluTruthTable.png" src="resources/alutruthtable.png" target="_self"></span></li>
</ul>
</li>
<li data-line="69" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Some major observations about RISC-V instruction formats are:</p>
<ul class="has-list-bullet">
<li data-line="70" dir="auto"><span class="list-bullet"></span>The <strong>opcode</strong> field is always in bits 6:0. Depending on the opcode, the funct3 field (bits 14:12) and the funct7 field (bits 31:25) serve as an extended opcode.</li>
<li data-line="71" dir="auto"><span class="list-bullet"></span>The first register operand is always in bits 19:15 for R-type and branch instructions. This field also specifies the base address for data-transfer instructions.</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span>The second register operand is always in bits 24:20 for R-type and branch instructions. This field also specifies the register operand that gets copied to memory for store instructions.</li>
<li data-line="73" dir="auto"><span class="list-bullet"></span>The destination register is always in bits 11:7 for R-type and load instructions.<span alt="riscVinstructionFormats.png" src="resources/riscvinstructionformats.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscVinstructionFormats.png" src="resources/riscvinstructionformats.png" target="_self"></span></li>
</ul>
</li>
<li data-line="75" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The following figure shows the RISC-V datapath with the control unit, which takes the opcode as input, and outputs the value of each control signal:<span alt="riscVControlUnit 1.png" src="resources/riscvcontrolunit-1.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscVControlUnit 1.png" src="resources/riscvcontrolunit-1.png" target="_self"></span></p>
<ul class="has-list-bullet">
<li data-line="76" dir="auto"><span class="list-bullet"></span><code>ALUOp</code> is bold to indicate that it is a 2-bit bus line.</li>
</ul>
</li>
<li data-line="78" dir="auto"><span class="list-bullet"></span>
<p>The following figure shows the <strong>truth table</strong> for the control unit for each instruction format:<span alt="riscVInstructionFormatControl.png" src="resources/riscvinstructionformatcontrol.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscVInstructionFormatControl.png" src="resources/riscvinstructionformatcontrol.png" target="_self"></span></p>
</li>
<li data-line="80" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The design we have discussed so far is a <em>single-cycle design</em>. This type of datapath performs the entire instruction in one clock cycle, requiring the clock cycle to be long enough to accommodate the longest instruction. This means the clock speed is limited by the longest possible path through the datapath. This results in a clock speed that is far too slow for modern processing.</p>
<ul class="has-list-bullet">
<li data-line="81" dir="auto"><span class="list-bullet"></span>The alternative to a single-cycle design is a <strong>multicycle design</strong>, where each instruction is broken into a series of steps. These steps correspond to functional unit operations. Each step takes 1 clock cycle to execute, allowing a functional unit to be used multiple times per instruction, as long as it is used in distinct clock cycles. This also allows instructions to take different amount of clock cycles to execute. Though, pipelined datapaths are used on almost all modern chips over multicycle implementations.</li>
</ul>
</li>
<li data-line="83" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><a data-href="Pipelining" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Pipelining</a> is an implementation technique where the execution of multiple instructions are overlapped. This technique is similar to an assembly line, where different stages of execution occur simultaneously. By allowing multiple instructions to be in different stages of execution at the same time, pipelining significantly enhances the overall performance and <strong>throughput</strong> of the CPU.</p>
<ul class="has-list-bullet">
<li data-line="84" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>A pipelined datapath is divided into <em>stages</em> that operate concurrently. RISC-V instructions include five stages:</p>
<ul class="has-list-bullet">
<li data-line="85" dir="auto"><span class="list-bullet"></span><strong>Instruction Fetch (IF)</strong>: The CPU fetches the next instruction from memory based on the PC.</li>
<li data-line="86" dir="auto"><span class="list-bullet"></span><strong>Instruction Decode (ID)</strong>: The fetched instruction is decoded, determining the setting of control lines, and the operands required. This involves fetching the necessary registers from the register file.</li>
<li data-line="87" dir="auto"><span class="list-bullet"></span><strong>Execution (EX)</strong>: The actual operation specified by the instruction is performed.</li>
<li data-line="88" dir="auto"><span class="list-bullet"></span><strong>Memory Access (MEM)</strong>: Handles read and write accesses if required by the instruction.</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span><strong>Write Back (WB)</strong>: Writes the result of the instruction into the appropriate register in the register file.</li>
</ul>
</li>
<li data-line="90" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Note that the speed-up acquired by pipelining only applies when multiple instructions need to be executed. The time it takes to execute one instruction is the same as it would be in a single-cycle implementation. This is because pipelining improves throughput, that is, the amount of <em>work</em> that a CPU can perform in a given time frame.</p>
<ul class="has-list-bullet">
<li data-line="91" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The speed-up gained from a pipelined implementation the amount of time each stage takes, as well as the amount of work that needs to be done. Let <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> be the number of pipeline stages:
<ul class="has-list-bullet">
<li data-line="92" dir="auto"><span class="list-bullet"></span>The pipeline achieves an ideal speed-up of <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> if each stage is of equal length. If the stages are of unequal length, the overall pipeline speed is determined by the longest stage.</li>
<li data-line="93" dir="auto"><span class="list-bullet"></span>When a CPU starts executing, the pipeline is empty, and it isn't full until at least <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> instructions have started executing. This is called the <em>start-up time</em>.</li>
<li data-line="94" dir="auto"><span class="list-bullet"></span>Conversely, <em>wind-down time</em> occurs when the pipeline is no longer receiving new instructions. This period is required to complete the execution of any remaining instructions in the pipeline before the CPU can safely shut down.</li>
<li data-line="95" dir="auto"><span class="list-bullet"></span>Pipelining also incurs some overhead, including <strong>stalls, structural hazards, data hazards, control hazards, and data duplication</strong>, which will be discussed later.</li>
</ul>
</li>
</ul>
</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The RISC-V instruction set architecture was designed for pipelined execution.</p>
<ul class="has-list-bullet">
<li data-line="98" dir="auto"><span class="list-bullet"></span>This was done by making all instructions the same length, that is, 4 bytes. This makes the instruction fetch (IF) and instruction decode (ID) stages simpler to implement in hardware.</li>
<li data-line="99" dir="auto"><span class="list-bullet"></span>RISC-V also has only a few instruction formats, with the source and destination registers being located in the same bit positions in each format.</li>
</ul>
</li>
<li data-line="101" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Hazards</strong> are situations in a pipelined datapath which prevent the next instruction from being executed in the following clock cycle. There are three different types of hazards:</p>
<ul class="has-list-bullet">
<li data-line="102" dir="auto"><span class="list-bullet"></span><strong>Structural Hazards</strong>: Occur when the hardware resources available are insufficient to support the combination of instructions that are set to execute.</li>
<li data-line="103" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Data Hazards</strong>: Occur when instructions which are close together have data dependencies. This requires the pipelined to be stalled to wait for the data to become available.
<ul class="has-list-bullet">
<li data-line="104" dir="auto"><span class="list-bullet"></span>These stalls can be minimized or potentially eliminated if, instead of waiting for the previous instruction to write the data back to the register file, additional hardware can be added to <strong>forward</strong> or <strong>bypass</strong> the data to a further stage in the pipeline. This is only valid if the destination stage is later in time than the source stage.</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span>A <strong>load-use data hazard</strong> is a type of data hazard where data being loaded by a <code>load</code> instruction has not yet become available when another instruction needs it. These hazards can be mitigated by using either hardware detection and stalls, or by reordering the code allow time for the data to be loaded in time.</li>
</ul>
</li>
<li data-line="106" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Control Hazards</strong>: Also called <strong>branch hazards</strong>, occur when the proper instruction cannot execute in the proper pipeline cycle because the instruction fetched was not the instruction required. This occurs when a branch instruction changes the control flow of the program, causing the instructions in the pipeline to be invalid. Two solutions to deal with control hazards include:
<ul class="has-list-bullet">
<li data-line="107" dir="auto"><span class="list-bullet"></span><strong>Stalling</strong>: This solution simply stalls until the result of the condition is computed to start fetching instructions again. Though, the slowdown resulting from this solution is far too high for modern computers.</li>
<li data-line="108" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Predicting</strong>: This solution involves predicting the outcome of the condition and fetching instructions based off that prediction. This option results in no slowdown if the prediction is correct, though, if the prediction is incorrect, the pipeline will have to be restarted, so instruction execution can start from the correct address. This technique is called <a data-href="Branch Prediction" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Branch Prediction</a>.
<ul class="has-list-bullet">
<li data-line="109" dir="auto"><span class="list-bullet"></span>Dynamic branch prediction make their guesses depending on the behavior of each conditional branch, rather than some predetermined formula or pattern. A popular approach to dynamic branch prediction involves keeping a history of recent branch results, and using the recent past behavior to predict the future. This can result in prediction accuracies of more than 90%.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="110" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The following figure denotes the previous single-cycle datapath divided into the corresponding five pipeline stages:<span alt="riscpipeline.png" src="resources/riscpipeline.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscpipeline.png" src="resources/riscpipeline.png" target="_self"></span></p>
<ul class="has-list-bullet">
<li data-line="111" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In this figure, data moves from left-to-right, with two exceptions:
<ul class="has-list-bullet">
<li data-line="112" dir="auto"><span class="list-bullet"></span>The write-back stage, which writes a result back into the register file. This can lead to data hazards.</li>
<li data-line="113" dir="auto"><span class="list-bullet"></span>The selection of the PC source. This can lead to control hazards.</li>
</ul>
</li>
<li data-line="114" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In this datapath, the instruction memory is used during only one stage of the pipeline, allowing it to be shared by the following instructions. Though, to retain the value of an individual instruction for the following stages, the value read from the instruction memory must be saved to a register. Therefore, we must place registers where each dividing line is present in the figure. These registers, called <strong>pipeline registers</strong>, are present in the following datapath figure:<span alt="riscvpipeline2.png" src="resources/riscvpipeline2.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscvpipeline2.png" src="resources/riscvpipeline2.png" target="_self"></span>
<ul class="has-list-bullet">
<li data-line="115" dir="auto"><span class="list-bullet"></span><em>The highlighted lines denote the datapath for the destination register of a load instruction.</em></li>
<li data-line="116" dir="auto"><span class="list-bullet"></span>These pipeline registers are used to store and pass any information needed by a later stage.</li>
</ul>
</li>
</ul>
</li>
<li data-line="118" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>We will now focus on creating the control for the pipelined datapath. We will borrow the ALU control logic, branch logic, and control lines from the single-cycle implementation.</p>
<ul class="has-list-bullet">
<li data-line="119" dir="auto"><span class="list-bullet"></span>We assume that the PC and all pipeline registers are written on each clock cycle, therefore, they require no explicit write signals.</li>
<li data-line="120" dir="auto"><span class="list-bullet"></span>To specify control for the pipeline, we need only set the control values during each pipeline stage. Therefore, we can divide the control lines into five groups:</li>
<li data-line="121" dir="auto"><span class="list-bullet"></span><strong>Instruction Fetch (IF)</strong>: Since the control signals to read instruction memory and write the PC are always asserted, there is no control to set in this stage.</li>
<li data-line="122" dir="auto"><span class="list-bullet"></span><strong>Instruction Decode (ID)</strong>: The two source registers are always in the same location in all RISC-V instruction formats, therefore, there is no control to set in this stage.</li>
<li data-line="123" dir="auto"><span class="list-bullet"></span><strong>Execution (EX)</strong>: The signals to be set are <code>ALUOp</code> and <code>ALUSrc</code>. These signals select the ALU operation, and select the source of the second operand as either the second register argument or a sign-extended immediate.</li>
<li data-line="124" dir="auto"><span class="list-bullet"></span><strong>Memory Access (MEM)</strong>: The signals to be set are <code>Branch</code>, <code>MemRead</code>, and <code>MemWrite</code>. The branch if equal, load, and store instructions set these signals, respectively. Recall that <code>PCSrc</code> selects the next sequential address unless control asserts <code>Branch</code> and the ALU result was 0.</li>
<li data-line="125" dir="auto"><span class="list-bullet"></span><strong>Write Back (WB)</strong>: The two signals to be set are <code>MemToReg</code>, which decides between sending the ALU result or the memory value to the register file, and <code>RegWrite</code>, which writes the chosen value to the register file.</li>
</ul>
</li>
<li data-line="126" dir="auto"><span class="list-bullet"></span>
<p>Since the rest of the control lies start with the EX stage, we can create the control information at the instruction decode stage, and pass the control signals via the pipeline registers. This is denoted with the following figure:<span alt="risvpipelinecontrol.png" src="resources/risvpipelinecontrol.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="risvpipelinecontrol.png" src="resources/risvpipelinecontrol.png" target="_self"></span></p>
</li>
</ul>
</li>
<li data-line="128" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Data hazards</strong> occur when instructions which are close together have data dependencies.</p>
<ul class="has-list-bullet">
<li data-line="129" dir="auto"><span class="list-bullet"></span>
<p>If a register is read and written in the same clock cycle, we assume that the write occurs in the first half of the clock cycle, and the read in the latter half. This way, the read delivers what is written, and thus, we have no data hazard.</p>
</li>
<li data-line="130" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>If an instruction in the pipeline needs a result of a instruction that is backward in the pipeline, the datapath can <strong>forward</strong> the data to the instruction as soon as the result is available.</p>
<ul class="has-list-bullet">
<li data-line="131" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Here, we only consider the challenge of forwarding to an operation in the EX (<em>execution</em>) stage. When an instruction tries to use a register in its EX stage that an earlier instruction in the pipeline intends to write to in its WB stage, we need to forward the value to be written.
<ul class="has-list-bullet">
<li data-line="132" dir="auto"><span class="list-bullet"></span>Because some instructions do not write registers, we need to check that the <code>RegWrite</code> signal is asserted before we forward. Additionally, if the register being written to is register <code>x0</code>, we should avoid forwarding the potentially non-zero value.</li>
</ul>
</li>
<li data-line="133" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We can provide hardware support for forwarding by adding multiplexers to each input of the ALU, and with the proper control signals, we can forward a value from a pipeline register into the ALU input. This is illustrated in the figure below:<span alt="forwardingALU.png" src="resources/forwardingalu.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="forwardingALU.png" src="resources/forwardingalu.png" target="_self"></span>
<ul class="has-list-bullet">
<li data-line="134" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The forwarding unit takes the <code>Rd</code> fields of the <code>EX/MEM</code> and <code>MEM/WB</code> pipeline registers and forwards their value to the ALU if these conditions are met:
<ul class="has-list-bullet">
<li data-line="135" dir="auto"><span class="list-bullet"></span>The <code>RegWrite</code> control line is asserted in the corresponding pipeline register.</li>
<li data-line="136" dir="auto"><span class="list-bullet"></span>Register <code>Rd</code> is not <code>x0</code>.</li>
<li data-line="137" dir="auto"><span class="list-bullet"></span>Register <code>Rd</code> is the same register as register <code>Rs1</code> or register <code>Rs2</code> for the EX stage.</li>
</ul>
</li>
<li data-line="138" dir="auto"><span class="list-bullet"></span>One complication occurs if both the <code>EX/MEM</code> and <code>MEM/WB</code> meet all of these conditions. In this case, the <code>EX/MEM</code> value should be forwarded, since this is the most recent value.</li>
</ul>
</li>
</ul>
</li>
<li data-line="140" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Forwarding cannot be used for a read-after-write hazard, because the data is still being read from memory when the ALU needs the result. This requires the pipeline to be <strong>stalled</strong>.</p>
<ul class="has-list-bullet">
<li data-line="141" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Hence, we need a new functional unit, called the <strong>hazard detection unit</strong>. The hazard detection unit operates during the ID stage so that it can insert a stall between the load and the instruction dependent upon it. The hardware detection unit stalls if the following conditions are met:
<ul class="has-list-bullet">
<li data-line="142" dir="auto"><span class="list-bullet"></span>The <code>ID/EX</code> pipeline register asserts <code>MemRead</code>. The only instruction that asserts <code>MemRead</code> is a load instruction.</li>
<li data-line="143" dir="auto"><span class="list-bullet"></span>The <code>ID/EX.RegisterRd</code> register equals the <code>IF/ID.RegisterRs1</code> or <code>IF/ID.RegisterRs2</code> register.</li>
</ul>
</li>
<li data-line="144" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>If these conditions hold, the instruction stalls one clock cycle.
<ul class="has-list-bullet">
<li data-line="145" dir="auto"><span class="list-bullet"></span>To prevent the instructions in the ID stage and IF stage from progressing, you simply prevent the PC register and the IF/ID register from changing during a stall.</li>
<li data-line="146" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Though, the further stages of the pipeline, starting from the EX stage, still must be doing something. We make these stages perform <strong>NOPs</strong>, which are instructions that does no operation to change state.
<ul class="has-list-bullet">
<li data-line="147" dir="auto"><span class="list-bullet"></span>We can implement nops by simply deasserting all seven control signals in the EX, MEM, and WB stages.</li>
</ul>
</li>
</ul>
</li>
<li data-line="148" dir="auto"><span class="list-bullet"></span>The datapath with the hardware detection unit and forwarding unit is illustrated below:<span alt="hazarddetectionUnit.png" src="resources/hazarddetectionunit.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="hazarddetectionUnit.png" src="resources/hazarddetectionunit.png" target="_self"></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="150" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Control hazards</strong> occur when the proper instruction cannot execute in the proper pipeline cycle because the instruction fetched was not the instruction needed. This occurs when a branch instruction changes the control flow of the program, causing the instructions in the pipeline to be invalid. Control hazards generally occur less frequently than data hazards.</p>
<ul class="has-list-bullet">
<li data-line="151" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Dealing with control hazards by stalling the pipeline until the branch is complete is far too costly. Control hazards are almost always addressed with <strong>prediction</strong>. Some common prediction schemes include:
<ul class="has-list-bullet">
<li data-line="152" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Assume branch not taken</strong>: This prediction scheme always assumes that the branch will not be taken, and therefore, continues execution down the sequential instruction stream. If the prediction is wrong, the pipeline must be <strong>flushed</strong>, and execution continues down the branch target.
<ul class="has-list-bullet">
<li data-line="153" dir="auto"><span class="list-bullet"></span>To discard instructions in the pipeline, we simply change the original control values to zero for the IF, ID, and EX pipeline stages. This forces a NOP instruction in each stage. To flush the IF stage, we add a control line called <code>IF.Flush</code>, which clears the contents of the <code>IF/ID</code> pipeline register when asserted.</li>
<li data-line="154" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We can reduce the cost of a misprediction by moving the conditional branch execution to an earlier stage in the pipeline. This requires us to move the computation of the branch target address and the outcome of the branch decision.
<ul class="has-list-bullet">
<li data-line="155" dir="auto"><span class="list-bullet"></span>We can move the address calculation from the EX stage to the ID stage, since the PC value and immediate field are both available. We just need to provide another adder in the ID stage to perform the computation.</li>
<li data-line="156" dir="auto"><span class="list-bullet"></span>Moving the branch decision computation is considerably more difficult. Equality can be evaluated by simply XORing the two registers read during the ID stage. Though, if a branch is dependent on a result that is still in the pipeline, additional forwarding and hazard detection hardware will be required. </li>
</ul>
</li>
</ul>
</li>
<li data-line="157" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong><a data-href="Dynamic Branch Prediction" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Dynamic Branch Prediction</a></strong>: This prediction scheme utilizes runtime information to make more accurate predictions about branch outcomes. One approach is to look up the address of the instruction to see if the branch was taken the last time the instruction was executed.
<ul class="has-list-bullet">
<li data-line="158" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>This approach can be implemented with a <strong>branch prediction buffer</strong>, or <strong>branch history table</strong>. A branch prediction buffer is a small memory indexed by the lower portion of the address of the branch instruction. The memory contains a bit signifying whether the branch was last taken or not. If the prediction is incorrect, the bit is inverted and stored again. This is called a 1-bit prediction scheme.
<ul class="has-list-bullet">
<li data-line="159" dir="auto"><span class="list-bullet"></span>This scheme can be improved by using more bits. A 2-bit scheme only inverts the bit when a prediction is wrong twice.</li>
</ul>
</li>
<li data-line="160" dir="auto"><span class="list-bullet"></span>The 2-bit dynamic prediction scheme only uses information about a particular branch to make its prediction.<strong><a data-tooltip-position="top" aria-label="Correlating Predictor" data-href="Correlating Predictor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Correlating Predictors</a></strong>, on the other hand, make use of both local and global behavior of recently executed branches for its predictions. A typical correlating predictor might have two 2-bit predictors for each branch, with the choice between predictors being conditioned on whether the last executed branch was taken or not.</li>
<li data-line="161" dir="auto"><span class="list-bullet"></span><strong><a data-tooltip-position="top" aria-label="Tournament Branch Predictor" data-href="Tournament Branch Predictor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Tournament Branch Predictors</a></strong> use multiple predictors, tracking, for each branch, which predictor is the most accurate.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="163" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Exceptions</strong> and <strong>interrupts</strong> are events, other than branches, which change the sequential flow of instruction execution. They were initially created to handle unexpected events from within the processor.</p>
<ul class="has-list-bullet">
<li data-line="164" dir="auto"><span class="list-bullet"></span>We use the term <em>exception</em> to refer to any unexpected change in control flow, while the term <em>interrupt</em> will be used only when the event is externally caused. Many architectures do not distinguish between exceptions and interrupts.</li>
<li data-line="165" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Detecting and handling exceptions is often on the critical timing path of the processor, which determines the minimum possible clock cycle time.
<ul class="has-list-bullet">
<li data-line="166" dir="auto"><span class="list-bullet"></span>The basic action that the processor must perform when handling an exception is to save the address of the current instruction in the <strong>supervisor exception cause register (SEPC)</strong> and then transfer control to the operating system at some specified address. The operating system can then take some action, which may involve proving some service to the user application, or stopping the execution of the program and reporting an error. If the OS decides to continue execution of the program, it uses the SEPC to determine where to restart execution.</li>
<li data-line="167" dir="auto"><span class="list-bullet"></span>For the OS to handle an exception, it must know the reason for the exception, as well as the instruction that caused it. The method RISC-V uses is to include a register, called the <strong>Supervisor Exception Cause Register (SCAUSE)</strong>, which includes a field that indicates the reason for the exception.</li>
<li data-line="168" dir="auto"><span class="list-bullet"></span>Another method is to use <strong>vectored interrupts</strong>, where the address to which control is transferred to is determined by the cause of the exception, possible added to a base register. Therefore, the OS knows the reason for the exception based off the address at which it is initiated. When the exception is not vectored, a single entry-point for all exceptions can be used, and the OS decodes the status register to determine the cause.</li>
</ul>
</li>
<li data-line="169" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To add hardware support for exceptions to our RISC-V implementation, we need additional registers and control signals.
<ul class="has-list-bullet">
<li data-line="170" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We need two additional registers:
<ul class="has-list-bullet">
<li data-line="171" dir="auto"><span class="list-bullet"></span><strong>SEPC</strong>: A 64-bit register used to hold the address of the affected instruction.</li>
<li data-line="172" dir="auto"><span class="list-bullet"></span><strong>SCAUSE</strong>: A 64-bit register used to record the cause of the exception.</li>
</ul>
</li>
<li data-line="173" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A pipelined implementation treats exceptions as another form of control hazard. If an exception is detected, we must flush the instructions that follow the faulting instruction, and begin fetching instructions from the new address.
<ul class="has-list-bullet">
<li data-line="174" dir="auto"><span class="list-bullet"></span>A new control signal, <code>ID.Flush</code> is OR-ed with the stall signal from the hazard detection unit to flush during ID. To flush the instruction in the EX stage, a new signal, <code>EX.Flush</code> causes new multiplexers to zero the control lines.</li>
<li data-line="175" dir="auto"><span class="list-bullet"></span>To branch to the exception address, we simply add an input to the PC multiplexer that branches to the fixed address.</li>
<li data-line="176" dir="auto"><span class="list-bullet"></span>The following figure illustrates the new datapath:<span alt="riscVExceptions.png" src="resources/riscvexceptions.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="riscVExceptions.png" src="resources/riscvexceptions.png" target="_self"></span></li>
<li data-line="177" dir="auto"><span class="list-bullet"></span>The final step is to save the address of the faulting instruction in the SEPC register.</li>
<li data-line="178" dir="auto"><span class="list-bullet"></span>When there are multiple instructions in the pipeline, it is necessary to associate an exception with the appropriate instruction. Moreover, multiple exceptions can occur in a single clock cycle. In RISC-V implementations, the hardware sorts exceptions so that the earliest instruction is interrupted.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="180" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Pipelining exploits potential parallelism among instructions, called <strong><a data-href="Instruction-Level Parallelism" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Instruction-Level Parallelism</a> (ILP)</strong>. There are two primary ways to increase the degree if ILP: the first is to increase the depth of the pipeline. Another approach, is to replicate the internal components of the computer so that it can handle multiple instructions per pipeline stage. This technique is called <a data-href="Multiple Issue" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Multiple Issue</a>.</p>
<ul class="has-list-bullet">
<li data-line="181" dir="auto"><span class="list-bullet"></span>Launching multiple instructions per stage allows the instruction execution rate to exceed to clock rate, resulting in a <strong>CPI</strong> (<em>clock cycle per instruction</em>) less than 1. It is sometimes more intuitive to flip the metric to <strong>IPC</strong> (<em>instructions per clock cycle</em>), which is the <a data-href="Reciprocal" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Reciprocal</a> of the CPI.</li>
<li data-line="182" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two main ways to implement a multiple-issue processor, with the main distinction being the division of work between the hardware and the compiler:
<ul class="has-list-bullet">
<li data-line="183" dir="auto"><span class="list-bullet"></span><strong>Static Multiple Issue</strong>: A multiple-issue implementation approach where many decisions are being made at compile time.</li>
<li data-line="184" dir="auto"><span class="list-bullet"></span><strong>Dynamic Multiple Issue</strong>: A multiple-issue implementation approach where many decisions are being made at runtime.</li>
</ul>
</li>
<li data-line="185" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Two primary responsibilities must be dealt with in a multiple-issue pipeline:
<ul class="has-list-bullet">
<li data-line="186" dir="auto"><span class="list-bullet"></span>Packing instructions into <strong>issue slots</strong>, which involves determining how many instructions and which instructions can be issued in a given clock cycle.</li>
<li data-line="187" dir="auto"><span class="list-bullet"></span>Dealing with data and control hazards.</li>
</ul>
</li>
<li data-line="188" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>One of the most important methods for finding and exploiting more ILP is speculation. That is, an approach where the compiler or processor guess the outcome of an instruction to remove it as a dependence in executing other instructions.
<ul class="has-list-bullet">
<li data-line="189" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Speculation may be wrong, so any speculation mechanism will require a <em>back-out</em> capability which undoes the effect of the speculated instructions.
<ul class="has-list-bullet">
<li data-line="190" dir="auto"><span class="list-bullet"></span>In software speculation, the compiler usually inserts additional instructions that check the validity of the speculation and provide a <em>fix-up</em> routine to use when the speculation is wrong.</li>
<li data-line="191" dir="auto"><span class="list-bullet"></span>In hardware speculation, the processor usually speculative result until it knows they are no longer speculative. If the speculation was correct, the instructions are completed by allowing the contents of the buffers to be written to registers or memory. If the speculation is incorrect, the hardware flushes the buffers and re-executed the correct instruction sequence.</li>
</ul>
</li>
<li data-line="192" dir="auto"><span class="list-bullet"></span>Speculation can also incur exceptions that were otherwise not present. In compiler-based speculation, such problems are avoided by adding special speculation support that allows such exceptions to be ignored until it is clear that they must occur. In hardware-based speculation exceptions are simply buffered until it is clear that the instruction causing them is no longer speculative. At that point, the exception is promptly raised and handled.</li>
</ul>
</li>
</ul>
</li>
<li data-line="194" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Static multiple issue</strong> processors use the compiler to assist with packaging instructions and handling hazards. In a static issue processor, you can think of the set on instructions issued in a given clock cycle (<em>issue packet</em>), as one large instruction with multiple operations. Static multiple-issue processors typically restrict what mix of instructions can be initiated in a given clock cycle. The approach is called the <strong><a data-href="Very Long Instruction Word" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Very Long Instruction Word</a> (VLIW)</strong>.</p>
<ul class="has-list-bullet">
<li data-line="195" dir="auto"><span class="list-bullet"></span>If one instruction in an issue packet cannot be used, we must replace it with a NOP. In some processors, the compiler takes full responsibility for removing all hazards, scheduling the code, and inserting NOPs so that the code executes without any needs for hardware hazard detection. In others, the hardware detects data hazards and generates stalls between two issue packets, while requiring that the compiler avoid all dependencies within an instruction packet.</li>
<li data-line="196" dir="auto"><span class="list-bullet"></span>A compiler technique that can get more performance from loops is <strong><a data-href="Loop Unrolling" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Loop Unrolling</a></strong>, where multiple copies of a loop body are made. After unrolling, more potential ILP is made available by overlapping instructions from different iterations.</li>
</ul>
</li>
<li data-line="198" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Dynamic multiple issue processors</strong>, known as <a data-href="Superscalar Processors" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Superscalar Processors</a>, can decide at runtime how many instructions to issue in a given clock cycle. The compiler still tries to schedule instructions to separate dependencies and thereby improve the instruction issue rate.</p>
<ul class="has-list-bullet">
<li data-line="199" dir="auto"><span class="list-bullet"></span>The main difference between superscalars and VLIW processors is that the code, whether scheduled or not, is guaranteed to execute correctly on superscalars. In some VLIW designs, recompilation is required when moving across different processor models.</li>
<li data-line="200" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Many superscalars extend dynamic issue decisions to include <strong>dynamic pipeline scheduling</strong>. Dynamic pipeline scheduling provides hardware support for the reordering of instruction execution to avoid pipeline stalls.
<ul class="has-list-bullet">
<li data-line="201" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In processors which support dynamic pipeline scheduling, the pipeline is divided into three major units:
<ul class="has-list-bullet">
<li data-line="202" dir="auto"><span class="list-bullet"></span><strong>Instruction fetch and issue unit</strong>: Fetches instructions, decodes them, and sends each instruction to a corresponding functional unit for execution.</li>
<li data-line="203" dir="auto"><span class="list-bullet"></span><strong>Multiple functional units</strong>: These units execute instructions and contain buffers known as <strong>reservation stations</strong>, which hold operands and the operation. When all operands are available and the functional unit is ready, the result is computed. This result is then dispatched to any reservation stations waiting for it, as well as to the commit unit.</li>
<li data-line="204" dir="auto"><span class="list-bullet"></span><strong>Commit Unit</strong>: This unit buffers results until it is safe to write them into the register file or memory. The buffer, referred to as the <strong>reorder buffer</strong>, also supplies operands similarly to forwarding logic in statically scheduled processors.</li>
</ul>
</li>
<li data-line="205" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The combination of buffering results in the reservation stations and the reorder buffer provides a form of <em>register renaming</em>.
<ul class="has-list-bullet">
<li data-line="206" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Register renaming is a technique used to eliminate false dependencies between instructions. For example, write-after-read and write-after-write instructions that use the same destination register have a name dependency, but no logical dependency. Register renaming addresses this issue by mapping architectural registers to a larger pool of physical registers, effectively removing the name dependency.
<ul class="has-list-bullet">
<li data-line="207" dir="auto"><span class="list-bullet"></span>When an instruction issues, it is copied to a reservation station for the appropriate functional unit. Any operands that are available in the register file or reorder buffer are also immediately copied into the reservation station. The instruction is buffered until all the operands and the functional unit are available. For the issuing instruction, the register copy of the operand is no longer required, and can be overwritten if needed.</li>
<li data-line="208" dir="auto"><span class="list-bullet"></span>If an operand is not in the register file or reorder buffer, it must be being computed by a functional unit. The functional unit that is producing the result is tracked, and when that unit produces the result, it is copied directly into the waiting reservation station.</li>
</ul>
</li>
</ul>
</li>
<li data-line="209" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Dynamically scheduled pipelines perform <strong>out-of-order execution</strong>, since instructions can be executed in a different order than they were fetched.
<ul class="has-list-bullet">
<li data-line="210" dir="auto"><span class="list-bullet"></span>The instruction fetch and decode unit issues instructions in sequential order, which allows dependencies to be tracked, and the commit unit is required to write results to registers and memory in program fetch order. This is called <strong>in-order commit</strong>.</li>
<li data-line="211" dir="auto"><span class="list-bullet"></span>Although the front-end (<em>fetch and issue</em>) and back-end (<em>commit</em>) of the pipeline run in order, the functional units are free to initiate execution whenever the data they need are available.</li>
</ul>
</li>
<li data-line="212" dir="auto"><span class="list-bullet"></span>Dynamic scheduling is often extended by including hardware speculation, especially for branch outcomes. Because the instructions are committed in order, we know whether the branch prediction was correct or not before any instructions from the predicted path are committed.</li>
<li data-line="213" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Out-of-order execution creates new pipeline hazards, such as a name dependence. Our original pipeline hazard was the result of a <em>true data dependence</em>, a <strong>name dependence</strong>, on the other hand, occurs when two instructions use the same register or memory location without any flow of data between the instructions. There are two types of name dependencies between an instruction <code>i</code> that proceeds an instruction <code>j</code> in program order:
<ul class="has-list-bullet">
<li data-line="214" dir="auto"><span class="list-bullet"></span><strong>Antidependence</strong>: Occurs when instruction <code>j</code> writes a register or memory location that instruction <code>i</code> reads. This is also called a <strong>write-after-read (WAR)</strong> dependence. The original ordering must be preserved to ensure that <code>i</code> reads the correct value.</li>
<li data-line="215" dir="auto"><span class="list-bullet"></span><strong>Output Dependence</strong>: Occurs when instructions <code>i</code> and <code>j</code> write the same register or memory location. This is also called a <strong>write-after-write (WAW)</strong> dependence. The ordering must be preserved so that the value finally written corresponds to instruction <code>j</code>.</li>
<li data-line="216" dir="auto"><span class="list-bullet"></span>A true data dependence corresponds to a <strong>read-after-write</strong> dependence.</li>
</ul>
</li>
</ul>
</li>
<li data-line="217" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Both pipelining and multiple-issue execution aim to increase peak instruction throughput and attempt to exploit <strong>instruction-level parallelism</strong>.
<ul class="has-list-bullet">
<li data-line="218" dir="auto"><span class="list-bullet"></span>The downside of dynamic multiple issue and hardware speculation is potential energy inefficiency. Some modern processor designs are not as deeply pipelined or aggressively speculative as its predecessors. This leads to lower overall performance but higher <strong>performance per joule</strong>.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Ch.5 Large and Fast: Exploiting Memory Hierarchy" dir="auto" class="heading" id="Ch.5_Large_and_Fast_Exploiting_Memory_Hierarchy_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.5 Large and Fast: Exploiting Memory Hierarchy</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong>principle of locality</strong> states that programs access a relatively small portion of their address space at any given time. There are two types of locality:</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Temporal Locality</strong>: If an item is referenced, it is likely to be referenced again soon.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>Spatial Locality</strong>: If an item is referenced, nearby items are likely to be referenced soon.</li>
</ul>
</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Memory Hierarchy</strong>: A structure consisting of multiple levels of memories, where smaller, faster memories are close to the CPU, and larger, slower memories are farther. The faster memories are smaller because they are more expensive per bit.</p>
<ul class="has-list-bullet">
<li data-line="5" dir="auto"><span class="list-bullet"></span>The minimum unit of information that can be present or not is called a <strong>block</strong> or a <strong>line</strong>.</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>If the data requested by the processor is present in the highest level of the hierarchy, this is called a <strong>hit</strong>. If the data is not found, it is called a <strong>miss</strong>, and the search continues to lower levels in the hierarchy.
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span>The <strong>hit rate</strong> is the fraction of memory accesses found at a given level. The <strong>miss rate</strong>, on the other hand, is the fraction of memory accesses not found at a given level.</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span><strong>Hit time</strong> is the time to access data at a given level of the hierarchy. The <strong>miss penalty</strong> is the time to replace a block in the current level with the corresponding block in the lower level.</li>
</ul>
</li>
</ul>
</li>
<li data-line="10" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>There are four primary technologies used in modern memory hierarchies:</p>
<ul class="has-list-bullet">
<li data-line="11" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Static Random Access Memory (SRAM)</strong>: Integrated circuits (ICs) that are memory arrays with a single access port that can provide either a read or a write. SRAMs have a fixed access time to any data address, though the read and write access times may differ.
<ul class="has-list-bullet">
<li data-line="12" dir="auto"><span class="list-bullet"></span>Unlike DRAMs, SRAMs don't have to be refreshed. SRAMs typically use six to eight <a data-tooltip-position="top" aria-label="Transistor" data-href="Transistor" href=".html" class="internal-link" target="_self" rel="noopener nofollow">transistors</a> per bit to store data.</li>
</ul>
</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Dynamic Random Access Memory (DRAM)</strong>: Integrated circuits that store bits as a charge in a capacitor. A single transistor is then used to access this stored charge for read or writes. Because DRAMs only use a capacitor and transistor for each bit, they are much cheaper and denser than SRAM.
<ul class="has-list-bullet">
<li data-line="14" dir="auto"><span class="list-bullet"></span>The capacitors must be periodically <em>refreshed</em> since the capacitor cannot store the charge indefinitely. To refresh, the value in each cell is simply read and written back. The charge can be kept for several milliseconds. DRAMs use a two-level decoding structure which allow entire <em>rows</em> to be refreshed at a time.</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span>DRAMs buffer rows for repeated access. The buffer acts like an SRAM: by changing the address, random bits can be accessed in the buffer until the next row access.</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>SDRAMs (<em>synchronous DRAMs</em>), are clocked, which eliminates the time needed for the memory and processor to synchronize. SDRAM can transfer bits in bursts without needing to specify additional address bits for each transfer. Instead, the clock signal enables the transfer of successive bits in a burst <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/mode.html#_0" target="_self" rel="noopener noreferrer" from="275" to="279" origin-text="mode" class="internal-link virtual-link-a">mode</a></span>. This is called <strong>double data rate (DDR)</strong> DRAM. The name means that data is transferred on both the rising and falling edge of the clock.</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>To sustain DDR bandwidth capabilities, DRAM can be organized to read or write from multiple <em>banks</em>, each with their own row buffer. With multiple banks, there is just one access time and then accesses rotate between the banks. This rotating access scheme is called <strong>address interleaving</strong>.</li>
<li data-line="18" dir="auto"><span class="list-bullet"></span>For PCs and servers, DRAMs come in a DIMM (<em>dual inline memory module</em>) package, where each DIMM typically contains 4-16 DRAMs.</li>
</ul>
</li>
<li data-line="19" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Nonvolatile Memory (NVM)</strong>: Typically implemented using <em>flash memory</em>, which is a type of EEPROM (<em>electronically erasable programmable read-only memory</em>).
<ul class="has-list-bullet">
<li data-line="20" dir="auto"><span class="list-bullet"></span>Writes wear out flash memory bits, to address this issue, the device controller tries to spread the writes evenly across the device. This technique is called <strong>wear leveling</strong>.</li>
</ul>
</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Hard Disk Drive (HDD)</strong>: Commonly referred to as <em>hard drives</em>, HDDs are a mechanical device which store data on a collection of platters. These platters rotate on a spindle at a fixed RPM. The platters are covered with a magnetic recording material on each side.
<ul class="has-list-bullet">
<li data-line="22" dir="auto"><span class="list-bullet"></span>Data is read from and written to the HDD using the <strong>read/write head</strong>, which is a movable arm containing a small electromagnetic coil.</li>
<li data-line="23" dir="auto"><span class="list-bullet"></span>Each platter is divided into concentric circles, called <strong>tracks</strong>. Each track is in turn divided into <strong>sectors</strong>. Sectors are typically 512 to 4096 bytes in size.</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>Each platter spins in conjunction, so that every head is over the same track of every surface. The term <strong>cylinder</strong> is used to refer to all the tracks under the heads at a given point on all surfaces.</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span>To access data, the OS must direct the disk through a three-stage process: the first is to position the head over the proper track. This operation is called a <em>seek</em>, and the time it takes to move the head to the track is the <em>seek time</em>. Once the head is over the correct track, we must wait for the desired sector to rotate under the head. This time is called the <strong>rotational latency</strong>. The last component is <strong>transfer time</strong>, which is the time it takes to transfer a block of bits. The transfer time is a function of the sector size, the rotation speed, and the recording density of a track.</li>
<li data-line="26" dir="auto"><span class="list-bullet"></span>Most disk controllers have a built-in cache that stores sectors as they are passed over.</li>
</ul>
</li>
</ul>
</li>
<li data-line="28" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Cache" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Cache</a></strong>: A small, high-speed memory located close to the CPU that holds frequently or recently accessed data. When the CPU needs data, it first checks the cache. If the data is found, this results in a <strong>hit</strong>, significantly reducing memory access time. If the data is not found, a <strong>miss</strong> occurs, and the CPU must fetch the data from the main memory. Once the data is retrieved, it is typically stored in the cache for future reference.</p>
<ul class="has-list-bullet">
<li data-line="29" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A <strong>direct-mapped cache</strong> is a cache structure where each word can go in exactly one place in the cache. The location is typically assigned based of the address of the word in memory. This type of cache can be thought of as a <a data-href="Hash Table" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Hash Table</a> where the hash function is simply a modulo of the number of blocks in the cache. Collisions are handled by simply overwriting the block with the new data.
<ul class="has-list-bullet">
<li data-line="30" dir="auto"><span class="list-bullet"></span>Since multiple addresses can be mapped to one cache location, to know whether the data in the cache corresponds to the requested word, a set of tags are added to the cache. The tags contain the address information of the stored data. These tags only need to store the upper bits of the address, corresponding to the bits not used to index the cache.</li>
<li data-line="31" dir="auto"><span class="list-bullet"></span>The index of a cache block, along with the tag contents of the block, uniquely specify the memory address of the word contained in the block. Because the index field is used as an address to reference the cache, and because an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit field has <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> values, the total number of entries in a cache must be a power of 2. Since words are aligned to multiples of 4 bytes, the least significant two bits of each address specify a byte within a word. Hence, if the words are aligned in memory, the two least significant bits can be ignored when selecting a word in a block.</li>
<li data-line="32" dir="auto"><span class="list-bullet"></span>We also need a mechanism to determine whether the data in the cache is valid. The most common method is to use a <strong>valid bit</strong>, where, if the bit is not set, then the data in the corresponding block is invalid.</li>
</ul>
</li>
<li data-line="33" dir="auto"><span class="list-bullet"></span>The total number of bits required for a cache is a function of the cache size and address size, since the cache includes both the data and the tag field.</li>
<li data-line="34" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Larger block sizes exploit greater spatial locality to lower miss rates. Though, increasing the block size also increases the miss penalty since more data has to be transferred for each miss.
<ul class="has-list-bullet">
<li data-line="35" dir="auto"><span class="list-bullet"></span>A technique called <strong>early restart</strong> can be used to hide some of the transfer time of large blocks so that the miss penalty is effectively smaller. Simply resume execution as soon as the requested word of the block is available, rather than wait for the entire block. This is commonly used for instruction accesses.</li>
<li data-line="36" dir="auto"><span class="list-bullet"></span>A more sophisticated scheme, called <strong>requested word first</strong>, is to organize the memory so that the requested word is transferred from the memory to the cache first. The remainder of the block is then transferred, starting with the address after the requested word and wrapping around to the beginning of the block.</li>
</ul>
</li>
<li data-line="37" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>As mentioned earlier, a cache miss occurs when a request for data is not present in the cache and must be fetched from main memory. The control unit must detect a cache miss and process the miss by fetching the requesting the data from memory, or a lower-level cache.
<ul class="has-list-bullet">
<li data-line="38" dir="auto"><span class="list-bullet"></span>Cache miss handling is done in collaboration with the processor control unit and with a separate controller that initiates the memory access and refills the cache. The processing of a cache miss creates a pipeline stall. More sophisticated <strong>out-of-order processors</strong> can allow execution of instructions while waiting for a cache miss.</li>
<li data-line="39" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The steps taken on an instruction cache miss are as follows:
<ul class="has-list-bullet">
<li data-line="40" dir="auto"><span class="list-bullet"></span>Send the original PC value to the memory. Since the program counter is incremented in the first clock cycle, the original PC is the current value minus 4.</li>
<li data-line="41" dir="auto"><span class="list-bullet"></span>Instruct main memory to perform a read and wait for the memory to complete its access.</li>
<li data-line="42" dir="auto"><span class="list-bullet"></span>Write the cache entry, putting the data from memory in the data portion of the entry, writing the upper bits of the address into the tag field, and setting the valid bit.</li>
<li data-line="43" dir="auto"><span class="list-bullet"></span>Restart the instruction execution at the first step, which will re-fetch the instruction, now finding it in the cache.</li>
</ul>
</li>
<li data-line="44" dir="auto"><span class="list-bullet"></span>The control of the cache on a data access, as opposed to an instruction access, is essentially identical.</li>
</ul>
</li>
<li data-line="45" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In the case of writes, the data in the cache and main memory can become <em>inconsistent</em>. The simplest way to keep the cache and main memory consistent is to always write the data into both the cache and memory. This is called a <strong>write-through</strong> scheme.
<ul class="has-list-bullet">
<li data-line="46" dir="auto"><span class="list-bullet"></span>In the case of a <em>write miss</em>, we must first fetch the words of the block from memory, place the block in the cache, then overwrite the word that caused the miss. We could also write the word directly to main memory using the full address.</li>
<li data-line="47" dir="auto"><span class="list-bullet"></span>A write-through scheme suffers from intolerably poor performance, since every store instruction results in a write to main memory. One solution is to use a <strong>write buffer</strong>. A write buffer stores the data while they are waiting to be written to memory. When a write to main memory completes, the entry in the write buffer is freed. If the write buffer becomes full while the processor performs a write, the processor must stall until there is space in the write buffer.</li>
<li data-line="48" dir="auto"><span class="list-bullet"></span>Instead of a write-through scheme, a <strong>write-back</strong> scheme only writes the new value to the cache, the modified block is then written to the lower level of the hierarchy when it is replaced.</li>
</ul>
</li>
</ul>
</li>
<li data-line="50" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>CPU time can be divided into the clock cycles that the CPU spends executing the program, and the clock cycles that the CPU spends waiting for memory. We assume that the cost of cache hits are part of the normal CPU execution cycles. Therefore:</p>
<ul class="has-list-bullet">
<li data-line="51" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></li>
<li data-line="52" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The memory stall clock cycles come mainly from cache misses. Memory stall cycles can be defined as the sum of the stall cycles from reads and writes.
<ul class="has-list-bullet">
<li data-line="53" dir="auto"><span class="list-bullet"></span>For a write-through scheme, we have two sources of stalls: write misses, which require that we fetch the block before continuing the write, and write buffer stalls, which occur when the write buffer is full when a write happens. Though, in systems with a reasonable write buffer depth and a memory capable of accepting writes at a rate that significantly exceeds the average write frequency in programs, the write buffer stalls will be rare, and we can safely ignore them. In most write-through cache organizations, the read and write miss penalties are the same, therefore, we can combine the reads and writes by using a single miss rate and miss penalty.</li>
<li data-line="54" dir="auto"><span class="list-bullet"></span>Write-back schemes also have potential additional stalls arising from the need to write a cache block to memory when the block is replaced.</li>
</ul>
</li>
<li data-line="55" dir="auto"><span class="list-bullet"></span>If the processor is made faster, but the memory system is not, then the fraction of CPU time spent on memory stalls will increase due to <a data-href="Amdahl's Law" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Amdahl's Law</a>.</li>
<li data-line="56" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Larger caches can result in longer hit times, and the increase in hit time for a larger cache can dominate the improvement in hit rate, leading to a decrease in performance. A metric, called <strong>average memory access time (AMAT)</strong> can be used to compare alternative cache designs. Average memory access time is the average time to access memory considering both hits and misses and the frequency of different accesses:
<ul class="has-list-bullet">
<li data-line="57" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D43B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></li>
</ul>
</li>
<li data-line="58" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Placement schemes dictate which cache locations blocks can be mapped to.
<ul class="has-list-bullet">
<li data-line="59" dir="auto"><span class="list-bullet"></span>A <strong>direct mapped</strong> cache maps each block to exactly one location in the cache.</li>
<li data-line="60" dir="auto"><span class="list-bullet"></span>In a <strong>fully-associative</strong> cache, a block in memory can be associated with any entry in the cache. To find a given block in the cache, a full search must be done. To make this search practical, it is done in parallel with a comparator associated with each cache entry. These comparators significantly increase the hardware cost, making fully-<span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/associative-property.html#_0" target="_self" rel="noopener noreferrer" from="316" to="327" origin-text="associative" class="internal-link virtual-link-a">associative</a></span> caches impractical for larger cache sizes.</li>
<li data-line="61" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In a <strong>set-associative</strong> cache, there are a fixed number of locations where each block can be placed. A set-associative cache with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> locations for a block is called an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-way set-associative cache. An <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-way set-associative cache consists of a number of sets, each of which contain <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> blocks. Each block is directly mapped to a set, and then all the blocks in the set are searched for a match. All the tags in the selected set can be searched in parallel to decrease the AMAT.
<ul class="has-list-bullet">
<li data-line="62" dir="auto"><span class="list-bullet"></span>This is similar to hash table chaining, where multiple entries can exist at a single hash table index, allowing collisions to be handled by storing multiple records in a linked list or array.</li>
<li data-line="63" dir="auto"><span class="list-bullet"></span>The set containing a memory block is given by the block number, modulo the number of sets in the cache.</li>
</ul>
</li>
<li data-line="64" dir="auto"><span class="list-bullet"></span>A direct-mapped cache can be thought of as a one-way set-associative cache, while a fully-associative cache with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> entries is simply an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-way set-associative cache. The advantage of increasing the degree of associativity is that it usually decreases the miss rate, while the main disadvantage is a potential increase in hit time. If the total cache size is kept the same, increasing the associativity raises the number of blocks per set, which is the number of simultaneous compares needed to perform the search in parallel.</li>
<li data-line="65" dir="auto"><span class="list-bullet"></span>In a direct-mapped cache, only a single comparator is needed. While in an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-way set-associative cache, <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> comparators are needed, as well as an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-to-1 multiplexer to choose among the <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> potential members of the selected set. The cost of an associative cache are the extra comparators and any delay imposed by having to do the compare and select from among the members of the set.</li>
<li data-line="66" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>When a miss occurs in a direct-mapped cache, the requested block can only go in one position, and the block currently occupying that position must be replaced. In an associative cache, there is a choice of which block to replace.
<ul class="has-list-bullet">
<li data-line="67" dir="auto"><span class="list-bullet"></span>The most common scheme is the <strong>least recently used (LRU)</strong> scheme, where the block replaced is the one that has been unused for the longest time.</li>
</ul>
</li>
</ul>
</li>
<li data-line="68" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To close the gap between the fast clock rates of modern processors and the increasingly long time required to access DRAMs, most microprocessors support an additional level of caching. This second-level cache is normally on the same chip and is accessed whenever a miss occurs in the primary cache. This is called <strong>multilevel caching</strong>.
<ul class="has-list-bullet">
<li data-line="69" dir="auto"><span class="list-bullet"></span>A two-level cache structure allows the primary cache to focus on minimizing hit time to yield a shorter clock cycle, while allowing the secondary cache to focus on minimizing miss rate to reduce the penalty of long memory access times. The secondary cache often uses higher associativity than the primary cache given the focus of reducing miss rates.</li>
<li data-line="70" dir="auto"><span class="list-bullet"></span>Multilevel caching causes us to differentiate between the <strong>local miss rate</strong>, which is the miss rate of one level of the cache, and the <strong>global miss rate</strong>, which is the miss rate of the entire cache structure.</li>
<li data-line="71" dir="auto"><span class="list-bullet"></span><a data-href="Out-of-Order Processors" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Out-of-Order Processors</a> execute instructions during the miss penalty. Therefore, instead of miss rates, we use misses per instruction as the primary performance metric.</li>
</ul>
</li>
</ul>
</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Standard algorithmic analysis frequently ignores the impact of the memory hierarchy. Given the importance of the memory hierarchy to program performance, many software optimizations were invented that can dramatically improve performance by reusing data within the cache and hence lower miss rates.</p>
<ul class="has-list-bullet">
<li data-line="73" dir="auto"><span class="list-bullet"></span>When dealing with arrays, we can get good memory performance if we store the array in memory so that accesses to the array are sequential in memory. Storing the arrays row-by-row is called <strong>row major order</strong>, while storing arrays column-by-column is called <strong>column major order</strong>.</li>
<li data-line="74" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Though, neither row major nor column major order are optimal when we are dealing with multiple arrays where some are accessed by rows and some by columns. Instead of operating on entire rows or columns of an array, <em>blocked</em> algorithms operate on sub-matrices or blocks. The goal is to maximize accesses to the data loaded into the cache before the data are replaced.
<ul class="has-list-bullet">
<li data-line="75" dir="auto"><span class="list-bullet"></span>Blocking can also be used to improve register allocation. By taking a small block size, such that the block can fit in registers, we can minimize the number of loads and stores in the program.</li>
</ul>
</li>
</ul>
</li>
<li data-line="77" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>It is crucial that the memory hierarchy of a system is dependable. As mentioned in chapter One, the one great idea for dependability is redundancy.</p>
<ul class="has-list-bullet">
<li data-line="78" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We'll assume there is a specification of proper service. Users can then see a system alternating between two <em>states</em> of delivered service with respect to the specification:
<ol>
<li data-line="79" dir="auto"><strong>Service Accomplishment</strong>: The service is delivered as specified.</li>
<li data-line="80" dir="auto"><strong>Service Interruption</strong>: The delivered service is different from the specified service.</li>
</ol>
</li>
<li data-line="81" dir="auto"><span class="list-bullet"></span>Transitions from state 1 to state 2 are caused by <strong>failures</strong>, and transitions from state 2 to state 1 are <strong>restorations</strong>. Failures can be transient or permanent.</li>
<li data-line="82" dir="auto"><span class="list-bullet"></span><strong>Reliability</strong> is a measure of the continuous service accomplishment. Hence, <strong><a data-tooltip-position="top" aria-label="Mean" data-href="Mean" href="notes/math/mean.html#_0" class="internal-link" target="_self" rel="noopener nofollow">mean</a> time to failure (MTTF)</strong> is a reliability measure. A related measure, called the <strong>annual failure rate (AFR)</strong> is simply the percentage of devices that are expected to fail in a year given the MTTF.</li>
<li data-line="83" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Availability</strong> is a measure of service accomplishment with respect to the alternation between the two states of accomplishment and interruption. Service interruption is measured as <strong><span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/mean.html#_0" target="_self" rel="noopener noreferrer" from="0" to="4" origin-text="mean" class="internal-link virtual-link-a">mean</a></span> time to repair (MTTR)</strong>. The <strong>mean time between failures (MTBF)</strong> is simply the sum of <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>. Therefore, availability is statistically quantified as:
<ul class="has-list-bullet">
<li data-line="84" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></span></li>
<li data-line="85" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>One shorthand notation for availability is to quote the number of <em>nines of availability</em>. This refers to the fraction of time a system is operational and can be represented as follows:
<ul class="has-list-bullet">
<li data-line="86" dir="auto"><span class="list-bullet"></span><strong>Two nines (99%)</strong>: 3.65 days of repair/year.</li>
<li data-line="87" dir="auto"><span class="list-bullet"></span><strong>Three nines (99.9%)</strong>: 526 minutes of repair/year.</li>
<li data-line="88" dir="auto"><span class="list-bullet"></span><strong>Four nines (99.99%)</strong>: 52.6 minutes of repair/year.</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span><strong>Five nines (99.999%)</strong>: 5.26 minutes of repair/year.</li>
</ul>
</li>
</ul>
</li>
<li data-line="90" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To increase the MTTF, you can improve the quality of the components or design a system that can continue to operate in the presence of failed components. Hence, we need to differentiate between the failure of the system, which is called a <strong>failure</strong>, and the failure of a component, which is called a <strong>fault</strong>. There are three ways to improve the MTTF:
<ol>
<li data-line="91" dir="auto"><strong>Fault Avoidance</strong>: Preventing fault occurrence by construction.</li>
<li data-line="92" dir="auto"><strong>Fault Tolerance</strong>: Using redundancy to allow service to continue despite the presence of faults.</li>
<li data-line="93" dir="auto"><strong>Fault Forecasting</strong>: Predicting faults before they occur, allowing the component to be replaced before it faults.</li>
</ol>
</li>
</ul>
</li>
<li data-line="95" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The <strong><a data-href="Hamming Distance" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Hamming Distance</a></strong> between two bit patterns is just the minimum number of bits that are different between any two bit patterns.</p>
<ul class="has-list-bullet">
<li data-line="96" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A bit pattern has even <strong>parity</strong> if the number of 1s is even, otherwise, it has odd parity. When a word is written into memory, its parity bit is also written, where a 1 denotes odd parity, and a 0 denotes even parity. That way, when a word is read out, its parity can be calculated and compared to its stored parity to determine if an error has occurred.
<ul class="has-list-bullet">
<li data-line="97" dir="auto"><span class="list-bullet"></span>A parity bit can only <strong>detect</strong> errors, not correct them. Furthermore, a parity bit can only detect an <em>odd</em> number of errors, since any even number of errors will result in the original parity.</li>
</ul>
</li>
<li data-line="98" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>If we used a code that had a minimum distance of 3, then any single bit error would be closer to the correct pattern than any other valid pattern. The <strong><a data-href="Hamming Error Correction Code" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Hamming Error Correction Code</a> (ECC)</strong> uses extra parity bits to allow the position identification of a single error. The steps to calculate the Hamming ECC are:
<ol>
<li data-line="99" dir="auto">Number the bits, starting with the leftmost bit as position 1.</li>
<li data-line="100" dir="auto">Mark all bit positions that are powers of 2 as parity bits (e.g., positions 1, 2, 4, 8, ...).</li>
<li data-line="101" dir="auto">All other bit positions are used for data bits.</li>
<li data-line="102" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The position of the parity bit determines the sequence of data bits that it checks:
<ul class="has-list-bullet">
<li data-line="103" dir="auto"><span class="list-bullet"></span><strong>Bit 1</strong> checks every bit where the rightmost bit of the address is 1 (i.e., odd-numbered positions).</li>
<li data-line="104" dir="auto"><span class="list-bullet"></span><strong>Bit 2</strong> checks bits in positions where the second rightmost bit is 1 (i.e., positions 2, 3, 6, 7, ...).</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span><strong>Bit 4</strong> checks bits in positions where the third rightmost bit is 1 (i.e., positions 4-7, 12-15, etc.).</li>
</ul>
</li>
<li data-line="106" dir="auto">Set parity bits to create even parity for each group.</li>
</ol>
</li>
<li data-line="107" dir="auto"><span class="list-bullet"></span>Using this code, you can detect <em>and correct</em> any 1-bit error. Though, at the cost of one more bit, we can make the minimum Hamming distance in a code be 4. This enables us to correct single bit errors and <em>detect double-bit errors</em>. To do so, you simply add a parity bit that is calculated over the whole word. This is called the Single Error Correcting/Double Error Detecting (<a data-href="SEC/DED" href=".html" class="internal-link" target="_self" rel="noopener nofollow">SEC/DED</a>) code. The algorithm to correct one error and detect two is just to calculate the parity over the ECC groups <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> as before plus one more over the entire group <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math></mjx-container></span>.</li>
</ul>
</li>
<li data-line="109" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Virtual machines are software emulations of physical computer systems. These virtual machines are managed by a <strong>hypervisor</strong>, or <strong>virtual machine monitor (VMM)</strong>. The VMM is responsible for creating, managing, and executing virtual machines.</p>
<ul class="has-list-bullet">
<li data-line="110" dir="auto"><span class="list-bullet"></span>The underlying hardware platform is called the <em>host</em>, and its resources are shared among the <em>guest</em> VMs. The VMM is responsible for mapping virtual resources to physical resources.</li>
<li data-line="111" dir="auto"><span class="list-bullet"></span>The overhead incurred by virtualization depends on the workload. User-level processor-bound applications have zero virtualization overhead, since the OS is rarely invoked. I/O intensive workloads, on the other hand, can result in high virtualization overhead due to the large amounts of system calls and privileged instructions necessary to perform I/O.</li>
<li data-line="112" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>VMMs have the following requirements:
<ol>
<li data-line="113" dir="auto">Present a software interface to guest software.</li>
<li data-line="114" dir="auto">Isolate the state of guests from each other.</li>
<li data-line="115" dir="auto">Protect itself guest software.</li>
<li data-line="116" dir="auto">Control access to privileged state, I/O, exceptions, and interrupts.</li>
<li data-line="117" dir="auto">Guest software should behave exactly as if it were running on the native hardware, excluding performance related behavior or limitations.</li>
<li data-line="118" dir="auto">Guest software should not be able to change the allocation of real system resources directly.</li>
</ol>
</li>
<li data-line="119" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The VMM must be at a higher privilege level than the guest VM, which generally runs in user mode. The basic system requirements necessary to support VMMs are:
<ol>
<li data-line="120" dir="auto">At least two processor modes: system and user.</li>
<li data-line="121" dir="auto">A privileged subset of instructions that is available only in system mode, resulting in a trap if executed in user mode. All system resources must be controllable from just these instructions.</li>
</ol>
</li>
<li data-line="122" dir="auto"><span class="list-bullet"></span>An ISA is considered <em>virutalizable</em> if it allows the VM to execute directly on the hardware. Examples include IBM 370 and RISC-V.</li>
<li data-line="123" dir="auto"><span class="list-bullet"></span>Since the guest OS cannot directly interact with physical resources, when it attempts to modify or access information related to hardware resources using a privileged instruction, it will trap to the VMM. The VMM is then responsible for affecting the appropriate changes to the corresponding physical resources.</li>
</ul>
</li>
<li data-line="125" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Virtual Memory" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Virtual Memory</a></strong> is a technique where main memory acts as a <em>cache</em> for secondary storage. Main memory need only contain the active portions of many programs, thus, exploiting the principle of locality.</p>
<ul class="has-list-bullet">
<li data-line="126" dir="auto"><span class="list-bullet"></span>A program is compiled into its own <strong>address space</strong>, a <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/range.html#_0" target="_self" rel="noopener noreferrer" from="4" to="9" origin-text="range" class="internal-link virtual-link-a">range</a></span> of memory locations accessible only to the program. The virtual memory system implements the translation of a program's address space to <strong>physical addresses</strong>. This translation process enforces protection of a program's address space from other processes.</li>
<li data-line="127" dir="auto"><span class="list-bullet"></span>A virtual memory block is called a <strong>page</strong>, and a virtual memory miss is called a <strong>page fault</strong>.</li>
<li data-line="128" dir="auto"><span class="list-bullet"></span>The processor produces a <strong>virtual address</strong>, which is translated to a physical address, which is can be used to access main memory. This process is called address mapping or address translation.</li>
<li data-line="129" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Virtual memory also simplifies the loading of a program by providing <strong>relocation</strong>. Relocation maps the virtual addresses used by a program to different physical addresses before the addresses are used to access memory. This allows us to load the program anywhere in main memory.
<ul class="has-list-bullet">
<li data-line="130" dir="auto"><span class="list-bullet"></span>Today, all virtual memory systems relocate the program as a set of fixed-size blocks (pages), thereby eliminating the need to allocate a program contiguously. </li>
</ul>
</li>
<li data-line="131" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In virtual memory, the address is broken into a virtual page number and a page offset. The physical page number constitutes the upper portion of the physical address, while the page offset constitutes the lower portion. The number of bits in the page offset determine the page size.
<ul class="has-list-bullet">
<li data-line="132" dir="auto"><span class="list-bullet"></span>The number of pages addressable with the virtual address can be different than the number of pages addressable with the physical address. Having a larger number of virtual pages than physical pages is the basis for the illusion of a larger amount of virtual memory.</li>
</ul>
</li>
<li data-line="133" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A page fault to disk incurs an enormous miss penalty of millions of clock cycles. This led to several key decisions in designing virtual memory systems:
<ul class="has-list-bullet">
<li data-line="134" dir="auto"><span class="list-bullet"></span>Pages should be large enough to amortize the high access time. Sizes from 4KiB to 64KiB are common today.</li>
<li data-line="135" dir="auto"><span class="list-bullet"></span>Allowing fully associative placement of pages in memory. This means that virtual pages can be mapped to any physical page.</li>
<li data-line="136" dir="auto"><span class="list-bullet"></span>Page faults can be handled in software since the overhead will be negligible compared to the disk access time. Additionally, software can afford to use clever algorithms for choosing how to place and replace pages.</li>
<li data-line="137" dir="auto"><span class="list-bullet"></span>Virtual memory systems use write-back schemes, where modified pages are only written back to secondary storage when they are discarded from memory. To keep track of whether a page has been written to since it was read into memory, a <strong>dirty bit</strong> is set whenever any page is written to. Therefore, a page only needs to be written back to secondary memory if the dirty bit is set.</li>
</ul>
</li>
<li data-line="138" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In virtual memory systems, pages are located using a table that indexes the main memory. This structure is called a <strong>page table</strong>, and it resides in main memory. A page table is indexed by the virtual page number to discover the corresponding physical page number. Each program has its own page table. To locate the page table in memory, the hardware includes a register, called the <strong>page table register</strong>, that points to the start of the page table.
<ul class="has-list-bullet">
<li data-line="139" dir="auto"><span class="list-bullet"></span>A valid bit is used in each page table register where, if the bit is not asserted, the page is not present in main memory and a page fault occurs.</li>
<li data-line="140" dir="auto"><span class="list-bullet"></span>The operating system is responsible for allocating the physical memory and updating the page table, so that the virtual address spaces of different processes do not collide.</li>
<li data-line="141" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A range of techniques are used to reduce the amount of storage required for the page table:
<ol>
<li data-line="142" dir="auto">The simplest technique is to keep a limit register that restricts the size of the page table for a given process. If the virtual page number becomes larger than the contents of the limit register, entries must be added to the page table. This technique allows the page table to grow as a process consumes more space. This technique requires that the address space expand in just one direction.</li>
<li data-line="143" dir="auto">Allowing growth in only one direction is not sufficient, since most languages require two areas whose size is expandable: the stack, and the heap. Because of this, it is convenient to divide the page table and let it grow from the highest address down, and the lowest address up. This results in two separate page tables and two separate limits. The high-order bit of an address usually specifies which page table to index. The major disadvantage of this scheme is that it does not work well when the address space is used sparsely, as opposed to a contiguous set of virtual addresses.</li>
<li data-line="144" dir="auto">Another approach is to apply a hashing function to the virtual address so that the page table need only be the size of the number of physical pages in main memory. This is called an <strong>inverted page table</strong>. This makes the lookup process more complex since we can no longer just index the page table.</li>
<li data-line="145" dir="auto">Modern systems also allow the page table to be paged itself. This technique enables some critical problems, such as a never-ending series of page faults, and the way these problems are addressed are highly processor-specific. Though, in general, these issues are addressed by placing all the page tables in the address space of the operating system and placing at least some of the page tables for the operating system in a portion of main memory that is physically addressed and is always present.</li>
<li data-line="146" dir="auto">Multiple levels of page tables can be used to reduce the total amount of page table storage. This is the solution used by the RISC-V architecture. Address translation happens by first looking in the level 0 table, using the highest order bits of the address. If the address is valid, the next set of high-order bits are used to index the page table indicated by the level 0 entry, and so on. This scheme allows the address space to be used in a sparse fashion, with the primary disadvantage is the added complexity for address translation.</li>
</ol>
</li>
</ul>
</li>
<li data-line="147" dir="auto"><span class="list-bullet"></span>The page table, along with the program counter and registers, specifies the <strong>state</strong> of a process. If we want to allow another process to use the processor, we must save this state. Later, the state is restored and the process can continue execution. This sequence is called a <strong>context switch</strong>. The process is considered <em>active</em> when it is in possession of a processor, otherwise, it is <em>inactive</em>.</li>
<li data-line="148" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>When a page fault occurs, the operating system must be given control. The transfer is performed using the exception mechanism discussed in chapter 4. Once the OS gets control, it must find the page in secondary memory and decide where to place it in main memory.
<ul class="has-list-bullet">
<li data-line="149" dir="auto"><span class="list-bullet"></span>The OS usually creates space on secondary memory for all the pages of a process when the process is created. This space is called <strong>swap space</strong>. At that time, it also creates a data structure to record where each virtual page is stored on disk.</li>
<li data-line="150" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The OS also creates a data structure that tracks which processes and which virtual addresses use each physical page. When a page fault occurs, if all the pages in main memory are in use, the OS must select a page to replace. Most operating systems follow the <strong>least recently used (LRU)</strong> replacement scheme. The replaced pages are then written to swap space in secondary memory.
<ul class="has-list-bullet">
<li data-line="151" dir="auto"><span class="list-bullet"></span>Most operating systems <em>approximate</em> LRU by keeping track of which pages have been used recently and which have not. RISC-V computers provide a <strong>reference bit</strong>, which is set whenever a page is accessed. The OS periodically clears the reference bits and later records them so it can determine which pages were touched during a particular time period.</li>
</ul>
</li>
</ul>
</li>
<li data-line="152" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Modern processors include a special cache that keeps track of recently used address translations. This cache is called the <strong><a data-href="Translation-Lookaside Buffer" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Translation-Lookaside Buffer</a> (TLB)</strong>.
<ul class="has-list-bullet">
<li data-line="153" dir="auto"><span class="list-bullet"></span>Each tag entry in the TLB holds a portion of the virtual page number, and each data entry holds a physical page number. Because the TLB is accessed instead of the page table on every reference, the TLB will need to include other status bits, such as the dirty and reference bits.</li>
<li data-line="154" dir="auto"><span class="list-bullet"></span>TLBs work with multi-level page tables by loading the physical address and protection tags from the last level page table.</li>
<li data-line="155" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>If we look up the virtual page number in the TLB and get a hit, the physical page number is used to form the address, and the corresponding reference bit is asserted. If the processor is performing a write, the dirty bit is also asserted. If a miss occurs, on the other hand, we must determine whether it is a TLB miss or a page fault.
<ul class="has-list-bullet">
<li data-line="156" dir="auto"><span class="list-bullet"></span>The processor handles a TLB miss by loading the translation from the last-level page table into the TLB and retrying the reference. We will need to select a TLB entry to replace, this includes copying the reference and dirty bits back to the page table entry when we replace an entry.</li>
<li data-line="157" dir="auto"><span class="list-bullet"></span>Handling a TLB miss or a page fault requires using the exception mechanism to interrupt the running process, transferring control to the OS, and later resuming execution of the interrupted process. The program counter of the instruction that caused the page fault in stored in the SEPC (<em>supervisor exception program counter</em>) register.</li>
<li data-line="158" dir="auto"><span class="list-bullet"></span>A TLB miss or page fault exception must be asserted by the end of the same clock cycle that the memory access occurs, so that the next clock cycle begins exception handling rather than continuing normal execution.</li>
<li data-line="159" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Between the time we begin executing the exception handler in the OS and the time that the OS has saved all the state of the process, the OS is particularly vulnerable. If another exception occurred when we were processing the first exception, the control unit would overwrite the exception link register, making it impossible to return to the instruction that caused the page fault. This can be avoided by providing the ability to enable and disable exceptions.
<ul class="has-list-bullet">
<li data-line="160" dir="auto"><span class="list-bullet"></span>When an exception occurs, the processor can set a bit that disables all other exceptions, this could happen at the same time the supervisor bit is asserted. The processor can then save just enough state to allow it to recover if another exception occurs, specifically, the SEPC register and the <em>supervisor exception cause</em> (SCAUSE) registers, which records the cause of the exception.</li>
</ul>
</li>
<li data-line="161" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Once the OS knows the virtual address that caused the page fault, it must:
<ol>
<li data-line="162" dir="auto">Look up the page table entry using the virtual address and find the location of the referenced page in secondary memory.</li>
<li data-line="163" dir="auto">Choose a physical page to replace. If the chosen page is dirty, it must also be written back to secondary memory.</li>
<li data-line="164" dir="auto">Start a read to bring the referenced page from secondary memory into the chosen physical page.</li>
</ol>
</li>
<li data-line="165" dir="auto"><span class="list-bullet"></span>Page fault exceptions for data accesses are particularly hard to handle since they occur in the middle of instructions, and cannot be completed before handling the instruction. Making instructions <strong>restartable</strong>, can make handling such exceptions easier. Since in RISC-V architectures each instruction writes only one data item, and this write occurs at the end of the instruction cycle, we can simply prevent the instruction from completing and restart the instruction from the beginning.</li>
</ul>
</li>
<li data-line="166" dir="auto"><span class="list-bullet"></span>Some systems use small, fully associative TLBs because a fully associative mapping has a lower miss rate. Furthermore, since the TLB is small, the cost of high associativity is marginal. Other systems use large TLBs with small associativity.</li>
</ul>
</li>
<li data-line="167" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Virtual memory and cache systems work together as a hierarchy, so that data cannot be in a cache unless it is present in main memory. The operating system maintains this hierarchy by flushing the contents of any page from the cache when it decides to migrate that page to secondary storage. Simultaneously, the OS modifies the page tables and TLB.
<ul class="has-list-bullet">
<li data-line="168" dir="auto"><span class="list-bullet"></span>A cache that is physically indexed and physically tagged requires that both the cache index and tag are physical addresses rather than virtual addresses. This means that the amount of time required to access memory, assuming a cache hit, must accommodate both a TLB access and a cache access. Alternatively, the processor can index the cache with a completely or partially virtual address. This is called a <strong>virtually addressed cache</strong>, and it uses tags that are virtual addresses.</li>
</ul>
</li>
<li data-line="169" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The single most important function of virtual memory in modern systems is the ability to share a single memory with multiple processes, while providing memory protection among these processes and the OS. This protection mechanism must ensure that processes cannot write outside their own address space. The write access bit in the TLB can protect a page from being written.
<ul class="has-list-bullet">
<li data-line="170" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To enable the OS to implement protection in the virtual memory system, the hardware must provide at least the following three capabilities:
<ol>
<li data-line="171" dir="auto">Support at least two modes that indicate whether the running process is a user process or system process. System processes are also called supervisor, kernel, or executive processes.</li>
<li data-line="172" dir="auto">provide a portion of the processor state that a user process can read but not write. This state includes the user/supervisor mode bit, the page table pointer, and the TLB.</li>
<li data-line="173" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Provide mechanisms whereby the processor can go from user mode to supervisor mode, and vice versa. The first direction is typically implemented by a <strong>system call</strong> exception, implemented as a special instruction (<code>ecall</code> in RISC-V). A system call is an instruction that transfers control from user mode to a dedicated location in supervisor code space, invoking the exception mechanism in the process.
<ul class="has-list-bullet">
<li data-line="174" dir="auto"><span class="list-bullet"></span>As with any exception, the PC (<em>program counter</em>) at the point of the system call is saved in the <strong>supervisor exception program counter (SEPC)</strong> register, and the processor is set to supervisor mode.</li>
<li data-line="175" dir="auto"><span class="list-bullet"></span>To return to user mode from the exception, use the <em>supervisor exception return</em> <code>sret</code> instruction, which resets to user mode and jumps to the address in SEPC.</li>
</ul>
</li>
</ol>
</li>
<li data-line="176" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>By using these mechanisms and storing the page tables in the OS's address space, the OS can write to the page tables while preventing user processes from changing them.
<ul class="has-list-bullet">
<li data-line="177" dir="auto"><span class="list-bullet"></span>We also want to prevent processes from reading or writing the data of other user processes. Since each process has its own virtual address space, if the OS keeps the page tables organized so that the independent virtual pages map to disjoint physical pages, processes cannot access each others' data.</li>
</ul>
</li>
<li data-line="178" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>When processes want to share information, the OS must assist them, since this requires changing the page table of the accessing process.
<ul class="has-list-bullet">
<li data-line="179" dir="auto"><span class="list-bullet"></span>The write access bit can be used to restrict the sharing to read-only, and, like the rest of the page table, this can only be changed by the OS.</li>
<li data-line="180" dir="auto"><span class="list-bullet"></span>The sharing process would request the OS to create a page table entry for a virtual page in the accessing process's address space that points to the same physical page that the sharing process wants to share. </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="182" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>There are three sources of misses in a memory hierarchy:</p>
<ol>
<li data-line="183" dir="auto"><strong>Compulsory Misses</strong>: Cache misses caused by the first access to a block that has never been in the cache. They are also referred to as <strong>cold-start misses</strong>. Compulsory misses can be reduced by increasing the block size.</li>
<li data-line="184" dir="auto"><strong>Capacity Misses</strong>: Cache misses caused when the cache cannot contain all the block needed during execution of a program. Capacity misses can be reduced by increasing the cache size.</li>
<li data-line="185" dir="auto"><strong>Conflict Misses</strong>: Cache misses that occur in set-associative or direct-mapped caches when multiple blocks compete for the same set. They are also referred to as <strong>collision misses</strong>. Conflict misses can be reduced by increasing the associativity of the cache, though, this may slow access time.</li>
</ol>
</li>
<li data-line="187" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Finite-State Machine" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Finite-State Machine</a> (FSM)</strong>: A sequential logic function consisting of a set of inputs and outputs, a next-state function that maps the current state and the inputs to a new state, and an output function that maps the current state and possibly the inputs to a set of asserted outputs. FSMs are used in control units of CPUs to manage the datapath.</p>
<ul class="has-list-bullet">
<li data-line="188" dir="auto"><span class="list-bullet"></span>The implementation of an FSM usually assumes that any outputs not explicitly asserted are deasserted. Similarly, the control of a datapath makes the same assumption about control signals.</li>
<li data-line="189" dir="auto"><span class="list-bullet"></span>Multiplexer controls are different, since a multiplexer always selects one of the inputs. Therefore, in an FSM, we must specify the setting of all multiplexer controls that we care about.</li>
<li data-line="190" dir="auto"><span class="list-bullet"></span>An FSM can be implemented with a temporary register to hold the current state, and a block of combinational logic that determines both the datapath signals to be asserted and the next state. The combinational control logic for an FSM is implemented with either a ROM (<a data-href="Read-Only Memory" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Read-Only Memory</a>), or a PLA (<a data-href="Programmable Logic Array" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Programmable Logic Array</a>).</li>
<li data-line="191" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two styles of FSMs:
<ul class="has-list-bullet">
<li data-line="192" dir="auto"><span class="list-bullet"></span><strong>Moore Machine</strong>: The output depends only on the current state.</li>
<li data-line="193" dir="auto"><span class="list-bullet"></span><strong>Mealy Machine</strong>: The output depends on the current state and the input.</li>
</ul>
</li>
</ul>
</li>
<li data-line="195" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>multicore multiprocessor</strong> integrates multiple processing cores onto a single physical chip, typically sharing a common physical address space.</p>
<ul class="has-list-bullet">
<li data-line="196" dir="auto"><span class="list-bullet"></span>Caching shared data in such architectures leads to the <strong>cache coherence problem</strong>. Since each processor maintains its own cache, it can result in inconsistencies where different processors view the same memory location differently if not properly managed.</li>
<li data-line="197" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A memory system is <em>coherent</em> if any read of a data item returns the most recently written value of that item. Writes to the same memory location must also be <em>serialized</em>. That is, two writes to the same location by any two processors must appear in the same order by all processors.
<ul class="has-list-bullet">
<li data-line="198" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In a cache coherent multiprocessor, the cache provides both migration and replication of shared data items:
<ul class="has-list-bullet">
<li data-line="199" dir="auto"><span class="list-bullet"></span><strong>Migration</strong>: A data item can be moved to a local cache and used there transparently.</li>
<li data-line="200" dir="auto"><span class="list-bullet"></span><strong>Replication</strong>: When shared data are being simultaneously read, the caches make a copy of the data item in the local cache.</li>
</ul>
</li>
<li data-line="201" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Supporting migration and replication is critical to performance in accessing shared data, therefore, many multiprocessors introduce a hardware protocol to maintain coherent caches.
<ul class="has-list-bullet">
<li data-line="202" dir="auto"><span class="list-bullet"></span>The most popular <em>cache coherence protocol</em> is <strong>snooping</strong>. Each cache that has a copy of the data from a block of physical memory also has a copy of the sharing status of the block, but no centralized state is kept. The caches are all accessible via some broadcast medium (<em>e.g., a bus</em>), and all cache controllers monitor (<em>snoop</em>) on the medium to determine whether they have a copy of a block that is requested on a bus or switch access.</li>
<li data-line="203" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>One method for enforcing coherence is to ensure that a processor has exclusive access to a data item before it writes that item. This is called a <strong>write invalidate protocol</strong> because it invalidates copies in other caches on a write. This ensures that no other readable or writable copies of an item exist when a write occurs, all other cached copies of the item are invalidated.
<ul class="has-list-bullet">
<li data-line="204" dir="auto"><span class="list-bullet"></span>If two processors attempt to write the same data item simultaneously, one of the writes will win the race, causing the other processor's copy to be invalidated. Therefore, this protocol also enforces write serialization.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="205" dir="auto"><span class="list-bullet"></span>The block size also plays an important role in cache coherency. Large blocks can cause <strong>false sharing</strong>, where two unrelated shared variables residing in the same cache block lead to unnecessary cache invalidations. Programmers and compilers should lay out data carefully to avoid false sharing.</li>
</ul>
</li>
<li data-line="207" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="RAID" href=".html" class="internal-link" target="_self" rel="noopener nofollow">RAID</a></strong>: Standing for <em>redundant array of inexpensive/independent disks</em>, RAID is a technology that combines multiple physical secondary storage devices into a single logical unit to improve throughput and data redundancy.</p>
<ul class="has-list-bullet">
<li data-line="208" dir="auto"><span class="list-bullet"></span>The original motivation for RAID was to allow parallel access to secondary storage, thus, improving I/O throughput of a system. The flaw with this argument was that disk arrays could make reliability much worse since the failure rate of an array of disks is much higher than that of a single disk. The solution was to add redundancy so that the system could cope with disk failures without losing information.</li>
<li data-line="209" dir="auto"><span class="list-bullet"></span>Dependability is the reason for the widespread use of RAID today.</li>
<li data-line="210" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are seven stages of RAID:<br>
0. <strong>RAID 0 (No Redundancy)</strong>: Spreads data across multiple disks, called <strong>striping</strong>, without offering any redundancy. Striping allocates logically sequential blocks to separate disks to allow higher I/O performance than a single disk. 
<ol>
<li data-line="212" dir="auto"><strong>RAID 1 (Mirroring)</strong>: <em>Mirrors</em> each disk in the array so that whenever data is written to one disk, it is also written to the corresponding <em>redundant disk</em> for that disk. This RAID level is the most expensive since it requires the most disks.</li>
<li data-line="213" dir="auto"><strong>RAID 2 (Error Detecting and Correcting Code)</strong>: Borrows error detection and correction schemes most often used for memories. This level of RAID has fallen into disuse.</li>
<li data-line="214" dir="auto"><strong>RAID 3 (Bit-Interleaved Parity)</strong>: The cost of higher availability can be reduced to <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></span>, where <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> is the number of disks in a <strong>protection group</strong>. Rather than keeping a complete copy of the original data for each disk, we only need to add enough redundant information so that we can restore the disk content on a failure. Reads or writes go to all disks in the group, with one extra disk to hold the check information in case of a failure. Unlike RAID 1, multiple disks must be read to determine the missing data.</li>
<li data-line="215" dir="auto"><strong>RAID 4 (Block-Interleaved Parity)</strong>: This level uses the same ratio of data disks to check disks as RAID 3, though, the parity is stored as blocks and associated with a set of data blocks. In RAID 3, every access went to all disks, however, some applications prefer smaller accesses, allowing independent accesses to occur in parallel. This is the purpose of RAID levels 4-6. Since error detection information in each sector is checked on reads, "small reads" to each disk can occur independently as long as the minimum access is one sector. Writes, on the other hand, would demand that all disks be accessed to read the rest of the data needed to calculate the new parity, and then write the new parity to disk. The key insight to reducing this overhead is that the parity is simply a sum of information; by watching what bits change when we write the new information, we need only change the corresponding bits on the parity disk.</li>
<li data-line="216" dir="auto"><strong>RAID 5 (Distributed Block-Interleaved Parity)</strong>: One drawback to RAID 4 is that the parity disk must be updated on each write, so the parity disk is the bottleneck for back-to-back writes. RAID 5 addresses this issue by spreading the parity information throughout all the disks. This allows multiple writes to occur simultaneously as long as the parity blocks are not located on the same disk.</li>
<li data-line="217" dir="auto"><strong>RAID 6 (P + Q Redundancy)</strong>: Generalizes parity to have a second calculation over the data and another check disk of information. This second check block allows recovery from a second failure. Thus, the storage overhead is twice that of RAID 5.</li>
</ol>
</li>
</ul>
</li>
<li data-line="219" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Some common fallacies regarding the memory hierarchy are:</p>
<ul class="has-list-bullet">
<li data-line="220" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Fallacy</strong>: Programmers can ignore the memory hierarchy when writing applications.
<ul class="has-list-bullet">
<li data-line="221" dir="auto"><span class="list-bullet"></span>Programmers can significantly improve the performance of their code if they factor in the behavior of the memory hierarchy in their algorithms.</li>
</ul>
</li>
<li data-line="222" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Pitfall</strong>: Having less set associativity for a shared cache than the number of cores or threads sharing that cache.
<ul class="has-list-bullet">
<li data-line="223" dir="auto"><span class="list-bullet"></span>Without additional care, a parallel program running on <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> processors or threads can allocate data structures to addresses that would map to the same set of a shared L2 cache. If the cache is at least <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span>-way set associative, then these accidental conflicts are hidden by the hardware from the program. If not, performance bugs due to L2 conflict misses can occur.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Ch.6 Parallel Processors from Client to Cloud" dir="auto" class="heading" id="Ch.6_Parallel_Processors_from_Client_to_Cloud_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Ch.6 Parallel Processors from Client to Cloud</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>A <strong>multicore multiprocessor</strong> integrates multiple processing cores onto a single physical chip. Hence, processors are called <em>cores</em> in a multicore chip. These multicore multiprocessors are almost always <strong>Shared Memory Processors (SMP)</strong>, as they usually share a single physical address space.</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Energy consumption has emerged as a critical issue for both microprocessors and data centers, primarily due to the <strong>power wall</strong> concept, which highlights how the performance capabilities of new processors are limited by the power consumption and heat generation they produce.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Some designs support operation in the presence of broken hardware. That is, if a single processor fails, the remaining processors can continue to provide service, hence, improving availability.</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>High performance can refer to greater throughput for independent tasks, called <strong>task-level parallelism</strong>. This approach contrasts with running a single job on multiple processors. A program capable of running on multiple processors simultaneously is a <strong>parallel processing program</strong>.</li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Hardware can be either:</p>
<ol>
<li data-line="6" dir="auto"><strong>Serial</strong>: Data is transmitted one bit at a time over a single channel.</li>
<li data-line="7" dir="auto"><strong>Parallel</strong>: Multiple data bits are transmitted simultaneously over multiple channels.</li>
</ol>
</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Software can either be:</p>
<ol>
<li data-line="10" dir="auto"><strong>Sequential</strong>: Tasks are executed one after the other in a linear order.</li>
<li data-line="11" dir="auto"><strong>Concurrent</strong>: Multiple tasks can be running simultaneously across multiple processors.</li>
</ol>
</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The main challenge of the parallel revolution in hardware is making naturally sequential software have high performance on parallel hardware, but also to make concurrent programs have high performance as the number of parallel processors increase.</p>
<ul class="has-list-bullet">
<li data-line="14" dir="auto"><span class="list-bullet"></span>To create an efficient concurrent program, the task must be broken into equal-sized pieces, to ensure that no one processor is doing a bulk of the work while the others remain idle. Another obstacle is the fact that the processors may spend a great deal of time communicating and synchronizing with each other instead of performing meaningful work. Amdahl’s law also reminds us that even small parts of a program must be parallelized if the program is to make good use of many cores.</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two ways to speed-up performance of a concurrent program:
<ul class="has-list-bullet">
<li data-line="16" dir="auto"><span class="list-bullet"></span><strong>Strong Scaling</strong>: Speed-up achieved on a multiprocessor without increasing the size of the problem.</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span><strong>Weak Scaling</strong>: Speed-up achieved on a multiprocessor while increasing the size of the problem proportionally to the increase in the number of processors.</li>
</ul>
</li>
<li data-line="18" dir="auto"><span class="list-bullet"></span>The <strong>memory hierarchy</strong> can interfere with the intuitive wisdom about weak scaling being easier than small scaling. If the problem size grows too large relative to the available memory, performance may suffer due to increased latency and cache misses.</li>
</ul>
</li>
<li data-line="20" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>A conventional <em>uniprocessor</em> has a single instruction stream and a single data stream. A conventional multiprocessor has multiple instruction streams and multiple data streams. These two categories are abbreviated <strong>SISD</strong> and <strong>MIMD</strong> respectively.</p>
<ul class="has-list-bullet">
<li data-line="21" dir="auto"><span class="list-bullet"></span>Programmers normally write a single program that runs on all processors of a MIMD computer, relying on conditional statements when different processors should execute distinct sections of code. This style is called <strong>single program multiple data (SPMD)</strong>, but it's just the normal way to program a MIMD computer.</li>
<li data-line="22" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A <strong>single instruction multiple data (SIMD)</strong> computer operates on vectors of data. For example, a single SIMD instruction may add 64 numbers by sending 64 data streams to 64 ALUs to form 64 sums in a single clock cycle.
<ul class="has-list-bullet">
<li data-line="23" dir="auto"><span class="list-bullet"></span>The advantages of SIMD are that all parallel execution units are synchronized, and they all respond to a single instruction that stems from a single program counter (PC).</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>Although, every unit is executing the same instruction, each execution unit has its own address registers, and so each unit can have different data addresses. For  parallelism to work in SIMD, there must be a great deal of identically structured data, which is called <strong>data-level parallelism</strong>: that is, parallelism achieved by performing the same operation on multiple independent data.</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>An older interpretation of SIMD is called a <strong>vector architecture</strong>. Rather than having 64 ALUs perform 64 additions simultaneously, the vector architectures pipelined the ALU to get good performance at lower cost. The basic philosophy is to collect data elements from memory, put them in order into a large set of registers called <strong>vector registers</strong>, operate on them sequentially in registers using <strong>pipelined execution units</strong>, and then write the results to memory. Thus, a vector architecture may have 32 vector registers, each with 64 64-bit elements.
<ul class="has-list-bullet">
<li data-line="26" dir="auto"><span class="list-bullet"></span>RISC-V offers the vector extension <code>V</code> with vector instructions and vector registers. Vector instructions use the same names, but with the prefix <code>v</code> appended.</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>Pipeline stalls occur less frequently on vector architectures since they are required only once per vector <em>operation</em>, rather than once per vector <em>element</em>.</li>
<li data-line="28" dir="auto"><span class="list-bullet"></span>All modern vector computers have vector functional units with multiple parallel pipelines called <strong>vector lanes</strong>.</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Vector instructions have several important properties compared to conventional ISAs, which are called  <strong>scalar architectures</strong> in this context:
<ul class="has-list-bullet">
<li data-line="30" dir="auto"><span class="list-bullet"></span>A single vector instruction specifies a great deal of work, it is equivalent to executing an entire loop. Thus, the instruction fetch and decode bandwidth needed is dramatically reduced.</li>
<li data-line="31" dir="auto"><span class="list-bullet"></span>By using a vector instruction, the compiler indicates that the computation of each result in the vector is independent of other results in the same vector, so hardware does not have to check for data hazards within a vector instruction.</li>
<li data-line="32" dir="auto"><span class="list-bullet"></span>Hardware need only check for data hazards between two vector instructions once per vector operand, not once per vector element.</li>
<li data-line="33" dir="auto"><span class="list-bullet"></span>Vector instructions that access memory have a known <em>access pattern</em>. If the vector's elements are all adjacent, then fetching the vector from a set of heavily interleaved memory banks works very well.</li>
<li data-line="34" dir="auto"><span class="list-bullet"></span>Because a complete loop is replaced by a vector instruction whose behavior is predetermined, control hazards that would normally arise from the loop branch are non-existent.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="36" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Hardware Multithreading" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Hardware Multithreading</a></strong>: Allows multiple <strong>threads</strong> to share the functional units of a single processor in an overlapping fashion to increase hardware utilization. To permit this sharing, the processor must duplicate the independent state of each thread, such as the register file and program counter. The memory itself is shared through virtual memory mechanisms.</p>
<ul class="has-list-bullet">
<li data-line="37" dir="auto"><span class="list-bullet"></span>The hardware must support the ability to change to a different thread quickly. A thread switch should be much more efficient than a process switch, which typically requires hundreds to thousands of processor cycles, while a thread switch can be instantaneous.</li>
<li data-line="38" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two main approaches to hardware multithreading:
<ol>
<li data-line="39" dir="auto"><strong>Fine-Grained Multithreading</strong>: Switches between threads on each instruction, resulting in interleaved execution of multiple threads. This is typically done in a round-robin fashion, skipping any threads that are currently stalled.</li>
<li data-line="40" dir="auto"><strong>Coarse-Grained Multithreading</strong>: Switches between threads only on expensive stalls, such as last-level cache misses. This change relieves the need to have thread switching be extremely fast. The main drawback of coarse-grained multithreading is that it is limited in its ability to overcome throughput losses, especially from shorter stalls. This limitation arises from the pipelines start-up costs of coarse-grained multithreading: when a stall occurs, the pipeline must be emptied or frozen. The new thread that begins executing after the stall must fill the pipeline before instructions are able to complete.</li>
</ol>
</li>
<li data-line="41" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Simultaneous multithreading (SMT)</strong> is a variation on hardware multithreading that uses the resources of a multiple-issue, dynamically scheduled pipelined processor to exploit thread-level parallelism while it exploits instruction-level parallelism. The key insight is that multiple-issue processors often have more functional unit parallelism available than most single threads can use. Furthermore, with register renaming and dynamic scheduling, multiple instructions from independent threads can be issued without regard to the dependencies among them; the resolution of the dependencies can be handled by the dynamic scheduling capability.
<ul class="has-list-bullet">
<li data-line="42" dir="auto"><span class="list-bullet"></span>Since SMT relies on the existing dynamic mechanisms, it does not switch resources every cycle. Rather, SMT is always executing instructions from multiple threads, leaving it up to the hardware to associate instruction slots and renamed registers with their proper threads.</li>
</ul>
</li>
</ul>
</li>
<li data-line="44" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Given the difficulty of rewriting old programs to run efficiently on parallel hardware, computer designers have attempted to make the task simpler for application developers.</p>
<ul class="has-list-bullet">
<li data-line="45" dir="auto"><span class="list-bullet"></span>One solution was to provide a single physical address space that all processors can share, so that programs need not concern themselves with where their data are, merely that programs may be executed in parallel. Such processors are called <strong>shared memory multiprocessors (SMP)</strong>. In this approach, all variables of a program can be made available at any time to any processor. The alternative is to have a separate address space for each processor that requires that sharing be done explicitly. When the physical address space is common, the hardware typically provides cache coherence to give a consistent view of shared memory. Such systems can run independent jobs in their own virtual address spaces, even if they all share a physical address space.</li>
</ul>
</li>
<li data-line="47" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>There are two styles of SMPs:</p>
<ol>
<li data-line="48" dir="auto"><strong>Uniform Memory Access (UMA)</strong>: The latency to a word in memory does not depend on which processor is requesting it.</li>
<li data-line="49" dir="auto"><strong><a data-href="Non-Uniform Memory Access" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Non-Uniform Memory Access</a> (NUMA)</strong>: Some memory accesses are much faster than others, depending on which processor asks for which word, typically because main memory is divided and attached to different processors or to different memory controllers on the same chip.</li>
</ol>
</li>
<li data-line="51" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>As processors operating in parallel will typically share data, they also need to coordinate when operating on shared data. This coordination is called <strong>synchronization</strong>.</p>
<ul class="has-list-bullet">
<li data-line="52" dir="auto"><span class="list-bullet"></span>One approach uses a <strong>lock</strong> for a shared variable. Only one processor at a time can acquire the lock, and other processors attempting to access the shared data must wait until the original processor unlocks the variable.</li>
</ul>
</li>
<li data-line="54" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="OpenMP" href=".html" class="internal-link" target="_self" rel="noopener nofollow">OpenMP</a></strong>: A parallel programming API, along with a set of compiler directives, environment variables, and runtime library routines that extends standard programming languages. Most C compilers already have support for OpenMP.</p>
<ul class="has-list-bullet">
<li data-line="55" dir="auto"><span class="list-bullet"></span>OpenMP extends C using <strong>pragmas</strong>, which are just commands to the C preprocessor such as <code>#define</code>.</li>
</ul>
</li>
<li data-line="57" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Graphics Processing Unit" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Graphics Processing Unit</a> (GPU)</strong>: A processor specialized for graphics processing, designed to render graphics and perform complex calculations in parallel.</p>
<ul class="has-list-bullet">
<li data-line="58" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Some of the main ways that GPUs differ from CPUs are:
<ul class="has-list-bullet">
<li data-line="59" dir="auto"><span class="list-bullet"></span>GPUs are accelerators that supplement a CPU, so they don't need to be able to perform all the tasks of a CPU.</li>
<li data-line="60" dir="auto"><span class="list-bullet"></span>The GPU problem sizes are typically hundreds of megabytes to gigabytes, rather than hundreds of gigabytes to terabytes.</li>
<li data-line="61" dir="auto"><span class="list-bullet"></span>GPUs do not rely on multilevel caches to overcome the long latency to memory, like CPUs do. Instead, GPUs rely on hardware multithreading to hide memory latency. That is, between the time of a memory request and the time that data arrive, the GPU executes hundreds or thousands of threads that are independent of that request.</li>
<li data-line="62" dir="auto"><span class="list-bullet"></span>GPU memory is thus oriented towards bandwidth rather than latency. There exist special graphics DRAM chips for GPUs that are wider and have higher bandwidth.</li>
<li data-line="63" dir="auto"><span class="list-bullet"></span>Given the reliance on many threads to deliver good memory bandwidth, GPUs can accommodate many parallel processors (MIMD) as well as many threads. Hence, each GPU processor is more highly multithreaded than a typical CPU, and they have more processors.</li>
</ul>
</li>
<li data-line="64" dir="auto"><span class="list-bullet"></span>Like vector architectures, GPUs only work well with data-level parallel problems. Both styles have gather-scatter data transfers, and GPU processors have even more registers than vector processors. Unlike most vector architectures, GPUs also rely on hardware multithreading within a single multithreaded SIMD processor to hide memory latency.</li>
<li data-line="65" dir="auto"><span class="list-bullet"></span>A multithreaded SIMD processor is similar to a vector processor, but rather than having many parallel functional units, a multithreaded SIMD processor has just a few functional units that are deeply pipelined. A GPU is a MIMD composed of these multithreaded SIMD processors.</li>
</ul>
</li>
<li data-line="67" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="CUDA" href=".html" class="internal-link" target="_self" rel="noopener nofollow">CUDA</a></strong>: A C-inspired programming language by NVIDIA that enables programmers to write C programs that can execute directly on GPUs, albeit with some restrictions.</p>
<ul class="has-list-bullet">
<li data-line="68" dir="auto"><span class="list-bullet"></span>A CUDA <em>thread</em> is the smallest unit of execution within the CUDA programming model. The hardware can group thousands of CUDA threads together to utilize the various styles of parallelism within a GPU: multithreading, MIMD, SIMD, and instruction-level parallelism. These threads are blocked together and executed in groups of 32 at a time. A multithreaded processor inside a GPU executed these blocks of threads, and a GPU consists of 8-128 of these multithreaded processors.</li>
</ul>
</li>
<li data-line="70" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>In the NVIDIA Fermi architecture, the Thread Block Scheduler hardware assigns blocks oaf threads to multithreaded SIMD processors.</p>
<ul class="has-list-bullet">
<li data-line="71" dir="auto"><span class="list-bullet"></span>The machine object that the hardware creates, manages, schedules, and executes is a <em>thread of SIMD instructions</em>, which we will call a <strong>SIMD thread</strong>. It is a traditional thread, though it contains only SIMD instructions. The <em>SIMD Thread Scheduler</em> includes a controller that lets it know which threads of SIMD instructions are ready to run, and then it sends them off to the dispatch unit to be run on the multithreaded SIMD processor. This is identical to a hardware thread scheduler in a traditional multithreaded processor, except it is scheduling threads of SIMD instructions.</li>
<li data-line="72" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Therefore, GPU hardware has two levels of hardware schedulers:
<ol>
<li data-line="73" dir="auto">The <strong>Thread Block Scheduler</strong> that assigns blocks of threads to multithreaded SIMD processors.</li>
<li data-line="74" dir="auto">The <strong>SIMD Thread Scheduler</strong> within a SIMD processor, which schedules when SIMD threads should run.'</li>
</ol>
</li>
<li data-line="75" dir="auto"><span class="list-bullet"></span>The SIMD instructions of these threads are 32 wide, so each thread of SIMD instructions would compute 32 of the elements of the computation. Since the thread consists of SIMD instructions, the SIMD processor must have parallel functional units, called <strong>SIMD Lanes</strong>, to perform the operation.</li>
<li data-line="76" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The on-chip memory local to each multithreaded SIMD processor is called <em>local memory</em>. It is shared by the SIMD lanes within the processor, but not between the distinct multithreaded SIMD processors. An off-chip DRAM, called <em>GPU memory</em> is shared by the whole GPU and all thread blocks.
<ul class="has-list-bullet">
<li data-line="77" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Rather than use large caches to contain the working set of an application, GPUs typically use smaller streaming caches and rely on the extensive multithreading of threads of SIMD instructions to hide the long DRAM memory latency. Thus, the chip area used for caches in system processors is spent instead on computing resources and on the large number of registers to hold the state of the many threads of SIMD instructions.
<ul class="has-list-bullet">
<li data-line="78" dir="auto"><span class="list-bullet"></span>The latest GPUs and vector processors have added caches to reduce demands on GPU memory and accelerate accesses for the few variables whose latency cannot be hidden by multithreading.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="80" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The combination of the slowdown of Moore's Law, the end of Dennard scaling, and the practical limitations on multicore performance due to Amdahl's Law has shifted the focus of computer architects towards creating <strong>domain-specific architectures (DSAs)</strong>. DSAs do only a narrow <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/range.html#_0" target="_self" rel="noopener noreferrer" from="24" to="29" origin-text="range" class="internal-link virtual-link-a">range</a></span> of tasks, but they do them extremely well.</p>
<ul class="has-list-bullet">
<li data-line="81" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>DSAs follow five principles:
<ol>
<li data-line="82" dir="auto">Use dedicated memories to minimize the distance over which data are moved. The compiler writers and programmers of DSAs understand their domain, so there is no need for hardware to try to move data for them. Instead, data movement is reduced with software-controlled memories tailored for specific functions within the domain.</li>
<li data-line="83" dir="auto">Invest the resources saved from dropping advanced micro-architectural optimizations into more arithmetic units or bigger memories. Resource-intensive optimizations include out-of-order execution, speculation, multithreading, multiprocessing, pre-fetching, and multilevel caches.</li>
<li data-line="84" dir="auto">Use the easiest form of parallelism that matches the domain. Target domains almost always have inherent parallelism. The goal is to design the DSA around the natural granularity of the parallelism of the domain and expose that parallelism simply in the programming model.</li>
<li data-line="85" dir="auto">Reduce data size and type to the simplest required for the domain. Applications in many domains are memory-bound, so you can increase the effective memory bandwidth and on-chip memory utilization by using narrower data types.</li>
<li data-line="86" dir="auto">Use a domain-specific programming language to port code to the DSA. Examples include Halide for vision processing and TensorFlow for <a data-href="Machine Learning" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Machine Learning</a>.</li>
</ol>
</li>
<li data-line="87" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Examples of domains that have been accelerated via DSAs include graphics, bioinformatics, image processing, simulation, and <a data-href="Artificial Intelligence" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Artificial Intelligence</a> (AI).
<ul class="has-list-bullet">
<li data-line="88" dir="auto"><span class="list-bullet"></span>Google's tensor processing unit (TPU), called the TPUv1, is an example of a DSA made for computing <a data-tooltip-position="top" aria-label="Neural Network" data-href="Neural Network" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Deep Neural Networks</a> (DNNs).</li>
</ul>
</li>
</ul>
</li>
<li data-line="90" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The alternative to sharing a common address space is for the processors to each have their own private physical address space.</p>
<ul class="has-list-bullet">
<li data-line="91" dir="auto"><span class="list-bullet"></span>This alternative multiprocessor must communicate using explicit <strong>message passing</strong>. Providing the system has routines to <strong>send</strong> and <strong>receive</strong> messages, coordination is built-in with message passing, since one processor knows when a message is sent, and the receiving processor knows when a message arrives. Additionally, the receiving processor can send an <strong>acknowledgement</strong> message back to the sender.</li>
<li data-line="92" dir="auto"><span class="list-bullet"></span><strong>Clusters</strong> are collections of computers connected via I/O over standard network switches to form a message-passing multiprocessor. Given the separate memories, each <em>node</em> of a cluster runs a distinct copy of the OS. Clusters improve system dependability since it is much easier to replace a computer without bringing down the system in a cluster than in a shared memory multiprocessor.</li>
<li data-line="93" dir="auto"><span class="list-bullet"></span>A <strong>Warehouse-Scale Computer (WSC)</strong> is essentially a large cluster, though, their architecture and operation are more sophisticated. These computers require the construction of new buildings, as well electrical, networking, and cooling infrastructure.</li>
</ul>
</li>
<li data-line="95" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Multicore chips require on-chip networks to connect cores together, and clusters require local area networks (LANs) to connect nodes together.</p>
<ul class="has-list-bullet">
<li data-line="96" dir="auto"><span class="list-bullet"></span>Network costs include the number of switches, the number of links on a switch to connect to the network, the width (<em>in bits</em>) per link, and length of the links when the network is mapped into silicon.</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span>Network performance includes the latency on an unloaded network to send and receive messages, the throughput in terms of the maximum number of messages that can be transmitted in a given time period, delays caused by contention, and variable performance depending on the pattern of communication.</li>
<li data-line="98" dir="auto"><span class="list-bullet"></span>Fault tolerance is also an obligation of the network, since systems may be required to operate in the presence of broken components. Energy efficiency has also emerged as a significant concern. Networks must be designed to minimize energy consumption without sacrificing performance.</li>
<li data-line="99" dir="auto"><span class="list-bullet"></span>Networks are normally drawn as graphs, where each edge of the graph represents a link of the communication network. Links can be bidirectional or unidirectional. All networks consist of <em>switches</em> whose links go to processor-memory nodes and to other switches.</li>
<li data-line="100" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A simple network topology, called the <strong>ring topology</strong> is depicted below: <span alt="ringTop.png" src="resources/ringtop.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="ringTop.png" src="resources/ringtop.png" target="_self"></span>
<ul class="has-list-bullet">
<li data-line="101" dir="auto"><span class="list-bullet"></span>Here, processor-memory node is represented as a black square, with switches depicted as blue circles. Since some nodes are not directly connected, some messages will have to hop along intermediate nodes until they arrive at their destination. Unlike a bus, a ring is capable of many simultaneous transfers.</li>
</ul>
</li>
<li data-line="102" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Because there are numerous topologies to choose from, the following performance metrics can be used to compare each design:
<ul class="has-list-bullet">
<li data-line="103" dir="auto"><span class="list-bullet"></span><strong>Total network bandwidth</strong> is the bandwidth of each link, multiplied by the number of links. This represents the peak bandwidth. For a ring network with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> processors, the total network bandwidth is <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> times the bandwidth of one link. For a bus network, the total network bandwidth is simply the bandwidth of the bus.</li>
<li data-line="104" dir="auto"><span class="list-bullet"></span>The <strong>bisection bandwidth</strong> is calculated by dividing the network into two halves. Then you sum the bandwidth of the links that cross the imaginary dividing line. The bisection bandwidth of a ring is twice the link bandwidth. Since some networks are not symmetric, the choice of where to draw the line is to choose a division that yields the most pessimistic network performance.</li>
</ul>
</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A <strong>fully-connected network</strong> is at the other extreme from a ring topology. Here, every processor has a bidirectional link to every other processor. The total network bandwidth is <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></span>, and the bisection bandwidth is <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container></span>.
<ul class="has-list-bullet">
<li data-line="106" dir="auto"><span class="list-bullet"></span>The tremendous improvement in performance of fully-connected networks is compensated by its tremendous increase in cost. This consequence has inspired engineers to invent new topologies that are between the cost of rings and the performance of fully-connected networks.</li>
</ul>
</li>
<li data-line="107" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>An alternative to placing a processor at every node in a network is to leave only the switch at some of these nodes. The switches are smaller than processor-memory nodes, and thus, may be packed more densely. Such networks are called <strong>multistage networks</strong>.
<ul class="has-list-bullet">
<li data-line="108" dir="auto"><span class="list-bullet"></span>A <strong>crossbar network</strong> is a type of multistage network where any node can communicate with any other node in one pass through the network. A crossbar network is depicted below:<span alt="crossbarNetwork.png" src="resources/crossbarnetwork.png" class="internal-embed media-embed image-embed is-loaded" target="_self" style="width: 400px; max-width: 100%;"><img alt="crossbarNetwork.png" src="resources/crossbarnetwork.png" target="_self" style="width: 400px; max-width: 100%;"></span></li>
</ul>
</li>
<li data-line="109" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Additional practical considerations in the construction of a network include the distance of each link, which affects the cost of communicating at a high clock rate. Shorter distances also make it easier to assign more wires to the link, and shorter wires are cheaper than longer wires.
<ul class="has-list-bullet">
<li data-line="110" dir="auto"><span class="list-bullet"></span>Another consideration is that the three-dimensional network diagrams must be mapped onto two-dimensional chips.</li>
<li data-line="111" dir="auto"><span class="list-bullet"></span>The final concern is energy. Energy concerns may force multicore chips to to rely on simple grid topologies.</li>
<li data-line="112" dir="auto"><span class="list-bullet"></span>The bottom line is that topologies that seem elegant on paper may be impractical when constructed in silicon or in a data-center.</li>
</ul>
</li>
</ul>
</li>
<li data-line="114" dir="auto"><span class="list-bullet"></span>
<p><a data-href="Ethernet" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Ethernet</a> has dominated LAN networking for decades, thus, clusters primarily rely on Ethernet as the cluster interconnect. Today, 10 Gigabits/second Ethernet is standard, with 100 Gigabit/second Ethernet being deployed in data-centers.</p>
</li>
<li data-line="116" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Peripheral Component Interconnect Express (<a data-href="PCIe" href=".html" class="internal-link" target="_self" rel="noopener nofollow">PCIe</a>)</strong>: A high-speed interface standard used for connecting components such as GPUs and network cards to a computer's motherboard. PCIe connections are made up of <em>lanes</em>, with each lane consisting of two wires: one for sending data, and one for receiving data.</p>
<ul class="has-list-bullet">
<li data-line="117" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>PCIe can be used to connect a network interface card (NIC) to a host. To communicate, a NIC must both send and receive messages, often abbreviated as TX (<em>transmit</em>) and RX (<em>receive</em>) respectively.
<ul class="has-list-bullet">
<li data-line="118" dir="auto"><span class="list-bullet"></span>To give a command to the NIC, the processor must be able to address the device and to supply one or more command words. One scheme is called <strong><a data-href="Memory-Mapped I/O" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Memory-Mapped I/O</a></strong>. In memory-mapped I/O, portions of the address space are assigned to I/O devices and all subsequent reads and writes to that address region are forwarded over PCIe to that device. At boot time, PCIe devices can request to be assigned an address region of a specified length.</li>
<li data-line="119" dir="auto"><span class="list-bullet"></span>User programs are not permitted to issue I/O operations directly because the OS does not provide access to the address space assigned to I/O devices.</li>
</ul>
</li>
<li data-line="120" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>While the processor could transfer the data from user space into the I/O space by itself, the overhead of such operations could be intolerable. Thus, computer designers invented a mechanism, called <strong><a data-href="Direct Memory Access" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Direct Memory Access</a> (DMA)</strong>, for offloading the processor and having the device controller transfer directly to or from memory.
<ul class="has-list-bullet">
<li data-line="121" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To notify the OS that a transfer is complete, the DMA sends an I/O <strong>interrupt</strong>. An I/O interrupt is just like the exceptions from Chapters 4 and 5, with two distinctions:
<ol>
<li data-line="122" dir="auto">An I/O interrupt is asynchronous with respect to the instruction execution. That is, the interrupt is not associated with any instructions and does not prevent the instruction completion. The control unit needs only to check for a pending I/O interrupt at the time it starts a new instruction.</li>
<li data-line="123" dir="auto">In addition to the fact that an I/O interrupt has occurred, we would like to convey further information, such as the identity of the device that generated the interrupt. Furthermore, the interrupts represent devices that may have different priorities and whose interrupt requests have different urgencies associated with them.</li>
</ol>
</li>
<li data-line="124" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>To communicate information to the processor, such as the identity of the interrupting device, a system can use either vectored interrupts or an exception identification register, called the <strong>supervisor exception cause (SCAUSE)</strong> register in RISC-V.
<ul class="has-list-bullet">
<li data-line="125" dir="auto"><span class="list-bullet"></span>When the processor recognizes the interrupt, the device can send either the vector address or a status field to place in the Cause register. When the OS gets control, it knows the identity of the device that caused the interrupt and can immediately <em>interrogate</em> the device. The interrupt mechanism relieves the processor of the need to constantly check the device.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="127" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The operating system (OS) acts as the interface between the hardware, and the program that requests I/O.</p>
<ul class="has-list-bullet">
<li data-line="128" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The networking responsibilities of the OS arise from three characteristics of networks:
<ol>
<li data-line="129" dir="auto">Multiple programs using the processor to share the network.</li>
<li data-line="130" dir="auto">Networks often use interrupts to communicate information about the operations. Since interrupts cause a transfer to kernel <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/mode.html#_0" target="_self" rel="noopener noreferrer" from="123" to="127" origin-text="mode" class="internal-link virtual-link-a">mode</a></span>, they must be handled by the OS.</li>
<li data-line="131" dir="auto">The low-level control of a network is complex, because it requires managing a set of concurrent events and because the requirements for correct device control are often very detailed.</li>
</ol>
</li>
<li data-line="132" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>These three characteristics lead to several functions the OS must provide:
<ul class="has-list-bullet">
<li data-line="133" dir="auto"><span class="list-bullet"></span>The OS guarantees that a user's program accesses only the portions of I/O device to which the user has rights.</li>
<li data-line="134" dir="auto"><span class="list-bullet"></span>The OS provides abstractions for accessing devices by supplying routines that handle low-level device operations.</li>
<li data-line="135" dir="auto"><span class="list-bullet"></span>The OS handles the interrupts generated by I/O devices, just as it handles exceptions generated by programs.</li>
<li data-line="136" dir="auto"><span class="list-bullet"></span>The OS tries to provide equitable access to the shared I/O resources, as well as schedules accesses to enhance system throughput.</li>
</ul>
</li>
<li data-line="137" dir="auto"><span class="list-bullet"></span>The software inside the OS that interfaces to a specific I/O device is called a <strong>device driver</strong>.</li>
</ul>
</li>
<li data-line="139" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The importance of networking in clusters means it is certainly worthwhile to try to improve network performance.</p>
<ul class="has-list-bullet">
<li data-line="140" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Starting with software optimizations:
<ul class="has-list-bullet">
<li data-line="141" dir="auto"><span class="list-bullet"></span>The zero-copy optimization allows the DMA engine to get the message directly from the user program data space during transmission and be placed where the user wants it when the message is received, rather than pass through the intermediary buffers in the OS along the way.</li>
<li data-line="142" dir="auto"><span class="list-bullet"></span>A second software optimization is to cut out the OS almost entirely by moving the communication into the user address space. By not invoking the operating system and not causing a context switch, we can considerably reduce the software overhead.</li>
<li data-line="143" dir="auto"><span class="list-bullet"></span>A third optimization would be to drop interrupts. One reason is that modern processors often go into low-power mode while waiting for an interrupt, and it takes time to come out of low-power mode to service the interrupt, which increases latency. The alternative to interrupts is for the processor to periodically check status bits to see if an I/O operation is complete, which is called <strong>polling</strong>.</li>
</ul>
</li>
<li data-line="144" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Hardware optimizations include:
<ul class="has-list-bullet">
<li data-line="145" dir="auto"><span class="list-bullet"></span>One potential target for improvement is in calculating the values of the fields of the Ethernet packet. The 48-bit Ethernet address, called the <strong>Media Access Control (MAC)</strong> address, is a unique number assigned to each Ethernet NIC. To improve performance, the <em>MAC chip</em>, actually just a portion of the <a data-tooltip-position="top" aria-label="Field-Programmable Gate Array" data-href="Field-Programmable Gate Array" href=".html" class="internal-link" target="_self" rel="noopener nofollow">FPGA</a> on the NIC, calculates the value for the preamble fields and the CRC field. The driver is left with placing the MAC destination address, MAC source address, message type, the data payload, and padding if needed. Even the least expensive Ethernet NICs do CRC calculation in hardware today.</li>
<li data-line="146" dir="auto"><span class="list-bullet"></span>Another hardware optimization improves the performance of the NIC with respect to the memory hierarchy. <strong>Data Direct I/O (DDIO)</strong> enables the use of up to 10% of the last-level cache as a fast scratchpad for the DMA engine. Data are copied directly into the last-level cache rather than to DRAM by the DMA engine, and only written to DRAM upon eviction from the cache. This optimization improves latency and bandwidth. DDIO offers similar benefits to those of a write-back cache versus a write-through cache.</li>
</ul>
</li>
</ul>
</li>
<li data-line="148" dir="auto"><span class="list-bullet"></span>
<p>While <a data-href="Ethernet" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Ethernet</a> is the foundation of cluster communication, clusters commonly use higher-level protocols for reliable communication. The <strong>Transmission Control Protocol and Internet Protocol (<a data-href="TCP/IP" href=".html" class="internal-link" target="_self" rel="noopener nofollow">TCP/IP</a>)</strong>, although intended for planet-wide communication, is often used inside a warehouse-scale computer, due in part to its dependability.</p>
</li>
<li data-line="150" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Benchmarks</strong> are standardized tests used to evaluate the performance of a computer system. A typical rule is that you can't change the benchmark, including the source code and data sets. Furthermore, the benchmark has a single proper answer. A common exception is to be able to increase the size of the problem so that you can run the benchmark on systems with different numbers of processors. That is, many benchmarks permit weak scaling, rather than require strong scaling.</p>
<ul class="has-list-bullet">
<li data-line="151" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The downside of such restrictions is that innovation is chiefly limited to the architecture and compiler. Better data structures, algorithms, programming languages, and so on often cannot be used. While these guidelines are understandable when the foundations of computing are relatively stable, they are undesirable during a programming revolution.
<ul class="has-list-bullet">
<li data-line="152" dir="auto"><span class="list-bullet"></span>Researchers at the University of California at Berkeley identified 13 <em>design patterns</em> that they claim will be part of applications of the future. Examples are sparse matrices, structured grids, finite-state machines, map reduce, and graph traversal. By keeping these definitions at a high level, they hope to encourage innovations at all levels of the system.</li>
</ul>
</li>
<li data-line="153" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Some common parallel benchmarks include:
<ul class="has-list-bullet">
<li data-line="154" dir="auto"><span class="list-bullet"></span><strong>Linpack</strong>: A collection of linear algebra routines, and the routines for performing Gaussian elimination. Linpack allows weak scaling.</li>
<li data-line="155" dir="auto"><span class="list-bullet"></span><strong>SPECrate</strong>: A throughput metric based on the SPEC CPU benchmarks. Rather than report performance of the individual programs, SPECrate runs many copies of the program simultaneously. Thus, it measures task-level parallelism.</li>
</ul>
</li>
</ul>
</li>
<li data-line="157" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Performance models</strong> are computational frameworks used to analyze the performance characteristics of systems. The 3Cs for cache performance is an example of a performance model.</p>
<ul class="has-list-bullet">
<li data-line="158" dir="auto"><span class="list-bullet"></span>To find such a model for parallel computers, we can start with small kernels, such as the 13 Berkeley design patterns. Floating-point is a popular data type to use for such kernels. Hence, peak floating-point performance is a limit on the speed of such kernels on a given computer. For multicore chips, peak floating-point performance is the collective peak performance of all cores on the chip.</li>
<li data-line="159" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The demands on the memory system can be estimated by dividing this peak floating-point performance by the average number of floating-point operations per byte accessed:
<ul class="has-list-bullet">
<li data-line="160" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45C TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span></li>
<li data-line="161" dir="auto"><span class="list-bullet"></span>The ration of floating-point operations per byte of memory accessed is called the <strong>arithmetic intensity</strong>. The figure below illustrates the arithmetic intensity of several of the Berkeley design patterns:<span alt="designPatternsAI.png" src="resources/designpatternsai.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="designPatternsAI.png" src="resources/designpatternsai.png" target="_self"></span></li>
</ul>
</li>
<li data-line="162" dir="auto"><span class="list-bullet"></span>The <strong>roofline model</strong> is a simple model which ties floating-point performance, arithmetic intensity, and memory performance together in a 2D graph. The horizontal axis is arithmetic intensity, and the vertical axis is floating-point performance.</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Appendix A: The Basics of Logic Design" dir="auto" class="heading" id="Appendix_A_The_Basics_of_Logic_Design_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Appendix A: The Basics of Logic Design</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>The electronics inside a computer are <strong>digital</strong>. Digital electronics operate at two voltage levels: a high and low voltage. </p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Rather than refer to voltage levels, we talk about signals that are either <em>logically</em> true (1), or are <strong>asserted</strong>; or signals that are <em>logically</em> false (0), or are <strong>deasserted</strong>.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Logic blocks without any memory are called <strong>combinational logic</strong>. The output of a combinational block depends only on the current input.</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>In blocks with memory, the outputs can depend on the inputs, as well as the current values stored in memory, which is called the <em>state</em> of the block. Such blocks are called <strong>sequential logic</strong>.</li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Truth Table" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Truth Table</a></strong>: A table used in digital logic to represent the output values of a logical expression (<em>or block</em>) based on all possible combinations of input values.</p>
<ul class="has-list-bullet">
<li data-line="6" dir="auto"><span class="list-bullet"></span>Since combinational logic contains no memory, it can be completely specified by a truth table. For a logic block with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> inputs, there are <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> entries in the truth tables, corresponding to each possible combination of input values.</li>
</ul>
</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Boolean Algebra" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Boolean Algebra</a></strong>: A branch of mathematics that deals with Boolean variables: variables that can be either true (1) or false (0).</p>
<ul class="has-list-bullet">
<li data-line="9" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The main operations in Boolean algebra are:
<ol>
<li data-line="10" dir="auto"><strong>OR (+)</strong>: A binary operator which returns 1 if either operand is 1. The OR operation is also called a <em>logical sum</em>.</li>
<li data-line="11" dir="auto"><strong>AND (<span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo></mjx-math></mjx-container></span>)</strong>: A binary operator which returns a 1 only if <em>both</em> of its operands are 1. The AND operator is also called a <em>logical product</em>.</li>
<li data-line="12" dir="auto"><strong>NOT (<span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.515em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math></mjx-container></span>)</strong>: A unary operator which returns the inverse of its operand. If the input is a 1, the result is a 0, and vice versa.</li>
</ol>
</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are several laws of Boolean algebra, including:
<ul class="has-list-bullet">
<li data-line="14" dir="auto"><span class="list-bullet"></span><strong>Identity Laws</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>.</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span><strong>Domination Laws</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math></mjx-container></span>.</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span><strong>Inverse Laws</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.514em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.514em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math></mjx-container></span>.</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span><strong><a data-tooltip-position="top" aria-label="Commutative Property" data-href="Commutative Property" href="notes/math/commutative-property.html#_0" class="internal-link" target="_self" rel="noopener nofollow">Commutative</a> Laws</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>.</li>
<li data-line="18" dir="auto"><span class="list-bullet"></span><strong>Distributive Laws</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span> and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>.</li>
</ul>
</li>
<li data-line="19" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>In addition, <a data-href="De Morgan's Laws" href=".html" class="internal-link" target="_self" rel="noopener nofollow">De Morgan's Laws</a> are useful for relating AND and OR operations through negation:
<ul class="has-list-bullet">
<li data-line="20" dir="auto"><span class="list-bullet"></span><strong>First Law</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mover><mjx-over style="padding-bottom: 0.18em; margin-bottom: -0.248em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2013" style="width: 3.009em;"><mjx-ext><mjx-c></mjx-c></mjx-ext></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-base></mjx-mover><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.514em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.463em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math></mjx-container></span></li>
<li data-line="21" dir="auto"><span class="list-bullet"></span><strong>Second Law</strong>: <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mover><mjx-over style="padding-bottom: 0.18em; margin-bottom: -0.248em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2013" style="width: 3.509em;"><mjx-ext><mjx-c></mjx-c></mjx-ext></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-base></mjx-mover><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.514em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.463em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math></mjx-container></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="23" dir="auto"><span class="list-bullet"></span>
<p><strong><a data-href="Verilog" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Verilog</a></strong>: A hardware description language (HDL) used to model, design, and simulate electronic systems, especially digital circuits.</p>
</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Logic blocks are built from Logic Gates]]** that implement basic logic functions.</p>
<ul class="has-list-bullet">
<li data-line="26" dir="auto"><span class="list-bullet"></span>An AND gate implements the AND function, and an OR gate implements the OR function. Since both AND and OR are <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/commutative-property.html#_0" target="_self" rel="noopener noreferrer" from="110" to="121" origin-text="commutative" class="internal-link virtual-link-a">commutative</a></span> and <span class="glossary-entry virtual-link virtual-link-span virtual-link-default"><a href="notes/math/associative-property.html#_0" target="_self" rel="noopener noreferrer" from="126" to="137" origin-text="associative" class="internal-link virtual-link-a">associative</a></span>, they both can have multiple inputs, with the output equivalent to the AND or OR of all the inputs. </li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>The logical function NOT is implemented with an <em>inverter</em> with a single input and output. Rather than drawing inverters explicitly, a common practice is to add <em>bubbles</em> to the inputs or outputs of a gate to cause the value on that line to be inverted.</li>
<li data-line="28" dir="auto"><span class="list-bullet"></span>The standard symbols for an AND gate, OR gate, and an inverter is shown below from left to right:<span alt="gates.png" src="resources/gates.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="gates.png" src="resources/gates.png" target="_self"></span></li>
<li data-line="29" dir="auto"><span class="list-bullet"></span>All possible logic functions can be constructed with only a single gate type, if that gate is inverting. The most common inverting gates are called <strong>NOR</strong> and <strong>NAND</strong> gates, and they correspond to inverted OR and AND gates, respectively. Such gates are called <em>universal</em>, since any logic function can be built using this one gate type.</li>
</ul>
</li>
<li data-line="31" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>One common logic block used when building larger components is a <strong>decoder</strong>. The most common type of decoder has an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit input and <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> outputs, where only one output is asserted for each input combination. This decoder translates the <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit input into a signal that corresponds to the binary value of the <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit input.</p>
<ul class="has-list-bullet">
<li data-line="32" dir="auto"><span class="list-bullet"></span>The outputs are usually numbered such that if the value of the input is <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>, then Out<span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> will be asserted and all other outputs will be deasserted.</li>
<li data-line="33" dir="auto"><span class="list-bullet"></span>The inverse of a decoder is an <strong>encoder</strong>, which takes <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> inputs and produces an <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-bit output.</li>
</ul>
</li>
<li data-line="35" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Another basic logic function is the <strong>multiplexer</strong>. A multiplexer selects its output from one of its many inputs according to a <strong>control value</strong>.</p>
<ul class="has-list-bullet">
<li data-line="36" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Multiplexers can be created with an arbitrary number of data inputs. If there are <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> data inputs, there will need to be <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2308"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.241em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2309"></mjx-c></mjx-mo></mjx-math></mjx-container></span> control values. In this case, the multiplexer consists of three parts:
<ol>
<li data-line="37" dir="auto">A decoder that generates <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> signals, each indicating a different input value.</li>
<li data-line="38" dir="auto">An array of <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> AND gates, each combining one of the inputs with a signal from the decoder.</li>
<li data-line="39" dir="auto">A single large OR gate that incorporates the outputs of the AND gate.</li>
</ol>
</li>
<li data-line="40" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We can represent the logic function of a two-input multiplexer as:
<ul class="has-list-bullet">
<li data-line="41" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></li>
</ul>
</li>
<li data-line="42" dir="auto"><span class="list-bullet"></span>To associate the inputs with control values, we often label the data inputs numerically (i.e., from 0 to <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>-1) and interpret the data selector inputs as a binary number.</li>
</ul>
</li>
<li data-line="44" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Any logic function can be written in a canonical form, where every input is either a true or complemented variable and there are only two levels of gates: one being AND and the other OR, with a possible inversion on the final output.</p>
<ul class="has-list-bullet">
<li data-line="45" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Such a representation is called a <strong>two-level representation</strong>, and there are two forms:
<ul class="has-list-bullet">
<li data-line="46" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Sum of Products</strong>: A logical sum (OR) of products (terms using the AND operator). A sum of products is the equivalent of a function in <strong>disjunctive normal form</strong>. For example:
<ul class="has-list-bullet">
<li data-line="47" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></li>
</ul>
</li>
<li data-line="48" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Product of Sums</strong>: A logical product (AND) of sums (terms using the OR operator). A product of sums is the equivalent of a function in <strong>conjunctive normal form</strong>. For example:
<ul class="has-list-bullet">
<li data-line="49" dir="auto"><span class="list-bullet"></span><span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></li>
</ul>
</li>
</ul>
</li>
<li data-line="50" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>We will use the sum-of-products form in the rest of this appendix. To construct the equivalent sum-of-products for a logic function, you can use the function's truth table.
<ul class="has-list-bullet">
<li data-line="51" dir="auto"><span class="list-bullet"></span>Every truth table entry for which the function is true corresponds to a product term. The product term consists of a logical product of all the inputs or their complements, depending on whether the entry in the truth table has a 0 or 1 corresponding to this variable. The logic function is then the logical sum of the product terms where the function is true. This representation corresponds to a common structured-logic implementation called a <strong>programmable logic array (PLA)</strong>.</li>
</ul>
</li>
</ul>
</li>
<li data-line="53" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Programmable Logic Array" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Programmable Logic Array</a></strong>: Has a set of inputs and corresponding input complements, and two stages of logic. The stages are a programmable AND plane and a programmable OR plane. Inputs can be combined in the AND plane to create product terms (<em>minterms</em>). These terms can then be summed in the OR plane to form the final outputs.</p>
<ul class="has-list-bullet">
<li data-line="54" dir="auto"><span class="list-bullet"></span>The total size of a PLA is equal to the sum of the size of the AND plane and the size of the OR plane. The size of the AND plane is the number of inputs times the number of different product terms; the size of the OR plane is the number of outputs times the number of product terms.</li>
<li data-line="55" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A PLA has two characteristics that make it an efficient way to implement a set of logic functions:
<ol>
<li data-line="56" dir="auto">Only the truth table entries that produce a <em>true</em> value for at least one output have any logic gates associated with them.</li>
<li data-line="57" dir="auto">Each different product term will have only one entry in the PLA, even if the product term is used in multiple outputs.</li>
</ol>
</li>
</ul>
</li>
<li data-line="59" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Another form of structured logic that can be used to implement a set of logic functions is a <strong><a data-href="Read-Only Memory" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Read-Only Memory</a> (ROM)</strong>. A ROM is called a memory because it has a set of locations that can be read, though, the data at these locations is often fixed, usually at the time of manufacturing.</p>
<ul class="has-list-bullet">
<li data-line="60" dir="auto"><span class="list-bullet"></span>There are <strong>programmable ROMs (PROMs)</strong> that can be programmed electronically.</li>
<li data-line="61" dir="auto"><span class="list-bullet"></span>A ROM has a set of input address lines and a set of outputs. The number of addressable entries in the ROM determines the number of address lines. If the ROM contains <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></span> addressable entries, called the <strong>height</strong>, then there are <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> input lines.</li>
<li data-line="62" dir="auto"><span class="list-bullet"></span>The number of bits in each addressable entry is equal to the number of output lines and is called the <strong>width</strong> of the ROM. The total number of bits in the ROM is equal to the height times the width.</li>
<li data-line="63" dir="auto"><span class="list-bullet"></span>A ROM can encode a collection of logic functions directly from the truth table. If there are <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> functions with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> inputs, we need a ROM with <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> address lines, with each entry being <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> bits wide. The entries in the input portion of the truth table correspond to the addresses of the entries in the ROM, while the contents of the output portion of the truth table constitute the contents of the ROM.</li>
<li data-line="64" dir="auto"><span class="list-bullet"></span>A ROM is fully decoded, that is, it contains a full output word for every possible input combination. A PLA, on the other hand, is only partially decoded. As the number of inputs grow, the number of entries in the ROM grow exponentially. In contrast, for most real logic functions, the number of product terms grows much slower, making PLAs generally more efficient for implementing combinational logic functions.</li>
</ul>
</li>
<li data-line="66" dir="auto"><span class="list-bullet"></span>
<p>For designing logic outside a custom or semi-custom IC, a common choice is a <em>field programmable device</em>.</p>
</li>
<li data-line="68" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Often when implementing combinational logic, there are situations where we don't care about the value of some output, either because another output is true or because a subset of the input combinations determines the values of the outputs. Such situations are called <strong><a data-tooltip-position="top" aria-label="Don't Care" data-href="Don't Care" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Don't Cares</a></strong>.</p>
<ul class="has-list-bullet">
<li data-line="69" dir="auto"><span class="list-bullet"></span>Don't cares are denoted as <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>s when they appear in truth tables. </li>
<li data-line="70" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two types of don't cares:
<ol>
<li data-line="71" dir="auto"><strong>Output Don't Cares</strong>: Arise when we don't care about the value of an output for some input combination.</li>
<li data-line="72" dir="auto"><strong>Input Don't Cares</strong>: Arise when an output depends only on a subset of the inputs.</li>
</ol>
</li>
<li data-line="73" dir="auto"><span class="list-bullet"></span>Don't cares are critical for <strong>logic minimization/optimization</strong> of circuits. One tool useful for hand minimization are <strong><a data-tooltip-position="top" aria-label="Karnaugh Map" data-href="Karnaugh Map" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Karnaugh Maps</a></strong>. However, manually optimizing complex logic functions with Karnaugh maps is often impractical, which is why automated logic optimization programs are available.</li>
</ul>
</li>
<li data-line="75" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Many of the combinational operations to be performed on data have to be done to an entire word (<em>64 bits</em>) of data. Thus, we often want to build an array of logic elements, which we can represent simply by showing that a given operation will happen to an entire collection of inputs.</p>
<ul class="has-list-bullet">
<li data-line="76" dir="auto"><span class="list-bullet"></span>A <strong>bus</strong> is a collection of data lines that are routed together as a single logical signal. To indicate that a signal is a bus rather than a single 1-bit line, we use a thicker line and typically label their width.</li>
<li data-line="77" dir="auto"><span class="list-bullet"></span>When we show a logic unit whose inputs and outputs are buses, this means that the unit will have to be replicated a sufficient number of times to accommodate the width of the input.</li>
</ul>
</li>
<li data-line="79" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Hardware Description Language (HDL)</strong>: A specialized programming language used to describe the structure, behavior, and design of digital circuits. Today, most digital design of processors and related hardware systems is done using an HDL.</p>
<ul class="has-list-bullet">
<li data-line="80" dir="auto"><span class="list-bullet"></span>HDLs provide an abstract d100escription of the hardware to simulate and debug the design. Additionally, with the use of logic synthesis and hardware compilation tools, this description can be compiled onto the hardware implementation.</li>
<li data-line="81" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The two most common HDLs are:
<ol>
<li data-line="82" dir="auto"><strong><a data-href="Verilog" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Verilog</a></strong>: Heavily used in industry and is based on the C programming language.</li>
<li data-line="83" dir="auto"><strong><a data-href="VHDL" href=".html" class="internal-link" target="_self" rel="noopener nofollow">VHDL</a></strong>: A strongly typed language based on Ada.</li>
</ol>
</li>
<li data-line="84" dir="auto"><span class="list-bullet"></span>With the arrival of <strong>hardware synthesis tools</strong>, most designers now used Verilog or VHDL to structurally describe only the datapath, relying on logic synthesis to generate the control from a behavioral description. Additionally, most CAD software provide extensive libraries for standardized parts such as ALUs, multiplexers, etc.</li>
</ul>
</li>
<li data-line="86" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>We will focus on Verilog for the remainder of this appendix.</p>
<ul class="has-list-bullet">
<li data-line="87" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Verilog can specify both a behavioral and structural definition of a digital system:
<ul class="has-list-bullet">
<li data-line="88" dir="auto"><span class="list-bullet"></span><strong>Behavioral Specification</strong>: Describes how a digital system functionally operates.</li>
<li data-line="89" dir="auto"><span class="list-bullet"></span><strong>Structure Specification</strong>: Describes the detailed organization of a digital system, usually using a hierarchical description.</li>
</ul>
</li>
<li data-line="90" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two primary datatypes in Verilog:
<ol>
<li data-line="91" dir="auto">A <strong>wire</strong> specifies a combinational signal.</li>
<li data-line="92" dir="auto">a <strong>reg</strong> (register) holds a value, which can vary with time. A reg does not necessarily correspond to an actual register in an implementation, though it often will.</li>
</ol>
</li>
<li data-line="93" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A register or wire, named <code>X</code>, that is 32-bits wide is declared as an array: <code>reg[31:0] X</code> or <code>wire 31:0 X</code>, which also sets the index of 0 to designate the least significant bit of the register. We can refer to a contiguous set of bits of a register or wire with the notation <code>[startBit:endBit]</code>, where both indices must be constant values. We can also access a single bit with the notation <code>[index]</code>.
<ul class="has-list-bullet">
<li data-line="94" dir="auto"><span class="list-bullet"></span>An array of registers is used for a structure like a register file or memory. Thus, <code>reg[31:0] registerFile[0:31]</code> specifies a variable <code>registerFile</code> that is equivalent to a RISC-V registerfile where register 0 is the first.</li>
</ul>
</li>
<li data-line="95" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The possible values for a register or wire in Verilog are:
<ul class="has-list-bullet">
<li data-line="96" dir="auto"><span class="list-bullet"></span>0 or 1, representing logical false or true.</li>
<li data-line="97" dir="auto"><span class="list-bullet"></span>X, representing unknown, the initial value given to all registers or disconnected wires.</li>
<li data-line="98" dir="auto"><span class="list-bullet"></span>Z, representing the high-impedance state for tristate gates.</li>
</ul>
</li>
<li data-line="99" dir="auto"><span class="list-bullet"></span>Constant values can be specified as decimal, binary, octal, or hexadecimal numbers. To specify how large a constant field is in bits, you prefix the value with a decimal number specifying a size in bits.</li>
<li data-line="100" dir="auto"><span class="list-bullet"></span>Verilog also provides the full set of unary and binary operators from C, including arithmetic operators, logical operators, comparison operators, shift operators, and C's ternary operator <code>?</code>. Additionally, Verilog adds a set of unary logic reduction operators (<code>&amp;, |, ^</code>) that yield a single bit by applying the logical operator to all the bits of an operand.</li>
<li data-line="101" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A Verilog program is structured as a set of modules, which may represent anything from a collection of logic gates to a complete system. A module specifies its input and output ports, which describe the incoming and outgoing connections of a module. The body of a module consists of:
<ul class="has-list-bullet">
<li data-line="102" dir="auto"><span class="list-bullet"></span><code>initial</code> constructs, which can initialize <code>reg</code> variables.</li>
<li data-line="103" dir="auto"><span class="list-bullet"></span>Continuous assignments, which define only combinational logic.</li>
<li data-line="104" dir="auto"><span class="list-bullet"></span><code>always</code> constructs, which can define either sequential or combinational logic.</li>
<li data-line="105" dir="auto"><span class="list-bullet"></span>Instances of other modules, which are used to implement the module being defined.</li>
</ul>
</li>
<li data-line="106" dir="auto"><span class="list-bullet"></span>A continuous assignment, which is indicated with the keyword <code>assign</code>, acts like a combinational logic function: the output is continuously assigned the value, and a change in the input values is reflected immediately in the output value. Wires may only be assigned values with continuous assignments.</li>
<li data-line="107" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>For more complex structures, <code>assign</code> statements may be awkward or tedious to use. The <code>always</code> block of a module can be used to describe a combinational logic element, although care must be taken. Using an <code>always</code> block allows the inclusion of Verilog control constructs, such as <code>if-then-else</code> or <code>case</code> statements.
<ul class="has-list-bullet">
<li data-line="108" dir="auto"><span class="list-bullet"></span>An <code>always</code> block specifies an optional list of signals, starting with <code>@</code>, on which the block is sensitive. The <code>always</code> block is re-evaluated if any of the listed signals changes value. If the list is omitted, the <code>always</code> block is constantly re-evaluated.</li>
<li data-line="109" dir="auto"><span class="list-bullet"></span>When an <code>always</code> block is used to specify combinational logic, the <strong>sensitivity list</strong> should include all the input signals. If there are multiple Verilog statements in the <code>always</code> block, they are surrounded by the <code>begin</code> and <code>end</code> keywords.</li>
<li data-line="110" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><code>Reg</code> variables may only be assigned in an <code>always</code> block, using a procedural assignment statement, as opposed to a continuous assignment statement. There are two types of procedural assignments:
<ol>
<li data-line="111" dir="auto"><strong>Blocking Assignment (=)</strong>: Behaves the same as the assignment operator in C: the right-hand side is evaluated, and the left-hand side is assigned the value. It is completed before the next statement is executed (<em>blocking</em>).</li>
<li data-line="112" dir="auto"><strong>Nonblocking Assignment (&lt;=)</strong>: All right-hand sides of the assignments in an <code>always</code> block are evaluated, and the assignments are done <em>simultaneously</em>.</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="114" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong><a data-href="Arithmetic Logic Unit" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Arithmetic Logic Unit</a></strong>: A component of a CPU that can perform basic mathematical operations such as addition, subtraction, multiplication, and division. It can also carry out logical operations such as AND, OR, NOT, and XOR.</p>
<ul class="has-list-bullet">
<li data-line="115" dir="auto"><span class="list-bullet"></span>It operates based on control signals from the CPU, which dictate what operation should be performed.</li>
</ul>
</li>
<li data-line="117" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Clocks</strong> are timing devices used to synchronize the components of a computer. Clocks are needed in sequential logic to determine when an element that contains state should be updated.</p>
<ul class="has-list-bullet">
<li data-line="118" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two primary clocking methodologies:
<ol>
<li data-line="119" dir="auto"><strong>Edge-Triggered Clocking</strong>: All state changes occur on a clock edge. That is, on either the transition from low to high (<em>rising-edge</em>), or from high to low (<em>falling-edge</em>). We will use edge-triggered clocking in this appendix.</li>
<li data-line="120" dir="auto"><strong>Level-Triggered Clocking</strong>: All state changes occur based on the level of the clock signal. That is, whether it is a digital low or high.</li>
</ol>
</li>
<li data-line="121" dir="auto"><span class="list-bullet"></span>The clock edge acts as a sampling signal, causing the value of the data input to a state element to be sampled and stored in the state element. Using an edge trigger means that the sampling process is nearly instantaneous, eliminating problems that can occur if signals were sampled at slightly different times.</li>
<li data-line="122" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The major constraint with <strong>synchronous systems</strong> is that the signals being sampled must be <em>valid</em> at the clock edge. A signal is valid if it is stable (i.e., not changing), and the value will not change again until the inputs change. Since combinational circuits cannot have feedback, if the inputs to a combinational logic unit are not changed, the outputs will eventually become valid.
<ul class="has-list-bullet">
<li data-line="123" dir="auto"><span class="list-bullet"></span>To ensure that the values written into the state element are valid, the clock must have a long enough period so that all the signals in the combinational logic block stabilize, and then the clock edge samples those values for storage in the state elements.</li>
<li data-line="124" dir="auto"><span class="list-bullet"></span>Some state elements have explicit write signals, where the element is updated on the clock edge only if the write signal is asserted.</li>
</ul>
</li>
</ul>
</li>
<li data-line="126" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Memory elements store state. The output from any memory element depends on both the inputs and the current state. Thus, all lo- Many of the combinational operations to be performed on data have to be done to an entire word (￼￼64 bits￼￼) of data. Thus, we often want to build an array of logic elements, which we can represent simply by showing that a given operation will happen to an entire collection of inputs.</p>
<ul class="has-list-bullet">
<li data-line="127" dir="auto"><span class="list-bullet"></span>A ￼￼bus￼￼ is a collection of data lines that is tread together as a single logical signal. To indicate that a signal is a bus rather than a single 1-bit line, we use a thicker line and typically label their width.</li>
<li data-line="128" dir="auto"><span class="list-bullet"></span>When we show a logic unit whose inputs and outputs are busses, this means that the unit will have to be replicated a sufficient number of times to accommodate the width of the input.gic blocks containing memory are sequential.</li>
<li data-line="129" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The simplest type of memory elements are unclocked. An unclocked <em>latch</em> is the simplest memory element. An <strong>S-R latch</strong> (<em>set-reset latch</em>), for example, is built from a pair of cross-coupled NOR gates and is depicted below:
<ul class="has-list-bullet">
<li data-line="130" dir="auto"><span class="list-bullet"></span><span alt="srLatch.png" src="resources/srlatch.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="srLatch.png" src="resources/srlatch.png" target="_self"></span></li>
<li data-line="131" dir="auto"><span class="list-bullet"></span>This cross-coupled structure is the basis for more complex memory elements that allow us to store data signals.</li>
</ul>
</li>
<li data-line="132" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong><a data-tooltip-position="top" aria-label="Flip Flop" data-href="Flip Flop" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Flip-flops</a></strong> and <strong>latches</strong> are the simplest memory elements. The difference between them is the point at which the clock causes the state to actually change.
<ul class="has-list-bullet">
<li data-line="133" dir="auto"><span class="list-bullet"></span>In a clocked latch, the state changes whenever the appropriate inputs change and the clock is asserted. In a clocked flip-flop, the state is changed only on a clock edge. Flip-flops are often built from latches.</li>
<li data-line="134" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A <strong>D latch</strong> has two inputs and two outputs. The inputs are the data value to be stored <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>, and a clock signal <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>. The outputs are simply the internal state <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> and its complement <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.479em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math></mjx-container></span>. When the clock input <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> is asserted, the latch is said to be <em>open</em>, and the value of output <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> becomes the value of input <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span>. When the clock input is deasserted, the latch is said to be <em>closed</em>, and the output <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> is whatever value was stored the last time the latch was open. A D latch can be implemented with two additional AND gates to the S-R latch:
<ul class="has-list-bullet">
<li data-line="135" dir="auto"><span class="list-bullet"></span><span alt="dlatch.png" src="resources/dlatch.png" class="internal-embed media-embed image-embed is-loaded" target="_self" style="width: 350px; max-width: 100%;"><img alt="dlatch.png" src="resources/dlatch.png" target="_self" style="width: 350px; max-width: 100%;"></span></li>
</ul>
</li>
<li data-line="136" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Flip-flops are not transparent: their outputs change only on the clock edge. Flip-flops can be designed to be triggered on the rising edge or falling edge. A falling-edge D flip flop can be constructed from a pair of D latches, as shown in the following figure:
<ul class="has-list-bullet">
<li data-line="137" dir="auto"><span class="list-bullet"></span><span alt="dflipFlop.png" src="resources/dflipflop.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="dflipFlop.png" src="resources/dflipflop.png" target="_self"></span></li>
</ul>
</li>
<li data-line="138" dir="auto"><span class="list-bullet"></span>The Verilog code for a rising-edge D flip-flop is:</li>
<li data-line="139" dir="auto"><span class="list-bullet"></span>
<pre><code data-line="139">module DFF(clock,D,Q,Qbar);
	input clock, D;
	output reg Q;
	output Qbar;
	assign Qbar= ~ Q;
	always @(posedge clock)
		Q=D;
endmodule
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="149" dir="auto"><span class="list-bullet"></span>Because the <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi></mjx-math></mjx-container></span> input is sampled on the clock edge, it must be valid for a period of time immediately before the clock edge (<strong>setup time</strong>), and immediately after the clock edge (<strong>hold time</strong>). Additionally, components have <strong>propagation delays</strong>, which describes how long it takes for the output of a signal to become valid.</li>
</ul>
</li>
</ul>
</li>
<li data-line="151" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Register File</strong>: A set of registers that can be read and written by supplying a register number to access. A register file can be implemented with a decoder for each read/write port, and an array of registers built from D flip-flops.</p>
<ul class="has-list-bullet">
<li data-line="152" dir="auto"><span class="list-bullet"></span>Reading a register only requires one signal: the register number to be read. Writes, on the other hand, take three signals: the register to be written, the data to be written, and a clock signal.</li>
<li data-line="153" dir="auto"><span class="list-bullet"></span>In an edge-triggered design, if the same register is read and written in the same clock cycle, the value returned from the read will be the value written in an earlier clock cycle. Additional logic is required if we want a read to return the value being currently written.</li>
</ul>
</li>
<li data-line="155" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Larger amounts of memory are built from either <strong><a data-tooltip-position="top" aria-label="SRAM" data-href="SRAM" href=".html" class="internal-link" target="_self" rel="noopener nofollow">SRAMs</a></strong> or <strong><a data-tooltip-position="top" aria-label="DRAM" data-href="DRAM" href=".html" class="internal-link" target="_self" rel="noopener nofollow">DRAMs</a></strong>.</p>
<ul class="has-list-bullet">
<li data-line="156" dir="auto"><span class="list-bullet"></span><strong>SRAM (Static Random Access Memory)</strong>: A volatile memory device where each bit is stored using a flip-flop circuit. Generally faster, and more expensive than DRAM.</li>
<li data-line="157" dir="auto"><span class="list-bullet"></span><strong>DRAM (Dynamic Random Access Memory)</strong>: A volatile memory device where each bit is stored using a capacitor and transistor. Because capacitors leak charge, DRAMs have to be periodically refreshed. DRAMs are considerably denser than SRAMs, allowing them to store large amounts of data in a small package.</li>
</ul>
</li>
<li data-line="159" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Most computers use some form of error-checking code to detect possible data corruption.</p>
<ul class="has-list-bullet">
<li data-line="160" dir="auto"><span class="list-bullet"></span>One simple code is a <strong>parity code</strong>. In a parity code the number of 1s in a data word is counted, the word has odd parity if the number of 1s is odd and even parity otherwise. When a word is written into memory, its parity bit is also written. If the parity of the memory word and the stored parity do not match, then an error has occurred. A 1-bit parity scheme can only detect odd numbers of errors, since any even number of errors will result in the same parity.</li>
<li data-line="161" dir="auto"><span class="list-bullet"></span>There are also error correction codes that can detect and correct errors.</li>
</ul>
</li>
<li data-line="163" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>Combinational logic systems can be fully described with a truth table since the outputs depend entirely on the inputs. Sequential logic, on the other hand, has state, and thus cannot be represented with truth tables. That is where finite-state machines come into play.</p>
<ul class="has-list-bullet">
<li data-line="164" dir="auto"><span class="list-bullet"></span><strong><a data-href="Finite-State Machine" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Finite-State Machine</a> (FSM)</strong>: A sequential logic function consisting of a set of inputs, a set of outputs, a <strong>next-state function</strong> that maps the current state and the inputs to a new state, and an output function that maps the current state and possibly the inputs to a set of asserted outputs.</li>
<li data-line="165" dir="auto"><span class="list-bullet"></span>The set of states corresponds to all the possible values of the internal storage. The next-state function is a combinational function that, given the inputs and the current state, determines the next state of the system.</li>
<li data-line="166" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>There are two types of FSMs:
<ul class="has-list-bullet">
<li data-line="167" dir="auto"><span class="list-bullet"></span><strong>Moore Machine</strong>: The output depends only on the current state. Outputs change synchronously with state transitions.</li>
<li data-line="168" dir="auto"><span class="list-bullet"></span><strong>Mealy Machine</strong>: The output depends on both the current state and the current inputs. Outputs can change asynchronously  with respect to state transitions since the inputs can change at any time.</li>
</ul>
</li>
</ul>
</li>
<li data-line="170" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p>This appendix has assumed an edge-triggered clocking methodology, primarily because it is simpler to understand and explain. If we assume that all clocks arrive at the same time, we are guaranteed that a system with edge-triggered registers between blocks of combinational logic can operate correctly without races as long as we make the clock long enough. A <strong>race</strong> occurs when the contents of a state element depend on the relative speed of different logic elements.</p>
<ul class="has-list-bullet">
<li data-line="171" dir="auto"><span class="list-bullet"></span>One additional complication that must be considered is clock skew. <strong>Clock skew</strong> is the difference in absolute time between when two state elements see a clock edge. Clock skew arises because the clock signal will often use multiple paths, with slightly different delays, to reach different state elements. Designers reduce clock skew problems by carefully routing clock signals to minimize the difference in arrival times.</li>
<li data-line="172" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Edge-triggered designs have two primary drawbacks: they require extra logic, and they are sometimes slower. An alternative to use is level-sensitive clocking, where state changes occur at either high or low clock levels.
<ul class="has-list-bullet">
<li data-line="173" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unlike edge-sensitive clocking, where state changes occur instantaneously, level-sensitive clocking can result in state changes at any time during the clock signal. Because of this non-instantaneous change in state, races can occur more easily. To ensure that a level-sensitive design will also work correctly if the clock is slow enough, designers use <strong>two-phase clocking</strong>:
<ul class="has-list-bullet">
<li data-line="174" dir="auto"><span class="list-bullet"></span>Two-phase clocking is a scheme that makes use of two non-overlapping clock signals. Since the two clocks are non-overlapping, at most one of the clock signals is high at any given time. We can use these clocks to build a system that contains level-sensitive latches but is free from any race conditions, just as the edge-triggered designs were.</li>
<li data-line="175" dir="auto"><span class="list-bullet"></span>One simple way to design such a system is to alternate the use of latches that are open on <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D719 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math></mjx-container></span> with latches that are open on <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D719 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math></mjx-container></span>. Because both clocks are not asserted simultaneously, a race cannot occur.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li data-line="177" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Field-programmable devices</strong> are ICs containing combinational logic, and possible memory devices, that are configurable by the end user.</p>
<ul class="has-list-bullet">
<li data-line="178" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>FPDs generally fall into two categories:
<ul class="has-list-bullet">
<li data-line="179" dir="auto"><span class="list-bullet"></span><strong>Programmable Logic Devices (PLDs)</strong>: Devices that can be programmed only once. PLDs are generally simpler and smaller than FPGAs.</li>
<li data-line="180" dir="auto"><span class="list-bullet"></span><strong><a data-tooltip-position="top" aria-label="Field-Programmable Gate Array" data-href="Field-Programmable Gate Array" href=".html" class="internal-link" target="_self" rel="noopener nofollow">Field-Programmable Gate Arrays</a> (FPGAs)</strong>: A more complex architecture with a matrix of programmable logic blocks. FPGAs can be programmed numerous times and may contain flip-flops.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">D. A. Patterson and J. L. Hennessy, <em>Computer Organization and Design RISC-V Edition: The Hardware Software Interface</em>. Amsterdam: Morgan Kaufmann, 2021.</li>
</ol></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all is-collapsed" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item is-collapsed" data-depth="1"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#_0" data-path="#_0"><div class="tree-item-inner heading-link" heading-name=""></div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="1"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Textbook_Summary_Computer_Organization_and_Design_RISC-V_Edition_0" data-path="#Textbook_Summary_Computer_Organization_and_Design_RISC-V_Edition_0"><div class="tree-item-inner heading-link" heading-name="Textbook Summary: Computer Organization and Design RISC-V Edition">Textbook Summary: Computer Organization and Design RISC-V Edition</div></a><div class="tree-item-children"><div class="tree-item is-collapsed" data-depth="3"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Author(s)_0" data-path="#Author(s)_0"><div class="tree-item-inner heading-link" heading-name="Author(s):">Author(s):</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Introduction_0" data-path="#Introduction_0"><div class="tree-item-inner heading-link" heading-name="Introduction">Introduction</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.1_Computer_Abstractions_and_Technology_0" data-path="#Ch.1_Computer_Abstractions_and_Technology_0"><div class="tree-item-inner heading-link" heading-name="Ch.1 Computer Abstractions and Technology">Ch.1 Computer Abstractions and Technology</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.2_Instructions_Language_of_the_Computer_0" data-path="#Ch.2_Instructions_Language_of_the_Computer_0"><div class="tree-item-inner heading-link" heading-name="Ch.2 Instructions: Language of the Computer">Ch.2 Instructions: Language of the Computer</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.3_Arithmetic_for_Computers_0" data-path="#Ch.3_Arithmetic_for_Computers_0"><div class="tree-item-inner heading-link" heading-name="Ch.3 Arithmetic for Computers">Ch.3 Arithmetic for Computers</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.4_The_Processor_0" data-path="#Ch.4_The_Processor_0"><div class="tree-item-inner heading-link" heading-name="Ch.4 The Processor">Ch.4 The Processor</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.5_Large_and_Fast_Exploiting_Memory_Hierarchy_0" data-path="#Ch.5_Large_and_Fast_Exploiting_Memory_Hierarchy_0"><div class="tree-item-inner heading-link" heading-name="Ch.5 Large and Fast: Exploiting Memory Hierarchy">Ch.5 Large and Fast: Exploiting Memory Hierarchy</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Ch.6_Parallel_Processors_from_Client_to_Cloud_0" data-path="#Ch.6_Parallel_Processors_from_Client_to_Cloud_0"><div class="tree-item-inner heading-link" heading-name="Ch.6 Parallel Processors from Client to Cloud">Ch.6 Parallel Processors from Client to Cloud</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#Appendix_A_The_Basics_of_Logic_Design_0" data-path="#Appendix_A_The_Basics_of_Logic_Design_0"><div class="tree-item-inner heading-link" heading-name="Appendix A: The Basics of Logic Design">Appendix A: The Basics of Logic Design</div></a><div class="tree-item-children"></div></div><div class="tree-item is-collapsed" data-depth="2"><a class="tree-item-self is-clickable" href="textbooks/computer-organization-and-design-risc-v-edition-summary.html#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>